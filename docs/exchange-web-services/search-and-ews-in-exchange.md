---
title: Поиск и веб-службах Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 9fa5b836-857e-401d-9450-51e7dbc69104
description: Узнайте, как выполнять поиск элементов в Exchange с помощью управляемого интерфейса API веб-служб Exchange или веб-служб Exchange.
ms.openlocfilehash: 1a8ed6be71d88a02c4ef935864ca15888df90a38
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2018
ms.locfileid: "21354059"
---
# <a name="search-and-ews-in-exchange"></a>Поиск и веб-службах Exchange

Узнайте, как выполнять поиск элементов в Exchange с помощью управляемого интерфейса API веб-служб Exchange или веб-служб Exchange.
  
Не похоже на этом? И, наконец, вы начинаете этого проекта, которые вы откладывается для недель, а для получения сведений о проекте, которое ваш начальник отправить вам в электронной почты недели назад. Папки "Входящие" содержит сотни или тысячи возможно сообщений. Чем занимаешься? Прокрутке сканирование каждого темы и отправителя, найдите его электронной почты? Или вы используйте функцию поиска в избранные почтовом клиенте быстро нулевые значения в на то, что вам нужно?
  
Поиск — это возможно функции необходимы для любой клиент электронной почты. Однако поиска можно использовать для гораздо больше, чем просто предоставление пользователям возможности поиска по почтовому ящику. Требуется ли ваше приложение для обработки встречи, попадающие в определенное время windows? Возможно, вам необходимо сообщить о во всех элементах задач с определенным состоянием или переместить все контакты с именем конкретной компании в другую папку. Поиск может помочь со всеми этим требованиям.
  
## <a name="search-basics"></a>Основы поиска
<a name="bk_SearchBasics"> </a>

Управляемый API EWS и веб-служб Exchange предоставляют два основных способа указания поиска. Можно использовать [фильтр поиска](how-to-use-search-filters-with-ews-in-exchange.md) или [строки запроса](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md). Используемый метод зависит от цели поиска за операции поиска.
  
**В таблице 1. Сценарии фильтры поиска и поисковых запросов**

|**Задача**|**Использование...**|**Примечания**|
|:-----|:-----|:-----|
|Ограничение поиска в определенное свойство или набор свойств  <br/> |Фильтр поиска  <br/> |Фильтры поиска предоставляют наиболее уровень элемента управления, по которому выполняется поиск свойства. Несмотря на то, что строки запроса можно распределять ограниченный набор свойств с помощью расширенный синтаксис запроса (AQS), фильтры поиска можно назначить любое свойство.  <br/> |
|Создание операций поиска с несколькими условиями  <br/> |Фильтр поиска  <br/> |Фильтры поиска несколько условий поиска может быть присоединен вместе с логической запускалась или или, позволяя поиска как «тема содержит «Заметки к собранию» и отправителя равно «Sadie Daniels»». Несмотря на то, что строки запросов также можно объединить несколько условий поиска, они ограничены набор свойств, поддерживаемых строки запроса.  <br/> |
|Настраиваемые свойства поиска  <br/> |Фильтр поиска  <br/> |Фильтры поиска можно распределять настраиваемых свойств. Строки запроса не выполняйте поиск настраиваемых свойств.  <br/> |
|Поиск с учетом регистра строковые свойства  <br/> |Фильтр поиска  <br/> |Строка поиска не учитывают регистр.  <br/> |
|Включение режима при поиске строковые свойства элемента управления  <br/> |Фильтр поиска  <br/> |Поиск строки запроса, всегда поиск подстрок. Если вам требуется для поиска конкретных префиксами или Требовать точного совпадения, поисковый фильтр — это лучший вариант.  <br/> |
|Поиск папки  <br/> |Фильтр поиска  <br/> |Веб-служб Exchange не поддерживает поиск папок с помощью строки запроса.  <br/> |
|Создание папки поиска  <br/> |Фильтр поиска  <br/> |Веб-служб Exchange не поддерживает создание папки поиска с помощью строки запроса.  <br/> |
|Поиск во всех часто используемых свойств  <br/> |Строки запроса  <br/> |Строки запросов, которые не содержат AQS будет поиск по всем часто используемых свойств. К примеру значение строки запроса «Mack Chaves» возвращает все сообщения, отправленные с Mack Chaves, а также любые сообщения, для которых «Mack Chaves» в тексте или теме.  <br/> |
|Построение на основе ввода пользователя простого поиска  <br/> |Строки запроса  <br/> |Строка запроса — отлично подходит для конечному пользователю для быстрого поиска с помощью следующей команды в простой строки. Поскольку поиск строки запроса включает все часто используемые свойства, результатов будет содержать все элементы, которые содержат условия поиска пользователя.  <br/> |
   
### <a name="using-a-search-filter"></a>С помощью фильтра поиска

Фильтры поиска предоставить самые разнообразные параметры поиска и максимальную степень контроль над выполнением поиска. Фильтры поиска можно использовать для выполнения базовой равенство и выполняется поиск сравнения, но можно также поиск в содержимом строковые свойства или Битовая маска сравнений.
  
Например можно выполнить поиск содержимое темы элементов с помощью класса [SearchFilter.ContainsSubstring](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.searchfilter.containssubstring%28v=exchg.80%29.aspx) в управляемый API веб-служб Exchange. В этом примере фильтр поиска создается для поиска темы поиск подстроки «собрания» без учета регистра. 
  
```cs
SearchFilter.ContainsSubstring subjectFilter = new SearchFilter.ContainsSubstring(ItemSchema.Subject,
    "meeting notes", ContainmentMode.Substring, ComparisonMode.IgnoreCase);
```

Можно также выполнить поиск от настраиваемых свойств. В этом примере настраиваемое свойство **ItemIndex** поиск значения, превышающие 3. 
  
```cs
Guid MyAppGuid = new Guid("{AA3DF801-4FC7-401F-BBC1-7C93D6498C2E}");
ExtendedPropertyDefinition customPropDefinition =
    new ExtendedPropertyDefinition(MyAppGuid, "ItemIndex", MapiPropertyType.Integer); 
SearchFilter.IsGreaterThan customPropFilter =
    new SearchFilter.IsGreaterThan(customPropDefinition, 3);
```

Также можно объединить несколько поисковых фильтров для создания более сложного поиска. Например можно объединить предыдущих двух фильтров с логического и с помощью класса [SearchFilter.SearchFilterCollection](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.searchfilter.searchfiltercollection%28v=exchg.80%29.aspx) . 
  
```cs
SearchFilter.SearchFilterCollection compoundFilter =
    new SearchFilter.SearchFilterCollection(LogicalOperator.And, subjectFilter, customPropFilter);
```

### <a name="using-a-query-string"></a>С помощью строки запроса

Строки запросов представляют используется другой подход для поиска. У вас есть меньше контроль над поля, которые производится поиск и как выполнять поиск при использовании поиск строки запроса. Не, который плохо! В некоторых случаях может потребоваться так сказать приведения широкую сеть.
  
Например можно выполнить поиск «собрания» с помощью метода [ExchangeService.FindItems](http://msdn.microsoft.com/en-us/library/jj223808%28v=exchg.80%29.aspx) управляемый API веб-служб Exchange. 
  
```cs
FindItemsResults<Item> results = service.FindItems(folder, "meeting notes", view);
```

Если сравнить результаты поиска в результаты ранее пример поиска **SearchFilter.ContainsSubstring** поиска будет содержать дополнительные результаты. Возвращает только элементы, которые имеют «собрания» в теме сообщения, во время поиска которого возвращаются элементы, которые имеют «собрания» в теме, текста и другие поля фильтра поиска. 
  
Давайте рассмотрим, как можно усовершенствовать строки запроса, чтобы результаты из фильтра поиска. С помощью AQS, можно ограничить поиск к теме.
  
```cs
FindItemsResults<Item> results = service.FindItems(folder, "subject:meeting notes", view);
```

Это более подробно, но результаты совпадают с по-прежнему неправильно. При использовании нескольких слов строки запроса, вы получите совпадения, даже в том случае, если ключевых слов не в том порядке, который указан или даже в том случае, если они не вплотную друг к другу. С помощью строки запроса «Тема: собрания» получение совпадений для «примечаний к собраниям», «примечания из собрания» и так далее. Для уточнения, можно включить условия поиска в двойные кавычки, чтобы указать, что только эту фразу.
  
```cs
FindItemsResults<Item> results = service.FindItems(folder, "subject:\"meeting notes\"", view);
```

## <a name="requesting-specific-properties-in-search-results"></a>Разрешения на запрос конкретных свойств в результатах поиска
<a name="bk_RequestSpecific"> </a>

По умолчанию результаты поиска будет содержать все свойства для элементов, которые соответствуют поиска. В некоторых случаях может быть необходимые, но в большинстве случаев приложения требуется совокупность свойств. В этом случае следует ограничить набор свойств, которые возвращаются только свойства приложение должно. В следующем примере класс [ItemView](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.itemview%28v=exchg.80%29.aspx) используется для ограничения возвращаемых свойств к теме, дата/время получения и идентификатор элементов. 
  
```cs
ItemView view = new ItemView(10);
// Creating a new PropertySet with this constructor includes 
// ItemSchema.Id.
view.PropertySet = new PropertySet(ItemSchema.Subject, ItemSchema.DateTimeReceived);
```

## <a name="controlling-search-depth"></a>Управление глубины для поиска
<a name="bk_SearchDepth"> </a>

Настройка обход на представление управляет глубину и области поиска. 
  
**В таблице 2. Значения обхода поиска**

|**Значение обхода**|**Область применения**|**Описание**|
|:-----|:-----|:-----|
|Неполная  <br/> |Элементов и папок  <br/> |Поиск частичного ограничены являются прямыми потомками папки поиска.  <br/> |
|Глубокое  <br/> |Элементы (только для папок поиска) и папок  <br/> |Рекурсивно глубокой поисков поиска выполняется поиск папки и вложенные папки.  <br/> |
|Связанные  <br/> |Items  <br/> |Связанные поиск включаются только связанных элементов из папки поиска. Связанные элементы, скрытые элементы в папке.  <br/> |
|SoftDeleted  <br/> |Элементов и папок  <br/> |Этот тип обхода является устаревшим. Поиск SoftDeleted включает только элементов, находящихся в корзине. Корзины вместо нее [папки восстанавливаемых элементов](https://docs.microsoft.com/en-us/exchange/policy-and-compliance/recoverable-items-folder/recoverable-items-folder) в Exchange Online, Exchange Online как часть Office 365 и версии Exchange, начиная с Exchange 2010.  <br/> |
   
## <a name="managing-search-results"></a>Управление результатами поиска
<a name="bk_ManageSearchResults"> </a>

Управляемый API EWS и веб-служб Exchange также позволяют изменить способ возвращаются результаты поиска. Можно использовать представления для задания свойств, которые включаются в результаты, сортировки результатов и страницы результатов, чтобы получить только заданное количество результатов на ответа. Также можно сгруппировать результаты, значения определенного поля и элемента управления Глубина поиска путем указания типа обхода. И, наконец в папках поиска можно использовать для создания сохраняемого поиска, динамически обновляются при получении сообщения.
  
### <a name="sorting"></a>Сортировка

Можно получить сервер возвращал отсортированный результаты, которые можно упростить для отображения или обработки элементов в порядке. В этом примере результаты сортируются по даты/времени, полученные с помощью новых элементов, первый.
  
```cs
view.OrderBy.Add(ItemSchema.DateTimeReceived, SortDirection.Descending);
```

### <a name="paging"></a>Paging

При отправке запроса поиска с помощью управляемого интерфейса API веб-служб Exchange или веб-служб Exchange, укажите размер представления, который определяет максимальное число элементов, возвращаемых. Тем не менее число элементов на сервере, которые соответствуют поиска может быть больше, чем размер представления. В этом случае сервер указывает, что доступны дополнительные элементы. Можно [использовать разбиение на страницы для повторения поиска](how-to-perform-paged-searches-by-using-ews-in-exchange.md) и следующего набора результатов. 
  
Например можно отправить запрос поиска представления размером 10. Может быть их 15 элементов на сервере, которые соответствуют операции поиска, но вы получите только обратно первых 10, а также индикатор ( [FindItemsResults\<TItem\>. MoreAvailable](http://msdn.microsoft.com/en-us/library/dd635477%28v=exchg.80%29.aspx) свойства, если вы используете управляемый API EWS), что на сервере существуют дополнительные результаты. Затем можно отправить тот же поиск со смещением 10, чтобы получить следующие 10 элементов, которые соответствуют операции поиска. Сервер возвращает оставшиеся пять элементов. 
  
**На рисунке 1. Пример выгружаемый поиска**

![Изображение постраничного поиска. Изначально отправляется запрос на 10 элементов, а затем — запрос на следующие 10 элементов.](media/Ex15_Search_PagedSearch.png)
  
### <a name="grouping"></a>Группирование

 Exchange позволяет получать результаты поиска группы с определенного поля. Это помогает разбить результаты поиска в более управляемыми наборы. Например можно найти «собрания» и сгруппировать результаты по отправителям. Как показано на следующем рисунке, возвращенных элементов будут разделены на группы с все элементы, соответствующие критериям от этого отправителя в одной группе, все найденные элементы из другого пользователя в другую группу и т. д. 
  
**На рисунке 2. Результаты поиска, сгруппированных по отправителям**

![Изображение результатов поиска, сгруппированных по отправителям.](media/Ex15_Search_GroupedResults.png)
  
## <a name="search-folders"></a>Папки поиска
<a name="bk_SearchFolders"> </a>

Обычный поиск выполняется поиск, результаты возвращаются в приложение для обработки и поиск перестает существовать. Папки поиска позволяют сделать сохраняемого поиска. Это очень удобно для поиска, известно, что требуется выполнить несколько раз. Вместо выполнение же поиска несколько раз, приведет к оценке поиска «с нуля» каждый раз папки поиска выполняет поиска всегда на, позволяя сервера для обновления существующих результатов установить, как элементы будут добавлены или удалены из области поиска. Акт папок поиска как обычные папки, в том, что они отображаются в виде папок элементов, в которых элементы. Разница является единственным элементов, содержащихся в папке, соответствующие условия поиска, связанных с папкой. После создания папки поиска приложения можно получить актуальные результаты поиска только что, проверив содержимое папки.
  
Создание папки поиска при простой создаются Создание поисковых фильтров. В следующем примере для отображения всех сообщений электронной почты с темой, содержащий «собрания» создания папки поиска.
  
```cs
static void CreateSearchFolder(ExchangeService service)
{
    SearchFilter.ContainsSubstring subjectFilter = new SearchFilter.ContainsSubstring(ItemSchema.Subject,
        "meeting notes", ContainmentMode.Substring, ComparisonMode.IgnoreCase);
    SearchFolder searchFolder = new SearchFolder(service);
    searchFolder.DisplayName = "Meeting Notes";
    searchFolder.SearchParameters.RootFolderIds.Add(WellKnownFolderName.Inbox);
    searchFolder.SearchParameters.Traversal = SearchFolderTraversal.Deep;
    searchFolder.SearchParameters.SearchFilter = subjectFilter;
    searchFolder.Save(WellKnownFolderName.SearchFolders);
}
```

## <a name="in-this-section"></a>В этой статье
<a name="bk_InThisSection"> </a>

- [Используйте фильтры поиска с помощью веб-служб Exchange в Exchange](how-to-use-search-filters-with-ews-in-exchange.md)
    
- [Выполнение поискового запроса AQS с помощью веб-служб Exchange в Exchange](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md)
    
- [Выполнение поиска по выгружаемый с помощью веб-служб Exchange в Exchange](how-to-perform-paged-searches-by-using-ews-in-exchange.md)
    
- [Выполнение поиска по сгруппированных с помощью веб-служб Exchange в Exchange](how-to-perform-grouped-searches-by-using-ews-in-exchange.md)
    
- [Работа с папками поиска с помощью веб-служб Exchange в Exchange](how-to-work-with-search-folders-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a>См. также


- [Разработка клиентов веб-служб для Exchange](develop-web-service-clients-for-exchange.md)
    
- [Папка элементов для восстановления](https://docs.microsoft.com/en-us/exchange/policy-and-compliance/recoverable-items-folder/recoverable-items-folder)
    
- [ExchangeService.FindItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)
    
- [Параметры политики регулирования, влияющие на веб-служб Exchange операциях поиска](ews-throttling-in-exchange.md#bk_ThrottlingSearch)
    

