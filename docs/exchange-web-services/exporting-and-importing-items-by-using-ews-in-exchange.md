---
title: Экспорт и импорт элементов с помощью EWS в Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: ad5f75f9-47c3-4f51-a535-80cba4243683
description: Сведения об экспорте и импорте встреч, сообщений электронной почты, контактов, задач и других элементов почтовых ящиков с помощью управляемого API EWS или EWS в Exchange.
ms.openlocfilehash: 00c72806b95c162077733f77a52c4ea4da03631f
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2018
ms.locfileid: "21353653"
---
# <a name="exporting-and-importing-items-by-using-ews-in-exchange"></a>Экспорт и импорт элементов с помощью EWS в Exchange

Сведения об экспорте и импорте встреч, сообщений электронной почты, контактов, задач и других элементов почтовых ящиков с помощью управляемого API EWS или EWS в Exchange. 
  
Exchange — это золотой ряд важных сведений: Электронная почта, контакты, задачи и календари являются основными для функций Организации. EWS позволяет экспортировать и импортировать основные типы элементов с помощью трех различных подходов:
  
- Типы элементов Exchange. Этот подход рекомендуется для импорта и экспорта элементов в другие системы и файлы и из них.
    
- Возможность уровня элемента (только для EWS). Этот параметр рекомендуется использовать для экспорта или копирования с одного сервера Exchange Server или почтового ящика и импорта в другой.
    
- Потоки MIME в виде распространенных стандартных форматов файлов, таких как iCalendar и vCard. Так как набор свойств ограничен, а преобразование MIME является дорогостоящим, рекомендуем подход только для импорта или экспорта небольшого объема данных.
    
> [!IMPORTANT]
> Службы EWS не предназначены для резервного копирования и восстановления почтовых ящиков. Для резервного копирования и восстановления баз данных используйте [API резервного копирования и восстановления](../backup-restore/backup-and-restore-for-exchange-2013.md). На сайте TechNet вы также можете ознакомиться с [резервным копированием, восстановлением и аварийным восстановлением](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx) . 
  
**Таблица 1. Экспорт и импорт контактов, электронной почты и элементов календаря**

|Задача|Метод управляемого API EWS|Операция служб EWS|Примечания|
|:-----|:-----|:-----|:-----|
|Экспорт копии контакта, электронной почты, задачи или элемента календаря с [указанным набором свойств](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact. Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage. Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Встреча. Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> [Task. Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.bind%28v=exchg.80%29.aspx) <br/> |[GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |Этот вариант рекомендуется при экспорте элементов почтового ящика в другую систему или файл, не относящиеся к Exchange (включая типы файлов vCard и iCal).<br/>Так как у вас есть контроль над набором экспортированных свойств, а производительность сервера Exchange, как правило, является лучшим вариантом.<br/><br/>В зависимости от свойств, заданные для элемента почтового ящика, и от того, знает ли ваше приложение все несхематизированныеные идентификаторы свойств, которые могут быть заданы для элемента, этот параметр может не создавать полную копию.<br/><br/>Эти методы и операции предоставляют набор свойств схематизированные для элемента, а также все запрошенные расширенные свойства.<br/>Если вы знаете расширенные свойства, заданные для элемента, метод **BIND** или операция **GetItem** могут предоставлять полный экспорт элементов.<br/>Вы можете запросить все известные [Расширенные свойства](properties-and-extended-properties-in-ews-in-exchange.md) , чтобы обеспечить полную точность.<br/><br/>**Совет**: вы можете использовать функцию трассировки в УПРАВЛЯЕМОМ API EWS для получения XML-представления экспортируемых элементов.           Дополнительную информацию можно узнать [в статье экспорт элемента в настраиваемый формат](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom).  <br/> |
|Импорт копии контакта, электронной почты, задачи или элемента календаря с [указанным набором свойств](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact. Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx) <br/> [EmailMessage. Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Встреча. сохранение](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> [Task. Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.save%28v=exchg.80%29.aspx) <br/> |[CreateItem](http://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> |Этот параметр рекомендуется использовать для импорта элементов почтовых ящиков в Exchange.<br/>Для сохранения состояния импортированного элемента может потребоваться задать специальные свойства для некоторых типов элементов.<br/>Так как некоторые свойства задаются только в Exchange, а не в клиентах, не всегда возможно иметь возможность полного импорта.<br/><br/>Например, вы не можете импортировать собрание с участниками в почтовый ящик, так как Exchange устанавливает отношения между организатором и участниками. <br/>Это отношение можно установить только с помощью отправки организаторов и участников, принимающих приглашения на собрание и отвечающих им.<br/><br/>Объекты **встреч** в Exchange могут иметь сложные отношения и параметры.<br/> Встречи, у которых есть участники (собрания), имеют параметры, связывающие организатора собрания и участников собрания.<br/>Эти параметры не поддерживаются при экспорте и импорте встреч.<br/>Программное повторное создание связей организаторов и участников для собраний непосредственно для встреч не поддерживается.<br/>Вариант, который требуется для восстановления этих связей, состоит в выполнении после импорта после импорта, после чего Организатор повторно отправляет собрания и применяет их участникам.<br/>Вы можете использовать олицетворение Exchange, чтобы совершать звонки как для организатора, так и для участников.<br/>Перед импортом необходимо изменить свойство UID объекта **встреча** , чтобы избежать неправильной связи собраний с другими собраниями в почтовом ящике.  <br/> |
|Экспорт копии контакта, электронной почты, задачи или элемента календаря в режиме полного воспроизведения.  <br/> |Неприменимо  <br/> |[ExportItems](http://msdn.microsoft.com/library/e2846abb-0b16-4732-bbd8-038a674672f6%28Office.15%29.aspx) <br/> |Это лучший вариант экспорта элементов почтовых ящиков, которые нужно импортировать обратно в почтовый ящик Exchange.<br/>Кроме того, этот параметр можно использовать для копирования элементов между почтовыми ящиками.<br/><br/>Операция **ExportItems** предоставляет непрозрачный поток, представляющий элемент, который можно использовать для перемещения данных между почтовыми ящиками.<br/>Вы можете использовать **ExportItems** с операцией [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) , чтобы создать индекс для поиска элементов в другой системе.<br/>Невозможно изменить поток экспорта.  <br/> Дополнительную информацию можно узнать [в статье Экспорт элементов с полным](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity)соответствием.  <br/> |
|Импорт копии контакта, электронной почты, задачи или элемента календаря в режиме высокой четкости.  <br/> |Неприменимо  <br/> |[UploadItems](http://msdn.microsoft.com/library/a88cbe99-7968-454d-a545-4f92c330909f%28Office.15%29.aspx) <br/> |Это единственный вариант импорта элементов, экспортированных с помощью операции **ExportItems** .  <br/> |
|Экспорт копии контакта, электронной почты или элемента календаря в виде потока MIME для общего типа файлов.  <br/> |[Contact. Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage. Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Встреча. Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> |**GetItem** <br/> |Свойство [сохранитьmimecontent](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx) можно использовать для получения представления потока MIME для элемента.<br/><br/>В этом случае будет предоставлено базовое подмножество всех свойств элемента.<br/>Рекомендуется использовать только поток MIME для операций с одноразовым выходом.<br/>Не полагайтесь на MIME для крупного и частого импорта и экспорта элементов, так как Exchange выполняет преобразование контента для MIME, что может повлиять на производительность.<br/><br/>MIME-поток **контакта** — это файл [vCard](http://www.faqs.org/rfcs/rfc2426.html) (VCF).<br/>В зависимости от того, какие свойства настроены для контакта, это может не привести к созданию полной копии.<br/>Обратите внимание, что вы не можете импортировать контакт с помощью потока MIME в vCard.<br/>Чтобы узнать больше, ознакомьтесь со статьей [Экспорт контакта в файл vCard](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime).<br/><br/>**EmailMessage** MIME — это EML-файл.<br/>Формат EML удобен, так как Outlook и другие почтовые клиенты могут определить его.<br/>Вы также можете использовать MIME-поток для создания MHT-файла, который удобен, так как многие браузеры могут использовать этот тип файлов.<br/>EWS не предоставляет поток файлов. MSG для экспорта электронной почты в MSG – файл.<br/>Ваши параметры для экспорта MSG — это [Создание файла. MSG](http://msdn.microsoft.com/en-us/library/cc463912%28v=EXCHG.80%29.aspx) из результатов вызова метода **EmailMessage. Bind** или метода **GetItem** или с помощью СТОРОННЕГО API, который вызывает EWS и создает MSG-файл из результатов.<br/>Дополнительную информацию можно узнать в статье [Экспорт электронной почты в формате EML](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime).<br/><br/>Поток MIME для **встречи** — это файл в формате iCal (ICS).<br/>Формат. ICS удобен, так как Outlook и другие почтовые клиенты могут определить его.<br/>Это не является допустимым вариантом экспорта собраний, так как сведения об участниках не предоставляются в потоке MIME. <br/>Вложения и другие свойства могут не включаться в поток MIME.<br/>Рассмотрите создание формата iCal на основе объекта [встречи](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx) или XML-кода, возвращенного операцией **GetItem** .<br/>Таким образом, вы можете записать дополнительные свойства Exchange с расширенными свойствами ("X-") в файле iCal.<br/>Вы также можете экспортировать встречу в XML-форме.<br/>Вызовите операцию **GetItem** и сохраните XML в вашей системе.<br/>Вы также можете использовать [функции трассировки](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md) в УПРАВЛЯЕМОМ API EWS, чтобы зафиксировать XML-файл для размещения в базе данных XML.<br/>Дополнительные сведения приведены в статье [Экспорт встречи в формате iCal](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime).  <br/> |
|Импортировать копию электронной почты или элемента календаря в виде потока MIME для общего типа файлов.  <br/> |[EmailMessage. Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Встреча. сохранение](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> |**CreateItem** <br/> |Файл с расширением EML или ICS можно импортировать с помощью свойства **сохранитьmimecontent** объекта **EmailMessage** или **встречи** .<br/>Если адрес электронной почты не является черновиком, необходимо задать расширенное свойство [PidTagMessageFlags (0x0E07)](http://msdn.microsoft.com/en-us/library/office/cc839733%28v=office.15%29.aspx) .<br/><br/>Этот способ нельзя использовать для импорта собраний.  <br/> |
   
## <a name="alternatives-to-exporting-and-importing-items-by-using-ews"></a>Альтернативы экспорту и импорту элементов с помощью EWS
<a name="alternatives"> </a>

Другие параметры доступны для експоринг и импортирования элементов в почтовый ящик Exchange и из него. Ниже приведены некоторые соображения, которые следует учитывать при проектировании стратегии импорта и экспорта:
  
- Используйте PowerShell, чтобы вызвать EWS и отформатировать выходные данные в CSV-файл.
    
- Используйте сторонние библиотеки, которые реализуют MAPI для экспорта и импорта элементов. Сторонние библиотеки, которые преобразуют EWS в файлы. MSG, доступны и.
    
- Используйте командную консоль Exchange и командлеты [MailboxImportRequest](http://technet.microsoft.com/en-us/library/ff607310%28v=exchg.150%29.aspx) и [MailboxExportRequest](http://technet.microsoft.com/en-us/library/ff607299%28v=exchg.150%29.aspx) для [выполнения запросов на импорт и экспорт почтовых ящиков](http://technet.microsoft.com/en-us/library/ee633455%28v=exchg.150%29.aspx). 
    
- Используйте [Параметры импорта Outlook](http://office.microsoft.com/en-us/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx) для импорта и экспорта элементов. 
    
## <a name="in-this-section"></a>В этом разделе:
<a name="alternatives"> </a>

- [Экспорт элементов с помощью EWS в Exchange](how-to-export-items-by-using-ews-in-exchange.md)    
- [Импорт элементов с помощью EWS в Exchange](how-to-import-items-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a>См. также

- [Резервное копирование, восстановление и аварийное восстановление](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx)  
- [Ведение журнала](http://technet.microsoft.com/en-us/library/aa998649%28v=exchg.150%29.aspx)    
- [Спецификация основного объекта для календарей и планирования в Интернете (RFC 5545)](http://tools.ietf.org/html/rfc5545)   
- [Синхронизация почтового ящика и веб-службах Exchange](mailbox-synchronization-and-ews-in-exchange.md)
    

