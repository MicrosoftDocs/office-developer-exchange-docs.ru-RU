---
title: Взаимодействие с EWS с помощью управляемого API EWS
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.assetid: d1b78293-da02-413a-875c-681e99146af3
description: Сведения о том, как использовать управляемый API EWS для связи с EWS в Exchange.
localization_priority: Priority
ms.openlocfilehash: be807f2d936bf79d181476ec8eb12f20fca7950f
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2020
ms.locfileid: "44528246"
---
# <a name="communicate-with-ews-by-using-the-ews-managed-api"></a><span data-ttu-id="2b6bf-103">Взаимодействие с EWS с помощью управляемого API EWS</span><span class="sxs-lookup"><span data-stu-id="2b6bf-103">Communicate with EWS by using the EWS Managed API</span></span>

<span data-ttu-id="2b6bf-104">Сведения о том, как использовать управляемый API EWS для связи с EWS в Exchange.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-104">Find information about how to use the EWS Managed API to communicate with EWS in Exchange.</span></span>
  
<span data-ttu-id="2b6bf-105">Класс [ExchangeService](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservice%28v=exchg.80%29.aspx) в УПРАВЛЯЕМОМ API EWS содержит методы и свойства, которые используются для задания учетных данных пользователя, определения КОНЕЧНОЙ точки EWS, отправки и получения сообщений SOAP, а также для настройки привязки для связи с EWS.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-105">The [ExchangeService](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservice%28v=exchg.80%29.aspx) class in the EWS Managed API contains the methods and properties that you use to set user credentials, identify the EWS endpoint, send and receive SOAP messages, and configure the binding to communicate with EWS.</span></span> <span data-ttu-id="2b6bf-106">Прежде чем использовать управляемый API EWS для выполнения любой задачи, необходимо создать экземпляр класса **ExchangeService** и связать его с EWS.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-106">Before you can use the EWS Managed API to perform any task, you have to create an instance of the **ExchangeService** class and bind it to EWS.</span></span> 
  
<span data-ttu-id="2b6bf-107">После настройки объекта [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) с помощью учетных данных пользователя и КОНЕЧНОЙ точки EWS любой объект почтового ящика, ссылающийся на объект [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) , может использовать следующие типы методов для общения с EWS:</span><span class="sxs-lookup"><span data-stu-id="2b6bf-107">After you set up an [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) object with user credentials and the EWS endpoint, any mailbox object that references the [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) object can use the following method types to communicate with EWS:</span></span> 
  
- <span data-ttu-id="2b6bf-108">Методы объекта ExchangeService — все методы объекта **ExchangeService** , которые не наследуются от базового типа **объекта** , выполняют вызовы EWS.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-108">ExchangeService object methods — All the methods on the **ExchangeService** object that are not inherited from the base **Object** type make calls to EWS.</span></span> 
    
- <span data-ttu-id="2b6bf-109">Методы элементов и типов папок почтового ящика Exchange.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-109">Exchange mailbox item and folder type methods.</span></span>
    
<span data-ttu-id="2b6bf-110">**Таблица 1. Методы и типы папок почтового ящика, взаимодействующие с EWS**</span><span class="sxs-lookup"><span data-stu-id="2b6bf-110">**Table 1. Mailbox item and folder type methods that communicate with EWS**</span></span>

|<span data-ttu-id="2b6bf-111">Method</span><span class="sxs-lookup"><span data-stu-id="2b6bf-111">Method</span></span>|<span data-ttu-id="2b6bf-112">Действие</span><span class="sxs-lookup"><span data-stu-id="2b6bf-112">What it does</span></span>|<span data-ttu-id="2b6bf-113">Вызываемые операции</span><span class="sxs-lookup"><span data-stu-id="2b6bf-113">Operations that it calls</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="2b6bf-114">Load</span><span class="sxs-lookup"><span data-stu-id="2b6bf-114">Load</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.load%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="2b6bf-115">Получает свойства элемента, вложения или объекта конфигурации пользователя.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-115">Gets properties on an item, attachment, or user configuration object.</span></span>  <br/> |[<span data-ttu-id="2b6bf-116">Операция GetItem</span><span class="sxs-lookup"><span data-stu-id="2b6bf-116">GetItem operation</span></span>](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="2b6bf-117">Операция GetAttachment</span><span class="sxs-lookup"><span data-stu-id="2b6bf-117">GetAttachment operation</span></span>](https://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="2b6bf-118">Операция GetUserConfiguration</span><span class="sxs-lookup"><span data-stu-id="2b6bf-118">GetUserConfiguration operation</span></span>](https://msdn.microsoft.com/library/71d50e3c-92bd-435f-8118-b28bb85f8138%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="2b6bf-119">Базу</span><span class="sxs-lookup"><span data-stu-id="2b6bf-119">Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="2b6bf-120">Заполняет новый элемент на клиенте сведениями из существующего элемента на сервере.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-120">Populates a new item on the client with information from an existing item on the server.</span></span>  <br/> |[<span data-ttu-id="2b6bf-121">Операция GetItem</span><span class="sxs-lookup"><span data-stu-id="2b6bf-121">GetItem operation</span></span>](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="2b6bf-122">Save</span><span class="sxs-lookup"><span data-stu-id="2b6bf-122">Save</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.save%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="2b6bf-123">Сохраняет копию клиентского элемента на сервере.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-123">Saves the copy of the client item on the server.</span></span>  <br/> |[<span data-ttu-id="2b6bf-124">Операция UpdateItem</span><span class="sxs-lookup"><span data-stu-id="2b6bf-124">UpdateItem operation</span></span>](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="2b6bf-125">Операция UpdateFolder</span><span class="sxs-lookup"><span data-stu-id="2b6bf-125">UpdateFolder operation</span></span>](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="2b6bf-126">Операция CreateItem</span><span class="sxs-lookup"><span data-stu-id="2b6bf-126">CreateItem operation</span></span>](https://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="2b6bf-127">Операция CreateFolder</span><span class="sxs-lookup"><span data-stu-id="2b6bf-127">CreateFolder operation</span></span>](https://msdn.microsoft.com/library/6f6c334c-b190-4e55-8f0a-38f2a018d1b3%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="2b6bf-128">Обновление</span><span class="sxs-lookup"><span data-stu-id="2b6bf-128">Update</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="2b6bf-129">Обновляет сервер с учетом изменений, внесенных в клиенте.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-129">Updates the server with the changes made on the client.</span></span><br/><br/><span data-ttu-id="2b6bf-130">Для элементов и папок метод **Update** использует [операцию UpdateItem](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) и [операцию операцию UpdateFolder](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="2b6bf-130">For items and folders, the **Update** method uses the [UpdateItem operation](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) and the [UpdateFolder operation](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx).</span></span>  <br/> |[<span data-ttu-id="2b6bf-131">Операция UpdateItem</span><span class="sxs-lookup"><span data-stu-id="2b6bf-131">UpdateItem operation</span></span>](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="2b6bf-132">Операция UpdateFolder</span><span class="sxs-lookup"><span data-stu-id="2b6bf-132">UpdateFolder operation</span></span>](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="2b6bf-133">Удаление</span><span class="sxs-lookup"><span data-stu-id="2b6bf-133">Delete</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="2b6bf-134">Удаляет элемент на сервере.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-134">Deletes an item on the server.</span></span><br/><br/><span data-ttu-id="2b6bf-135">Для элементов и папок метод **Delete** использует [операцию и DeleteFolder](https://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="2b6bf-135">For items and folders, the **Delete** method uses the and the [DeleteFolder operation](https://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx).</span></span>  <br/> |[<span data-ttu-id="2b6bf-136">Операция DeleteItem</span><span class="sxs-lookup"><span data-stu-id="2b6bf-136">DeleteItem operation</span></span>](https://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="2b6bf-137">Операция DeleteFolder</span><span class="sxs-lookup"><span data-stu-id="2b6bf-137">DeleteFolder operation</span></span>](https://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="2b6bf-138">Copy</span><span class="sxs-lookup"><span data-stu-id="2b6bf-138">Copy</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="2b6bf-139">Создает копию элемента или папок на сервере.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-139">Creates a copy of the item or folders on the server.</span></span>  <br/> |[<span data-ttu-id="2b6bf-140">Операция CopyItem</span><span class="sxs-lookup"><span data-stu-id="2b6bf-140">CopyItem operation</span></span>](https://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="2b6bf-141">Операция CopyFolder</span><span class="sxs-lookup"><span data-stu-id="2b6bf-141">CopyFolder operation</span></span>](https://msdn.microsoft.com/library/c7ea0d68-9793-4144-b378-d99536776db9%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="2b6bf-142">Move</span><span class="sxs-lookup"><span data-stu-id="2b6bf-142">Move</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.move%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="2b6bf-143">Перемещает элементы или папки на сервере.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-143">Moves items or folders on the server.</span></span>  <br/> |[<span data-ttu-id="2b6bf-144">Операция MoveItem</span><span class="sxs-lookup"><span data-stu-id="2b6bf-144">MoveItem operation</span></span>](https://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="2b6bf-145">Операция MoveFolder</span><span class="sxs-lookup"><span data-stu-id="2b6bf-145">MoveFolder operation</span></span>](https://msdn.microsoft.com/library/c7233966-6c87-4a14-8156-b1610760176d%28Office.15%29.aspx) <br/> |
   
## <a name="to-use-the-ews-managed-api-to-communicate-with-ews"></a><span data-ttu-id="2b6bf-146">Использование управляемого API EWS для общения с EWS</span><span class="sxs-lookup"><span data-stu-id="2b6bf-146">To use the EWS Managed API to communicate with EWS</span></span>

1. <span data-ttu-id="2b6bf-147">Создайте экземпляр класса **ExchangeService** .</span><span class="sxs-lookup"><span data-stu-id="2b6bf-147">Instantiate the **ExchangeService** class.</span></span> 
    
   ```csharp
    ExchangeService service = new ExchangeService();
   ```

   > [!NOTE]
   > <span data-ttu-id="2b6bf-148">При создании экземпляра **ExchangeService** с пустым конструктором будет создан экземпляр, привязанный к последней известной версии Exchange.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-148">Instantiating **ExchangeService** with an empty constructor will create an instance that is bound to the latest known version of Exchange.</span></span> <span data-ttu-id="2b6bf-149">Кроме того, вы можете ориентироваться на определенную версию Exchange, указав в качестве параметра версию Version.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-149">Alternatively, you can target a specific version of Exchange by specifying version as a parameter.</span></span> `ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2007_SP1);`
  
2. <span data-ttu-id="2b6bf-150">Задайте учетные данные пользователя, который отправляет запросы на сервер Exchange.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-150">Set the credentials of the user who sends requests to the Exchange server.</span></span> <span data-ttu-id="2b6bf-151">Если вы хотите подключиться к EWS с компьютера, выполнившего вход в домен, используя учетные данные пользователя, прошедшего проверку подлинности, присвойте свойству **уседефаулткредентиалс** объекта **ExchangeService** **значение true**.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-151">If you want to connect to EWS from a computer that is logged on to the domain, using the credentials of the authenticated user, set the **UseDefaultCredentials** property on the **ExchangeService** object to **true**.</span></span>
    
   ```cs
    // Connect by using the default credentials of the authenticated user.
    service.UseDefaultCredentials = true;
   ```

   <span data-ttu-id="2b6bf-152">Если вы не хотите подключаться с помощью учетных данных пользователя по умолчанию, задайте для свойства **Credentials** объекта **ExchangeService** явное указание учетных данных другого пользователя.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-152">If you do not want to connect by using the default user credentials, set the **Credentials** property on the **ExchangeService** object to explicitly specify the credentials of a different user.</span></span> <span data-ttu-id="2b6bf-153">Если вы используете Exchange Online или Exchange Online в составе Office 365, вы будете использовать обычную проверку подлинности с использованием только имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-153">If you are using Exchange Online or Exchange Online as part of Office 365, you'll use basic authentication, with just a user name and password.</span></span> <span data-ttu-id="2b6bf-154">Для проверки подлинности NTLM необходимо указать имя домена.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-154">A domain name is required for NTLM authentication.</span></span> 
    
   ```cs
    // Connect by using the credentials of user1 at contoso.com.
    service.Credentials = new WebCredentials("user1@contoso.com", "password");
   ```

   <span data-ttu-id="2b6bf-155">Вы также можете указать учетные данные пользователя, используя доменное имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-155">You can also specify the credentials of the user by using the user's domain name and password.</span></span>
    
   ```cs
    // Connect by using the credentials of contoso/user1.
    service.Credentials = new WebCredentials("user1", "password", "contoso");
   ```

   > [!NOTE]
   > <span data-ttu-id="2b6bf-156">Если для свойства **уседефаулткредентиалс** задано значение **true**, то значение свойства **Credentials** игнорируется.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-156">If the **UseDefaultCredentials** property is set to **true**, the value of the **Credentials** property is ignored.</span></span> 
  
3. <span data-ttu-id="2b6bf-157">Задайте URL-адрес конечной точки EWS.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-157">Set the URL of the EWS endpoint.</span></span> <span data-ttu-id="2b6bf-158">Этот URL-адрес определяет расположение файла Exchange. asmx на сервере клиентского доступа.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-158">This URL locates the exchange.asmx file on Client Access server.</span></span>
    
   ```cs
    // Use Autodiscover to set the URL endpoint.
    service.AutodiscoverUrl("user1@contoso.com");
   ```

   > [!NOTE]
   >  <span data-ttu-id="2b6bf-159">Несмотря на то, что вы можете явно задать для свойства **URL** **ExchangeService** значение жестко заданное значение, рекомендуется использовать службу автообнаружения по следующим причинам: > служба автообнаружения определяет наилучшую конечную точку для определенного пользователя (конечная точка, ближайшую к серверу почтовых ящиков пользователей).</span><span class="sxs-lookup"><span data-stu-id="2b6bf-159">Although you can explicitly set the **Url** property of the **ExchangeService** to a hardcoded value, we recommend that you use the Autodiscover service instead, for the following reasons: >  Autodiscover determines the best endpoint for a given user (the endpoint that is closest to the user's Mailbox server).</span></span> <span data-ttu-id="2b6bf-160">> URL-адрес EWS может измениться при развертывании новых серверов клиентского доступа.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-160">>  The EWS URL might change if new Client Access servers are deployed.</span></span> <span data-ttu-id="2b6bf-161">В этом сценарии использование [автообнаружения](autodiscover-for-exchange.md) означает, что не требуется вносить изменения в код.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-161">In this scenario, using [Autodiscover](autodiscover-for-exchange.md) means no code changes are necessary.</span></span> <span data-ttu-id="2b6bf-162">> необходимо явно задать URL-адрес или вызвать **AutodiscoverUrl**, но не делать и то, и другое.</span><span class="sxs-lookup"><span data-stu-id="2b6bf-162">>  You should either set the URL explicitly or call **AutodiscoverUrl**, but you should not do both.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2b6bf-163">См. также</span><span class="sxs-lookup"><span data-stu-id="2b6bf-163">See also</span></span>

- [<span data-ttu-id="2b6bf-164">Начало работы с клиентскими приложениями, использующими управляемый API EWS</span><span class="sxs-lookup"><span data-stu-id="2b6bf-164">Get started with EWS Managed API client applications</span></span>](get-started-with-ews-managed-api-client-applications.md) 
- [<span data-ttu-id="2b6bf-165">Поиск точек соединения с помощью службы автообнаружения</span><span class="sxs-lookup"><span data-stu-id="2b6bf-165">Use Autodiscover to find connection points</span></span>](how-to-use-autodiscover-to-find-connection-points.md)   
- [<span data-ttu-id="2b6bf-166">Разработка клиентов веб-служб для Exchange</span><span class="sxs-lookup"><span data-stu-id="2b6bf-166">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    

