---
title: Передача прав доступа и EWS в Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 240d1776-7adc-46cd-9099-88ffeba0a8aa
description: Узнайте, как использовать управляемый API EWS и веб-служб Exchange в Exchange для обеспечения делегированный доступ к почтовым ящикам пользователей.
ms.openlocfilehash: 344255d86a51e13b21f1eda5113d292395d7cb8f
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2018
ms.locfileid: "21354052"
---
# <a name="delegate-access-and-ews-in-exchange"></a><span data-ttu-id="a07ab-103">Передача прав доступа и EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-103">Delegate access and EWS in Exchange</span></span>

<span data-ttu-id="a07ab-104">Узнайте, как использовать управляемый API EWS и веб-служб Exchange в Exchange для обеспечения делегированный доступ к почтовым ящикам пользователей.</span><span class="sxs-lookup"><span data-stu-id="a07ab-104">Find out how to use the EWS Managed API and EWS in Exchange to provide delegate access to users' mailboxes.</span></span>
  
<span data-ttu-id="a07ab-105">Можно предоставить пользователям возможность доступа к почтовым ящикам других пользователей в одном из трех следующих способов:</span><span class="sxs-lookup"><span data-stu-id="a07ab-105">You can enable users to access other users' mailboxes in one of three ways:</span></span> 
  
- <span data-ttu-id="a07ab-106">Добавление делегатов и задание разрешений для каждого делегата.</span><span class="sxs-lookup"><span data-stu-id="a07ab-106">By adding delegates and specifying permissions for each delegate.</span></span>
    
- <span data-ttu-id="a07ab-107">Путем изменения разрешений для папки напрямую.</span><span class="sxs-lookup"><span data-stu-id="a07ab-107">By modifying folder permissions directly.</span></span>
    
- <span data-ttu-id="a07ab-108">С помощью олицетворения.</span><span class="sxs-lookup"><span data-stu-id="a07ab-108">By using impersonation.</span></span>
    
<span data-ttu-id="a07ab-109">Разрешения для делегирования и папок, наиболее при только в случае предоставления доступа для нескольких пользователей, так как требуется добавить разрешения отдельно для каждого почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-109">Delegation and folder permissions are best when you're only granting access to a few users, because you have to add permissions individually to each mailbox.</span></span> <span data-ttu-id="a07ab-110">Олицетворение является оптимальным выбором, когда вы имеете дело с количества почтовых ящиков, так как можно просто включить одну учетную запись службы для доступа к всех почтовых ящиков в базе данных.</span><span class="sxs-lookup"><span data-stu-id="a07ab-110">Impersonation is the best choice when you're dealing with quantities of mailboxes, because you can easily enable one service account to access every mailbox in a database.</span></span> <span data-ttu-id="a07ab-111">На рисунке 1 показаны некоторые различия между каждый тип доступа.</span><span class="sxs-lookup"><span data-stu-id="a07ab-111">Figure 1 shows some of the differences between each type of access.</span></span>
  
<span data-ttu-id="a07ab-112">**На рисунке 1. Способы доступа к почтовым ящикам других пользователей**</span><span class="sxs-lookup"><span data-stu-id="a07ab-112">**Figure 1. Ways to access other users' mailboxes**</span></span>

![Схема, на которой показаны типы доступа к почтовому ящику, связь между владельцами почтовых ящиков и делегатом для каждого типа, а также тип разрешения. Отправка от лица разрешений для делегирования и разрешений папок. Отправка как разрешений для олицетворения.](media/Ex15_Delegate_Overview.png)
  
<span data-ttu-id="a07ab-116">При отправке почты и планирования собраний, делегаты можно задавать в разрешений «Отправить от имени», получателя сообщения электронной почты или приглашения на собрание, отправленное делегата будут видеть « *Делегирование* от имени *владельца почтового ящика* » при их receiv электронной почты или приглашения на собрание в Outlook.</span><span class="sxs-lookup"><span data-stu-id="a07ab-116">When it comes to sending mail or scheduling meetings, delegates can be given "send on behalf of" permissions, so the recipient of an email or a meeting request that was sent by a delegate will see " *delegate*  on behalf of  *mailbox owner*  " when they receive the email or meeting request in Outlook.</span></span> <span data-ttu-id="a07ab-117">Текст «Отправить от имени» — это сведения о реализации клиент - и могут быть созданы с помощью «от» и «отправитель» значений.</span><span class="sxs-lookup"><span data-stu-id="a07ab-117">Including the "send on behalf of" text is a client implementation detail - and can be created by using the "from" and "sender" values.</span></span> <span data-ttu-id="a07ab-118">Значение «от» указывает владельца почтового ящика, а значение «отправителя» — делегата, отправленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="a07ab-118">The "from" value indicates the mailbox owner, and the "sender" value indicates the delegate that sent the mail.</span></span> <span data-ttu-id="a07ab-119">Если учетная запись службы, олицетворение пользователя отправляет сообщение электронной почты или планирует собрание для владельца почтового ящика, сообщение «отправляется как» владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-119">If a service account impersonating a user sends an email or schedules a meeting for the mailbox owner, the message is "sent as" the mailbox owner.</span></span> <span data-ttu-id="a07ab-120">Нет возможности для получателя о том, что сообщение было отправлено функцией учетной записи службы.</span><span class="sxs-lookup"><span data-stu-id="a07ab-120">There is no way for the recipient to know the mail was sent by the service account.</span></span> <span data-ttu-id="a07ab-121">Пользователи, использующие предоставляются разрешения для папки не делегированный доступ, не могут «отправить как» или «отправить от имени» владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-121">Users who are granted folder permissions and not delegate access are not able to "send as" or "send on behalf of" of a mailbox owner.</span></span> <span data-ttu-id="a07ab-122">Они имеют доступ к папкам почтовых ящиков и может иметь возможность создавать элементы в папках, но они не могут отправлять элементы.</span><span class="sxs-lookup"><span data-stu-id="a07ab-122">They have access to the mailbox folders, and might be able to create items in the folders, but they cannot send the items.</span></span> 
  
<span data-ttu-id="a07ab-123">Когда это соответствующие непосредственно изменение разрешений для папки?</span><span class="sxs-lookup"><span data-stu-id="a07ab-123">When is it appropriate to modify folder permissions directly?</span></span> <span data-ttu-id="a07ab-124">Как правило, когда нужно предоставить пользователю доступ к папке, но не требуется предоставить разрешения «Отправить от имени», когда требований к разрешения не соответствуют значения перечисления [DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) управляемый API EWS или [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) Значения элементов веб-служб Exchange, или когда требуется предоставить пользователю доступ к одной папке настраиваемых.</span><span class="sxs-lookup"><span data-stu-id="a07ab-124">Generally, when you want to provide a user access to a folder, but do not want to grant the user "send on behalf of" permissions, when your permissions requirements do not map to the [DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) EWS Managed API enumeration values or the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) EWS element values, or when you want to provide a user access to a single custom folder.</span></span> 
  
<span data-ttu-id="a07ab-125">Если требуется изменить разрешения папки для достижения поставленной цели и не нужно добавить делегата (то есть, не требуются разрешения «Отправить от имени»), содержатся в разделе [Задание разрешений папки другого пользователя с помощью веб-служб Exchange в Exchange](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="a07ab-125">If you only need to modify folder permissions to achieve your goal, and do not need to add a delegate (that is, you don't need "send on behalf of" permissions), see [Set folder permissions for another user by using EWS in Exchange](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md).</span></span> 
  
<span data-ttu-id="a07ab-126">Обратите внимание, что можно также использовать [Outlook](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx) и [Exchange Server PowerShell (Командная консоль Exchange)](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) для настройки доступа делегата.</span><span class="sxs-lookup"><span data-stu-id="a07ab-126">Note that you can also use [Outlook](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx) or the [Exchange Server PowerShell (Exchange Management Shell)](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) to set up delegate access.</span></span> 
  
## <a name="how-does-delegate-access-work"></a><span data-ttu-id="a07ab-127">Как делегирования доступа?</span><span class="sxs-lookup"><span data-stu-id="a07ab-127">How does delegate access work?</span></span>

<span data-ttu-id="a07ab-128">Передача прав доступа позволяет пользователям получить доступ к некоторые или все папках владельца почтового ящика и действовать от имени владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-128">Delegate access enables users to access some or all of the mailbox owner's folders and act on behalf of the mailbox owner.</span></span> <span data-ttu-id="a07ab-129">Владелец почтового ящика может быть пользователя или ресурса, например конференц-зала.</span><span class="sxs-lookup"><span data-stu-id="a07ab-129">The mailbox owner can be a user, or a resource, like a conference room.</span></span> <span data-ttu-id="a07ab-130">Например секретарю могут быть предоставлены разрешения делегат для конференц-зала папки календаря, обрабатывать запросы на резервирование.</span><span class="sxs-lookup"><span data-stu-id="a07ab-130">For example, a receptionist can be granted delegate permissions to a conference room's calendar folder, to handle booking requests.</span></span> <span data-ttu-id="a07ab-131">Можно использовать управляемый API EWS или веб-служб Exchange для включения владельца почтового ящика или быть администратором добавить делегата, укажите, какие папки можно получить доступ к представителю, а затем укажите разрешения для этой папки.</span><span class="sxs-lookup"><span data-stu-id="a07ab-131">You can use the EWS Managed API or EWS to enable the mailbox owner or an administrator to add a delegate, specify what folders the delegate can access, and then specify permissions for that folder.</span></span> <span data-ttu-id="a07ab-132">Делегаты могут иметь доступ к следующие папки:</span><span class="sxs-lookup"><span data-stu-id="a07ab-132">Delegates can be granted access to the following folders:</span></span> 
  
- <span data-ttu-id="a07ab-133">Календарь</span><span class="sxs-lookup"><span data-stu-id="a07ab-133">Calendar</span></span>
    
- <span data-ttu-id="a07ab-134">Задачи</span><span class="sxs-lookup"><span data-stu-id="a07ab-134">Tasks</span></span>
    
- <span data-ttu-id="a07ab-135">Inbox</span><span class="sxs-lookup"><span data-stu-id="a07ab-135">Inbox</span></span>
    
- <span data-ttu-id="a07ab-136">Контакты</span><span class="sxs-lookup"><span data-stu-id="a07ab-136">Contacts</span></span>
    
- <span data-ttu-id="a07ab-137">����������</span><span class="sxs-lookup"><span data-stu-id="a07ab-137">Notes</span></span>
    
- <span data-ttu-id="a07ab-138">������</span><span class="sxs-lookup"><span data-stu-id="a07ab-138">Journal</span></span>
    
<span data-ttu-id="a07ab-139">При наличии делегированный доступ к одному или нескольким из этих папок, их можно создавать, получение, обновление, удаление, копировать и поиск элементов в этой папке и вложенных папок, в зависимости от [разрешений](#bk_delegateperms) , установленные в общей папке.</span><span class="sxs-lookup"><span data-stu-id="a07ab-139">When a user has delegate access to one or more of these folders, they can create, get, update, delete, copy, and search for items in that folder and any child folders, depending on the [permissions](#bk_delegateperms) set on the folder.</span></span> <span data-ttu-id="a07ab-140">Способ, в которой приложение выполняет следующие действия зависит от ли [явных](#bk_explicit) и [неявных](#bk_implicit) доступа является обязательным.</span><span class="sxs-lookup"><span data-stu-id="a07ab-140">The way in which the application performs these actions depends on whether [explicit](#bk_explicit) or [implicit](#bk_implicit) access is required.</span></span> 
  
## <a name="delegate-permissions"></a><span data-ttu-id="a07ab-141">Делегирование разрешений</span><span class="sxs-lookup"><span data-stu-id="a07ab-141">Delegate permissions</span></span>
<span data-ttu-id="a07ab-142"><a name="bk_delegateperms"> </a></span><span class="sxs-lookup"><span data-stu-id="a07ab-142"></span></span>

<span data-ttu-id="a07ab-143">Когда администратор или владелец почтового ящика добавляет делегата в почтовый ящик, их можно задать уровень разрешений для одной или нескольких папок.</span><span class="sxs-lookup"><span data-stu-id="a07ab-143">When an administrator or mailbox owner adds a delegate to a mailbox, they can also set the permission level for one or more folders.</span></span> <span data-ttu-id="a07ab-144">Если уровень разрешений для папки не задано, значение разрешения по умолчанию используется значение None.</span><span class="sxs-lookup"><span data-stu-id="a07ab-144">If a permission level is not set for a folder, the permission value defaults to None.</span></span> <span data-ttu-id="a07ab-145">Несколько пользователей может иметь уровень разрешений на папку, а пользователи могут иметь разные уровни для разных папок.</span><span class="sxs-lookup"><span data-stu-id="a07ab-145">Multiple users can have the same permission level on a folder, and users can have different permission levels for different folders.</span></span> <span data-ttu-id="a07ab-146">Если вы используете управляемый API веб-служб Exchange, используется свойство [DelegateUser.Permissions](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx) , которое содержит одно из значений перечисления [DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) для каждой папки, чтобы задать делегированных разрешений для папки.</span><span class="sxs-lookup"><span data-stu-id="a07ab-146">If you're using the EWS Managed API, you use the [DelegateUser.Permissions](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx) property, which contains one of the [DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) enumeration values for each folder, to set delegate permissions on folders.</span></span> <span data-ttu-id="a07ab-147">При использовании веб-служб Exchange, используйте элемент [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) and [DelegatePermissions](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx) элемента, который требуется задать делегат разрешения для определения уровня разрешений.</span><span class="sxs-lookup"><span data-stu-id="a07ab-147">If you're using EWS, you use the [DelegatePermissions](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx) element to set delegate permissions, and the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) element to define the permission level.</span></span> 
  
<span data-ttu-id="a07ab-148">**В таблице 2. Делегирование уровни разрешений**</span><span class="sxs-lookup"><span data-stu-id="a07ab-148">**Table 2. Delegate permission levels**</span></span>

|<span data-ttu-id="a07ab-149">**Уровень разрешений**</span><span class="sxs-lookup"><span data-stu-id="a07ab-149">**Permission level**</span></span>|<span data-ttu-id="a07ab-150">**Описание**</span><span class="sxs-lookup"><span data-stu-id="a07ab-150">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="a07ab-151">Нет</span><span class="sxs-lookup"><span data-stu-id="a07ab-151">None</span></span>  <br/> |<span data-ttu-id="a07ab-152">Это значение по умолчанию для всех папок.</span><span class="sxs-lookup"><span data-stu-id="a07ab-152">This is the default value for all folders.</span></span>  <br/> |
|<span data-ttu-id="a07ab-153">Author</span><span class="sxs-lookup"><span data-stu-id="a07ab-153">Author</span></span>  <br/> |<span data-ttu-id="a07ab-154">Делегат можно читать и создавать элементы и изменять и удалять элементы, которые они создают.</span><span class="sxs-lookup"><span data-stu-id="a07ab-154">A delegate can read and create items, and modify and delete items they create.</span></span> <span data-ttu-id="a07ab-155">Например делегата Создание приглашений на собрания и поручения непосредственно в папке календаря или задач владельца почтового ящика и затем отправить их от имени владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-155">For example, a delegate can create task requests and meeting requests directly in the mailbox owner's Task or Calendar folder, and then send either item on the mailbox owner's behalf.</span></span>  <br/> |
|<span data-ttu-id="a07ab-156">Редактор</span><span class="sxs-lookup"><span data-stu-id="a07ab-156">Editor</span></span>  <br/> |<span data-ttu-id="a07ab-157">Делегат можно делать все автор сделать, а также можно изменять и удалять элементы, созданные владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-157">A delegate can do everything an Author can do, and also modify and delete the items the mailbox owner created.</span></span>  <br/> |
|<span data-ttu-id="a07ab-158">Редактор</span><span class="sxs-lookup"><span data-stu-id="a07ab-158">Reviewer</span></span>  <br/> |<span data-ttu-id="a07ab-159">Делегат может читать элементы. Например делегат с разрешением редактор можно читать сообщения в папки «Входящие» другого пользователя.</span><span class="sxs-lookup"><span data-stu-id="a07ab-159">A delegate can read items; for example a delegate with Reviewer permission can read messages in another person's Inbox.</span></span>  <br/> |
|<span data-ttu-id="a07ab-160">Пользовательский сервер</span><span class="sxs-lookup"><span data-stu-id="a07ab-160">Custom</span></span>  <br/> |<span data-ttu-id="a07ab-161">Владелец почтового ящика присвоен пользовательский набор разрешений для делегата.</span><span class="sxs-lookup"><span data-stu-id="a07ab-161">The mailbox owner has granted a custom set of permissions to the delegate.</span></span>  <br/> |
   
<span data-ttu-id="a07ab-162">Управляемый API EWS [DelgateUser.ViewPrivateItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx) свойство и элемент [ViewPrivateItems](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx) веб-служб Exchange — это глобальный параметр, который влияет на все владельца почтового ящика, включая все почты, контакты, календарь, задачи, заметки и журнала папки.</span><span class="sxs-lookup"><span data-stu-id="a07ab-162">The [DelgateUser.ViewPrivateItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx) EWS Managed API property and the [ViewPrivateItems](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx) EWS element is a global setting that affects all the mailbox owner's folders, including all Mail, Contacts, Calendar, Tasks, Notes, and Journal folders.</span></span> <span data-ttu-id="a07ab-163">Не удается разрешить доступ к частной элементов в папке.</span><span class="sxs-lookup"><span data-stu-id="a07ab-163">You cannot allow access to private items in only one folder.</span></span> 
  
## <a name="explicit-access"></a><span data-ttu-id="a07ab-164">Явный доступ</span><span class="sxs-lookup"><span data-stu-id="a07ab-164">Explicit access</span></span>
<span data-ttu-id="a07ab-165"><a name="bk_explicit"> </a></span><span class="sxs-lookup"><span data-stu-id="a07ab-165"></span></span>

<span data-ttu-id="a07ab-166">Просто put, явные доступа — это способ входа для делегатов, которые будут выполнять действия с папкам или элементам владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-166">Simply put, explicit access is the entry way for delegates to perform actions on a mailbox owner's folders or items.</span></span> <span data-ttu-id="a07ab-167">Явные доступа для делегата при они включают имя хорошо известные папки для папки владельца почтового ящика, а также SMTP-адреса владельца почтового ящика в запросе на сервере.</span><span class="sxs-lookup"><span data-stu-id="a07ab-167">Explicit access is granted to a delegate when they include the well-known folder name for a mailbox owner's folder along with the mailbox owner's SMTP address in a request to the server.</span></span> <span data-ttu-id="a07ab-168">Доступ является явных, поскольку запрос делегата явным образом том, что контекст для метода или операция почтового ящика владельца почтового ящика и не в почтовом ящике представителя.</span><span class="sxs-lookup"><span data-stu-id="a07ab-168">The access is explicit because the delegate's request explicitly states that the context for the method or operation is the mailbox owner's mailbox, and not the delegate's mailbox.</span></span>
  
<span data-ttu-id="a07ab-169">Явный доступ определяет контекст для всех методов и операции, выполненные папок и элементов, переход вперед.</span><span class="sxs-lookup"><span data-stu-id="a07ab-169">Explicit access defines the context for all methods or operations performed on the folders or items moving forward.</span></span> <span data-ttu-id="a07ab-170">Все идентификаторы элементов и папок, возвращаемое при явный доступ задано однозначно идентифицируют себя как принадлежащие владельцу почтового ящика (не в любой человеческого формат для чтения).</span><span class="sxs-lookup"><span data-stu-id="a07ab-170">All item and folder IDs returned when the explicit access is set uniquely identify themselves as belonging to the mailbox owner (although not in any human readable format).</span></span> <span data-ttu-id="a07ab-171">Таким образом, приложение может не указать SMTP-адреса владельца почтового ящика повторно; контекст скрыта в идентификаторы.</span><span class="sxs-lookup"><span data-stu-id="a07ab-171">This way, the application doesn't need to specify the mailbox owner's SMTP address again and again; the context is hidden in the identifiers.</span></span> <span data-ttu-id="a07ab-172">После идентификации элемента или папки делегат использует [неявный доступ](#bk_implicit) для изменения элемента.</span><span class="sxs-lookup"><span data-stu-id="a07ab-172">After an item or folder is identified, a delegate actually uses [implicit access](#bk_implicit) to modify the item.</span></span> <span data-ttu-id="a07ab-173">На следующем рисунке показана в процессе получения явных и неявных доступа.</span><span class="sxs-lookup"><span data-stu-id="a07ab-173">The following figure shows the process of getting explicit and implicit access.</span></span> 
  
<span data-ttu-id="a07ab-174">**На рисунке 2. Разрешения на запрос явных и неявных доступ к элементу или папки**</span><span class="sxs-lookup"><span data-stu-id="a07ab-174">**Figure 2. Requesting explicit and implicit access to an item or folder**</span></span>

![Схема, на которой показано приложение, отправляющее запрос на явный доступ, ответ от сервера, запрос на неявный доступ и ответ от сервера.](media/Ex15_Delegate_ExplictImplicit.png)
  
<span data-ttu-id="a07ab-176">Можно задать явный доступ в различных сценариях.</span><span class="sxs-lookup"><span data-stu-id="a07ab-176">You can set explicit access in many different scenarios.</span></span> <span data-ttu-id="a07ab-177">В сущности каждый раз при отправке папки код в метод или операции, задается явный доступ.</span><span class="sxs-lookup"><span data-stu-id="a07ab-177">Essentially, any time you're sending a folder ID in a method or operation, you can set explicit access.</span></span> <span data-ttu-id="a07ab-178">Это может включать в себя выявление папки, поиск встречи, извлечение элементов, поиск бесед и т. д.</span><span class="sxs-lookup"><span data-stu-id="a07ab-178">This can include finding folders, finding appointments, getting items, finding conversations, and so on.</span></span>
  
### <a name="explicit-access-and-the-ews-managed-api"></a><span data-ttu-id="a07ab-179">Явный доступ и управляемый API веб-служб Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-179">Explicit access and the EWS Managed API</span></span>
<span data-ttu-id="a07ab-180"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="a07ab-180"></span></span>

<span data-ttu-id="a07ab-181">Можно инициировать явные делегированный доступ, можно использовать любой из следующих перегруженные методы, которые принимают параметр [FolderId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx) ввода для идентификации целевой папке:</span><span class="sxs-lookup"><span data-stu-id="a07ab-181">You can initiate explicit delegate access by using any of the following overloaded methods that take a [FolderId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx) input parameter to identify the target folder:</span></span> 
  
- [<span data-ttu-id="a07ab-182">Folder.Bind</span><span class="sxs-lookup"><span data-stu-id="a07ab-182">Folder.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folder.bind%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="a07ab-183">ExchangeService.FindItems</span><span class="sxs-lookup"><span data-stu-id="a07ab-183">ExchangeService.FindItems</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="a07ab-184">ExchangeService.FindAppointments</span><span class="sxs-lookup"><span data-stu-id="a07ab-184">ExchangeService.FindAppointments</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.findappointments%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="a07ab-185">ExchangeService.FindFolders</span><span class="sxs-lookup"><span data-stu-id="a07ab-185">ExchangeService.FindFolders</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.findfolders%28v=exchg.80%29.aspx)
    
- <span data-ttu-id="a07ab-186">И многое другое.</span><span class="sxs-lookup"><span data-stu-id="a07ab-186">And more!</span></span>
    
<span data-ttu-id="a07ab-187">Параметр **FolderId** в каждой из этих методов для определения папка назначения владельца почтового ящика, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="a07ab-187">You can use the **FolderId** parameter in each of these methods to identify the mailbox owner's target folder, as follows.</span></span> 
  
```cs
new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com");
```

<span data-ttu-id="a07ab-188">Например для привязки к папке календаря **FolderId** в этот метод **привязки** указывает имя известных папки и SMTP-адреса владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-188">For example, to bind to the Calendar folder, the **FolderId** in this **Bind** method specifies the well-known folder name, and the mailbox owner's SMTP address.</span></span> 
  
```cs
CalendarFolder calendar = CalendarFolder.Bind(service, new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), new PropertySet());
```

<span data-ttu-id="a07ab-189">Указав имя известных папки и SMTP-адрес, делегат можно привязать к папке календаря владельца почтового ящика, а следовательно, увеличит явный доступ к папке.</span><span class="sxs-lookup"><span data-stu-id="a07ab-189">By specifying the well-known folder name and the SMTP address, the delegate can bind to the mailbox owner's Calendar folder — thereby gaining explicit access to the folder.</span></span> <span data-ttu-id="a07ab-190">Все последующие запросы на [неявный доступ](#bk_implicit) для элементов в папке, в затем используют контекста, возвращаемых в элементе идентификаторов и папки.</span><span class="sxs-lookup"><span data-stu-id="a07ab-190">All subsequent requests for [implicit access](#bk_implicit) to items in the folder then rely on the context returned in the item IDs and folder IDs.</span></span> <span data-ttu-id="a07ab-191">По сути идентификаторы содержит контекста для вызовов доступа подразумеваемых делегата.</span><span class="sxs-lookup"><span data-stu-id="a07ab-191">Essentially, the identifiers contain the context for the implied delegate access calls.</span></span> <span data-ttu-id="a07ab-192">Или, чтобы получить идентификатор элемента, который соответствует определенному набору условий, используйте следующее.</span><span class="sxs-lookup"><span data-stu-id="a07ab-192">Or, to retrieve the item ID of an item that meets specific criteria, use the following.</span></span> 
  
```cs
FindItemsResults<Item> results = service.FindItems(new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), filter, view);
```

<span data-ttu-id="a07ab-193">В этом случае возвращается идентификатор элемента, и затем делегат использовать неявный доступ для внесения изменений к элементу с помощью идентификатор элемента.</span><span class="sxs-lookup"><span data-stu-id="a07ab-193">In this case the item ID is returned, and then the delegate can then use implicit access to make changes to the item by using the item ID.</span></span>
  
<span data-ttu-id="a07ab-194">У вас нет для инициации явный доступ еще раз, пока не требуется идентификатор элемента или идентификатор папки, не получить доступ с помощью существующих явный доступ.</span><span class="sxs-lookup"><span data-stu-id="a07ab-194">You don't have to initiate explicit access again until you require an item ID or a folder ID that you didn't access via the existing explicit access.</span></span> 
  
### <a name="explicit-access-and-ews"></a><span data-ttu-id="a07ab-195">Явный доступ и веб-служб Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-195">Explicit access and EWS</span></span>
<span data-ttu-id="a07ab-196"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="a07ab-196"></span></span>

<span data-ttu-id="a07ab-197">Можно инициировать явный доступ с помощью операции [GetFolder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx), [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)или [FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a07ab-197">You can initiate explicit access by using the [GetFolder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx), [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx), or [FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) operations.</span></span> <span data-ttu-id="a07ab-198">Эти операции содержат параметр, чтобы использовать элемент [DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) для идентификации целевой папке.</span><span class="sxs-lookup"><span data-stu-id="a07ab-198">These operations provide the option to use the [DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) element to identify the target folder.</span></span> <span data-ttu-id="a07ab-199">Элемент **DistinguishedFolderId** имеет один необязательный дочерний элемент, элемент [почтового ящика](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a07ab-199">The **DistinguishedFolderId** element has a single optional child element, the [Mailbox](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) element.</span></span> <span data-ttu-id="a07ab-200">Элемент **почтового ящика** , при использовании в качестве дочернего для элемента **DistinguishedFolderId** , указывает почтовый ящик для делегата для доступа.</span><span class="sxs-lookup"><span data-stu-id="a07ab-200">The **Mailbox** element, when used as a child of the **DistinguishedFolderId** element, specifies the mailbox for the delegate to access.</span></span> <span data-ttu-id="a07ab-201">Если вызывающий пользователь имеет разрешения на доступ к папке владельца почтового ящика, ответ будет содержать коллекцию идентификаторов для элементов или папок в этот почтовый ящик.</span><span class="sxs-lookup"><span data-stu-id="a07ab-201">If the calling user has permission to access the mailbox owner's folder, the response will contain a collection of identifiers to items or folders in that mailbox.</span></span> <span data-ttu-id="a07ab-202">Идентификаторы элементов и папок, возвращаемого в ответе можно использовать для доступа к неявных делегата.</span><span class="sxs-lookup"><span data-stu-id="a07ab-202">The item and folder identifiers that are returned in the response can be used for implicit delegate access.</span></span> 
  
## <a name="implicit-access"></a><span data-ttu-id="a07ab-203">Неявный доступ</span><span class="sxs-lookup"><span data-stu-id="a07ab-203">Implicit access</span></span>
<span data-ttu-id="a07ab-204"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="a07ab-204"></span></span>

<span data-ttu-id="a07ab-205">После того как делегат извлек идентификатор для элемента или папки в почтовом ящике владельца почтового ящика и делегата, где требуется реализовать для обновления, удаления или скопировать элемент используется неявный доступ.</span><span class="sxs-lookup"><span data-stu-id="a07ab-205">Implicit access is used after a delegate has retrieved the ID for an item or folder in the mailbox owner's mailbox and the delegate wants to update, delete, or copy the item.</span></span> <span data-ttu-id="a07ab-206">Если делегат использует этот идентификатор ID элемента или папки в запросе, изменении элемента в почтовом ящике владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-206">When the delegate uses that item or folder ID in a request, the changes are made to the item in the mailbox owner's mailbox.</span></span> <span data-ttu-id="a07ab-207">Делегат не нужно включать SMTP-адреса владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-207">The delegate does not have to include the mailbox owner's SMTP address.</span></span> 
  
<span data-ttu-id="a07ab-208">К примеру при делегата включен в одной из папок владельца почтового ящика, делегат можно выполнить операции **FindItem** папку с помощью идентификатора папки без явного определения почтового ящика владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="a07ab-208">For example, when a delegate has the ID of one of the mailbox owner's folders, the delegate can perform a **FindItem** operation on that folder by using the folder ID, without explicitly identifying the mailbox owner's mailbox.</span></span> <span data-ttu-id="a07ab-209">На этом этапе делегат могут выполнять действия с папки владельца почтового ящика с помощью идентификаторов, возвращаемых в ответах.</span><span class="sxs-lookup"><span data-stu-id="a07ab-209">At that point, the delegate can perform actions on the mailbox owner's folder by using the IDs that are returned in the responses.</span></span> 
  
### <a name="implicit-access-and-the-ews-managed-api"></a><span data-ttu-id="a07ab-210">Неявный доступ и управляемый API веб-служб Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-210">Implicit access and the EWS Managed API</span></span>

<span data-ttu-id="a07ab-211">Если идентификатор элемента извлекается с помощью метода [FindItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) , можно использовать этот идентификатор элемента в последующих вызова метода [Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) для привязки к элементу.</span><span class="sxs-lookup"><span data-stu-id="a07ab-211">If an item ID was retrieved by the [FindItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) method, that item ID can be used in a subsequent [Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method call to bind to the item.</span></span> <span data-ttu-id="a07ab-212">Затем можно вызвать метод [Item.Update](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx), [Item.Delete](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx)или [Item.Copy](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) — или любой вызов метода, которому требуется идентификатор элемента — при необходимости для завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="a07ab-212">You can then call the [Item.Update](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx), [Item.Delete](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx), or [Item.Copy](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) method — or any method call that requires an item ID — as needed to complete your task.</span></span> <span data-ttu-id="a07ab-213">Поскольку делегат имеет соответствующие разрешения на папку, содержащую элемент (и, если это возможно, в папке элемент перемещается), делегат можно внести изменения в соответствии с их уровни разрешений.</span><span class="sxs-lookup"><span data-stu-id="a07ab-213">As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
### <a name="implicit-access-and-ews"></a><span data-ttu-id="a07ab-214">Неявный доступ и веб-служб Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-214">Implicit access and EWS</span></span>

<span data-ttu-id="a07ab-215">Если идентификатор элемента было извлечено операцией [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) , можно использовать этот идентификатор элемента в последующие операции [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) для привязки к элементу.</span><span class="sxs-lookup"><span data-stu-id="a07ab-215">If an item ID was retrieved by the [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) operation, that item ID can be used in subsequent [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operations to bind to the item.</span></span> <span data-ttu-id="a07ab-216">Затем можно вызвать операции [UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx), [DeleteItem](../web-service-reference/deleteitem-operation.md)или [CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) — или любые операции, требующие идентификатор элемента, необходимые для выполнения задачи.</span><span class="sxs-lookup"><span data-stu-id="a07ab-216">You can then call the [UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx), [DeleteItem](../web-service-reference/deleteitem-operation.md), or [CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) operation — or any operation that requires an item ID — as needed to complete your task.</span></span> <span data-ttu-id="a07ab-217">Поскольку делегат имеет соответствующие разрешения на папку, содержащую элемент (и, если это возможно, в папке элемент перемещается), делегат можно внести изменения в соответствии с их уровни разрешений.</span><span class="sxs-lookup"><span data-stu-id="a07ab-217">As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="a07ab-218">В этой статье</span><span class="sxs-lookup"><span data-stu-id="a07ab-218">In this section</span></span>
<span data-ttu-id="a07ab-219"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="a07ab-219"></span></span>

- [<span data-ttu-id="a07ab-220">Добавление и удаление делегаты с помощью веб-служб Exchange в Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-220">Add and remove delegates by using EWS in Exchange</span></span>](how-to-add-and-remove-delegates-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="a07ab-221">Доступ к календарю в качестве делегата с помощью веб-служб Exchange в Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-221">Access a calendar as a delegate by using EWS in Exchange</span></span>](how-to-access-a-calendar-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="a07ab-222">Контакты доступа роли представителя с помощью веб-служб Exchange в Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-222">Access contacts as a delegate by using EWS in Exchange</span></span>](how-to-access-contacts-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="a07ab-223">Доступ к электронной почте в качестве делегата с помощью веб-служб Exchange в Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-223">Access email as a delegate by using EWS in Exchange</span></span>](how-to-access-email-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="a07ab-224">Настройка разрешений папки другого пользователя с помощью веб-служб Exchange в Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-224">Set folder permissions for another user by using EWS in Exchange</span></span>](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="a07ab-225">Обработка ошибок, связанных с делегирования в веб-служб Exchange в Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-225">Handling delegation-related errors in EWS in Exchange</span></span>](handling-delegation-related-errors-in-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="a07ab-226">См. также</span><span class="sxs-lookup"><span data-stu-id="a07ab-226">See also</span></span>


- [<span data-ttu-id="a07ab-227">Разработка клиентов веб-служб для Exchange</span><span class="sxs-lookup"><span data-stu-id="a07ab-227">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="a07ab-228">Разрешить другому пользователю управлять почта и календарь</span><span class="sxs-lookup"><span data-stu-id="a07ab-228">Allow someone else to manage your mail and calendar</span></span>](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx)
    
- [<span data-ttu-id="a07ab-229">Добавление MailboxPermission</span><span class="sxs-lookup"><span data-stu-id="a07ab-229">Add- MailboxPermission</span></span>](http://technet.microsoft.com/en-us/library/bb124097%28v=exchg.150%29.aspx)
    

