---
title: Олицетворение и EWS в Exchange
manager: sethgros
ms.date: 08/24/2020
ms.audience: Developer
ms.assetid: 7e1ea63c-eb29-43d2-827f-2f2b1846483b
description: Узнайте, как и когда использовать олицетворение в приложениях-службах Exchange.
localization_priority: Priority
ms.openlocfilehash: da35fb04f316c21a1c85c71b789b7f1485653466
ms.sourcegitcommit: 636c05a929279812c6ef87d75b01c166a4a05584
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2020
ms.locfileid: "47254974"
---
# <a name="impersonation-and-ews-in-exchange"></a>Олицетворение и EWS в Exchange

Узнайте, как и когда использовать олицетворение в [приложениях-службах](ews-application-types.md) Exchange.
  
Вы можете предоставить пользователям доступ к почтовым ящикам других пользователей одним из трех способов:
  
- добавив представителей и указав разрешения для каждого из них;
    
- вручную изменив разрешения для папки;
    
- с помощью олицетворения.
    
Когда следует выбирать олицетворение вместо делегирования или изменения разрешений для папки? Принимая это решение, воспользуйтесь приведенными ниже рекомендациями.
  
- Изменение разрешений для папки подойдет в том случае, если вы хотите предоставить пользователю доступ к папке, но не хотите, чтобы пользователь имел разрешения "отправить от имени". 
    
- Используйте делегированный доступ, если хотите предоставить одному пользователю разрешение на выполнение действий от имени другого пользователя. Как правило, это разрешение вида "один к одному" или "один ко многим". Например, один помощник администратора управляет календарем администратора или один диспетчер переговорных управляет календарями использования нескольких переговорных.
    
- Олицетворение подойдет в том случае, если вашему приложению-службе нужен доступ к нескольким почтовым ящикам, в которых оно будет "действовать как" их владелец.
    
Олицетворение — лучший вариант при работе с несколькими почтовыми ящиками, так как позволяет легко предоставить одной служебной учетной записи доступ к каждому почтовому ящику в базе данных. Варианты делегирования и изменения разрешений для папки лучше всего использовать для предоставления доступа только нескольким пользователям, поскольку вам придется добавлять разрешения для каждого почтового ящика отдельно. На рис. 1 показаны некоторые различия между этими типами доступа.
  
**Рис. 1. Способы доступа к почтовым ящикам других пользователей**

![Схема, на которой показаны типы доступа к почтовому ящику, связь между владельцами почтовых ящиков и делегатом для каждого типа, а также тип разрешения. Отправка от лица разрешений для делегирования и разрешений папок. Отправка как разрешений для олицетворения.](media/Ex15_Delegate_Overview.png)
  
Олицетворение хорошо подходит для приложений, которые подключаются к Exchange Online, Exchange Online в составе Office 365 и к локальным версиям Exchange и выполняют такие операции, как архивация электронной почты, автоматическая настройка параметров при отсутствии на рабочем месте для пользователей в отпуске и любые другие задачи, для выполнения которых необходимо, чтобы приложение действовало как владелец почтового ящика. Когда приложение использует олицетворение для отправки сообщения, сообщение выглядит как отправленное владельцем почтового ящика. Получатель не сможет установить, что оно было отправлено с помощью учетной записи службы. Делегирование, с другой стороны, дает другой учетной записи электронной почты разрешение на выполнение действий от имени владельца почтового ящика. При отправке сообщения электронной почты представителем в поле "От" указывается владелец почтового ящика, а в поле "Отправитель" — представитель, отправивший сообщение. 
  
## <a name="security-considerations-for-impersonation"></a>Соображения безопасности, связанные с олицетворением

Олицетворение позволяет вызывающей стороне олицетворить определенную учетную запись пользователя. Таким образом вызывающая сторона может выполнять операции, используя вместо разрешений своей учетной записи те разрешения, которые сопоставлены с олицетворенной учетной записью. Поэтому при использовании олицетворения необходимо учитывать перечисленные ниже соображения безопасности.
  
- Олицетворение могут применять только учетные записи, которым администратор сервера Exchange назначил роль **ApplicationImpersonation**. 
    
- Необходимо создать область управления, ограничивающую олицетворение определенной группой учетных записей. Если область управления не создана, роль **ApplicationImpersonation** назначается всем учетным записям в организации. 
    
- Как правило, роль **ApplicationImpersonation** предоставляется служебной учетной записи, предназначенной для отдельного приложения или группы приложений, а не учетной записи пользователя. Вы можете создать столько служебных учетных записей, сколько потребуется. 
    
Вы можете ознакомиться с дополнительной информацией о [настройке олицетворения](how-to-configure-impersonation.md), однако вам необходимо обратиться к своему администратору Exchange, чтобы обеспечить создание служебных учетных записей с необходимыми [разрешениями и правами доступа](https://technet.microsoft.com/library/dd351175%28v=exchg.150%29.aspx), соответствующим требованиям вашей организации в области безопасности. 
  
## <a name="in-this-section"></a>Содержание

- [Настройка олицетворения](how-to-configure-impersonation.md)
    
- [Определение учетной записи для олицетворения](how-to-identify-the-account-to-impersonate.md)
    
- [Добавление встреч с помощью олицетворения в Exchange](how-to-add-appointments-by-using-exchange-impersonation.md)

## <a name="performance-considerations-for-ews-impersonation"></a>Соображения, связанные с безопасностью при олицетворении с помощью EWS

При использовании олицетворения с помощью EWS, необходимо всегда правильно устанавливать параметры заголовка X-AnchorMailbox.  В противном случае вы можете получить сообщение об ошибке 500 или 503. Это очень важно для показателей производительности и уведомлений в Exchange Online и Exchange 2013.  Если не настроить этот заголовок, время выполнения вызова может увеличиться в два и более раз. В некоторых случаях можно также задать время ожидания. 
    
## <a name="see-also"></a>См. также


- [Разработка клиентов веб-служб для Exchange](develop-web-service-clients-for-exchange.md)
    
- [Передача прав доступа и EWS в Exchange](delegate-access-and-ews-in-exchange.md)
    
- [Разрешения в Exchange 2013](https://technet.microsoft.com/library/dd351175%28v=exchg.150%29.aspx)
    

