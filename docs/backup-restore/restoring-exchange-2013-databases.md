---
title: Восстановление баз данных Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: e0804bb1-fd66-448a-b2cb-9ae2726ae888
description: Найдите сведения о различных способах возможности восстановления баз данных Exchange 2013.
ms.openlocfilehash: d3ca3a884b0ad30f7d7968a9ed435b02aaf205e1
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19760949"
---
# <a name="restoring-exchange-2013-databases"></a>Восстановление баз данных Exchange 2013

Найдите сведения о различных способах возможности восстановления баз данных Exchange 2013. 
  
**Применимо к:** Exchange Server 2013 
  
Модуль записи Exchange, включенный в Exchange Server 2013 обеспечивает некоторые гибкость в как восстановление баз данных Exchange. С помощью модуля записи Exchange в Exchange 2013, можно восстановить теневых копий по следующим адресам:
  
- Исходной базы данных, независимо от того, были ли изменены конфигурацию путь файла базы данных или транзакций журнала.
    
- Базы данных восстановления.
    
- Любой производственной базы данных, независимо от того, является ли отображаемое имя базы данных совпадает с именем в архив служба теневого копирования ТОМОВ.
    
Когда приложение восстановления восстанавливает сведения с исходной базой данных, файлов журнала необходимо восстанавливать каталог пути, указанному в доменных службах Active Directory (AD DS) для этой базы данных. Если приложение, восстанавливает базу данных в другом месте, файлов журнала, необходимо восстанавливать в папку с именем **_restoredLogs** , расположенное в папке файла журнала базы данных. 
  
При восстановлении на сервер или базу данных, отличного от исходной базы данных, восстановление приложения необходимо убедитесь, что база данных каталога для VSS соответствие путей в Доменных службах Active Directory. [get-MailboxDatabase](http://technet.microsoft.com/en-us/library/bb124924%28v=exchg.150%29.aspx)используется командная консоль Exchange можно использовать для получения сведений о существующих баз данных. Дополнительные сведения о командной консоли Exchange можно [Exchange Server PowerShell (Командная консоль Exchange)](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps). 
  
На следующем рисунке показана последовательность событий в типичного восстановить базы данных Exchange, который является управляемым путем службы теневого копирования томов (VSS).
  
**На рисунке 1. Последовательность событий при восстановлении баз данных**

![Диаграмма, показывающая последовательность событий для процесса восстановления. Последовательность начинается с запуска хранилищ Exchange, после чего службой записи Exchange, VSS и клиентским приложением выполняется ряд действий.](media/VSS_StoreWriterRestore.gif)
  
## <a name="restoring-exchange-databases-to-the-original-location"></a>Восстановление баз данных Exchange в исходное расположение
<a name="bk_OriginalLocation"> </a>

Модуль записи Exchange позволяет приложениям для восстановления баз данных и файлы журнала транзакций в исходные папки на сервере Exchange. По умолчанию модуля записи Exchange преобразует файлы журналов транзакций после инициатор подтверждает, что восстановление закончено во время операции [OnPostRestore](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381566%28v=vs.85%29.aspx) . Восстановление приложения необходимо использовать метод служба теневого копирования ТОМОВ [SetAdditionalRestores](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382829%28v=vs.85%29.aspx) для предотвращения воспроизведения файлов журнала. Файлы журнала, поможет в дальнейшем, когда администратор Exchange или приложение снова подключает восстановленной базы данных. 
  
При восстановлении баз данных их исходной базы данных объектов (таким образом, что идентификаторы GUID целевой базы данных соответствуют архива), но для разных путей приложения необходимо определить текущего пути к файлам и восстановления файлов резервных копий для соответствующий файл пути, указанных в свойствах базы данных. Источник запроса необходимо вызвать метод [AddNewTarget](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382648%28v=vs.85%29.aspx) сообщать модуля записи Exchange расположение, где будут восстановлены файлы перед модуля записи можно продолжить процесс восстановления. Если **AddNewTarget** не вызывается, Exchange предполагается, что резервные копии будут восстановлены в пути к файлам, указанных в документ метаданных резервного копирования. 
  
Как правило приложения не нужно указать новый путь для резервного копирования, выполняемыми из копии группы обеспечения доступности баз данных (DAG). Администраторы Exchange обычно не изменяйте пути к файлам базы данных и журнала. В конфигурации группы доступности базы данных тем не менее, приложение резервного копирования может потребоваться задание активной базы данных и журнала пути, поскольку пути для копирования файлов группы доступности базы данных всегда могут отличаться от этих путей.
  
Обратите внимание на то, что Exchange 2013 не поддерживает восстановление неактивных копий базы данных для обеспечения доступности баз данных. Копий группы доступности базы данных может быть восстановлена из резервной копии данных, только в том случае, если восстанавливается активной копии базы данных. С помощью различных резервных наборов данных или при попытке восстановления подмножество копий базы данных может привести к базе данных стать подключения. Приложений резервного копирования нет необходимости в этом случае вызовите функцию [SetRestoreOptions](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382856%28v=vs.85%29.aspx) так, как восстанавливать резервные копии в исходной базы данных объектов, которые они были созданы на основе. Тем не менее если приложение резервного копирования вызывает **SetRestoreOptions** и XML-документ метаданных имеет правильные параметры, результат не ошибка. 
  
## <a name="restoring-exchange-databases-to-a-recovery-database"></a>Восстановление баз данных Exchange для базы данных восстановления
<a name="bk_RecoveryDatabase"> </a>

Записи Exchange позволяет восстанавливать данные непосредственно для базы данных восстановления. Монтажные восстановленные данные в виде базы данных восстановления позволяет администратору Exchange для восстановления отдельных почтовых ящиков и даже отдельных элементов в почтовом ящике.
  
Если базы данных восстановления уже существует, приложение может отсоединить базу данных, восстановление данных на восстановление базы данных и файлов журналов и затем подключите базу данных.
  
Каждый сервер Exchange 2013 обеспечивает только одна база данных восстановления подключить за раз. Сервер может содержать столько восстановленные базы данных позволяет место на диске, но только один может быть установлена как базы данных восстановления. Базы данных, установленных в качестве базы данных восстановления учитывается в поле Максимальное число баз данных, которые можно подключить за раз. Подготовить восстановленную базу данных, поскольку базы данных восстановления сервера не связан с исходным почтовым ящиком никаких уведомлений.
  
Для восстановления базы данных восстановления, приложения необходимо вызвать метод [SetRestoreOptions](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382856%28v=vs.85%29.aspx) и предоставляют XML-документа, которое указывает, источник и предназначенных для идентификаторов GUID базы данных. Источник идентификаторы GUID должны совпадать с из резервного набора данных и конечного идентификаторы GUID должны совпадать с записями целевой базы данных в Доменных службах Active Directory. Приложение резервного копирования также необходимо вызвать метод [AddNewTarget](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382648%28v=vs.85%29.aspx) , чтобы указать путь к каталогу, где эти файлы будут восстановлены. Если файлы базы данных необходимо переименовать, модуля записи Exchange будет переименовать базы данных во время операции [OnPostRestore](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381566%28v=vs.85%29.aspx) . Файлы журнала транзакций для восстановления в папке ( **_restoredLogs**) требует Exchange в текущий файл журнала транзакций. Если файлы журналов будут восстановлены в другое расположение, модуля записи Exchange возвращает ошибку. Так как базы данных установленных в качестве базы данных восстановления не будут восстановлены в исходное расположение, они должны быть предъявлены в состояние чистого отключения, прежде чем их можно подключить. По умолчанию модуля записи Exchange будет приведения восстановленных баз данных в состояние чистого отключения во время после восстановления. Если ваше приложение резервного копирования вызывает метод [SetAdditionalRestores](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382829%28v=vs.85%29.aspx) , модуля записи Exchange не будет воспроизведение файлов журнала и администратор или приложение резервного копирования необходимо перевести базу данных в состояние чистого отключения перед монтажные База данных. 
  
## <a name="restoring-exchange-databases-to-a-recovery-server"></a>Восстановление баз данных Exchange на сервере восстановления
<a name="bk_RecoveryServer"> </a>

В некоторых случаях может потребоваться восстановить резервную копию в другой сервер; Например, может потребоваться восстановление после сбоя аварийное сервера после переноса базы данных почтовых ящиков на другой сервер Exchange 2013 в той же организации Exchange или восстановление выделенного сервера за пределами в рабочей среде, чтобы восстановить почтовый ящик и данные общедоступных папок. 
  
В следующих сценариях пути к файлам для целевой базы данных, а также его GUID объекта, отличаются от тех, для исходной базы данных. Таким образом ваше приложение должно вызвать метод [SetRestoreOptions](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382856%28v=vs.85%29.aspx) с XML-документа, которое указывает, источник и сведения о целевой базы данных и вызов метода [AddNewTarget](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382648%28v=vs.85%29.aspx) для указания пути для файлов резервной копии для восстановления . Для модуля записи Exchange в этом восстановления совпадает с восстановлением базы данных восстановления. Для получения дополнительных сведений см [Exchange восстановление баз данных для базы данных восстановления](restoring-exchange-2013-databases.md#bk_RecoveryDatabase) ранее в этой статье. 
  
## <a name="see-also"></a>См. также
<a name="bk_AdditionalResources"> </a>

- [Типы операций резервного копирования для Exchange 2013](types-of-backup-operations-for-exchange-2013.md)
    
- [Построение резервное копирование и восстановление приложений для Exchange 2013](build-backup-and-restore-applications-for-exchange-2013.md)
    
- [Основные понятия резервного копирования и восстановления для Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md)
    
- [Справочник по CChkSGFiles классов](cchksgfiles-class-reference.md)
    

