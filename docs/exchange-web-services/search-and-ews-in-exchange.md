---
title: Поиск и веб-службах Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 9fa5b836-857e-401d-9450-51e7dbc69104
description: Узнайте, как искать элементы в Exchange с помощью управляемого API EWS или EWS.
ms.openlocfilehash: d35cc74ab2fa79530ac09256e315a780023d833b
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2020
ms.locfileid: "44463839"
---
# <a name="search-and-ews-in-exchange"></a><span data-ttu-id="281be-103">Поиск и веб-службах Exchange</span><span class="sxs-lookup"><span data-stu-id="281be-103">Search and EWS in Exchange</span></span>

<span data-ttu-id="281be-104">Узнайте, как искать элементы в Exchange с помощью управляемого API EWS или EWS.</span><span class="sxs-lookup"><span data-stu-id="281be-104">Find out how to search for items in Exchange by using the EWS Managed API or EWS.</span></span>

<span data-ttu-id="281be-105">Не похоже на этом?</span><span class="sxs-lookup"><span data-stu-id="281be-105">Does this sound familiar?</span></span> <span data-ttu-id="281be-106">Вы захотите запустить проект, который вы отправили для недели, и вам понадобятся сведения о проекте, который ваш руководитель отправил вам через электронную почту назад.</span><span class="sxs-lookup"><span data-stu-id="281be-106">You're finally starting that project you've been putting off for weeks, and you need information about the project that your manager sent you in email weeks ago.</span></span> <span data-ttu-id="281be-107">В папке "Входящие" есть сотни или, возможно, тысячи сообщений.</span><span class="sxs-lookup"><span data-stu-id="281be-107">Your Inbox has hundreds or perhaps thousands of messages in it.</span></span> <span data-ttu-id="281be-108">Чем занимаешься?</span><span class="sxs-lookup"><span data-stu-id="281be-108">What do you do?</span></span> <span data-ttu-id="281be-109">Прокрутите электронную почту и отменяйте каждую тему и отправителя, пока она не будет найдена.</span><span class="sxs-lookup"><span data-stu-id="281be-109">Do you scroll through your email scanning each subject and sender until you find it?</span></span> <span data-ttu-id="281be-110">Или вы используете функцию поиска в любимом почтовом клиенте, чтобы быстро получить нулевое значение в зависимости от того, что вам нужно?</span><span class="sxs-lookup"><span data-stu-id="281be-110">Or do you use the search feature in your favorite email client to quickly zero in on what you need?</span></span>

<span data-ttu-id="281be-111">Функция поиска, вероятно, является обязательной для любого почтового клиента.</span><span class="sxs-lookup"><span data-stu-id="281be-111">Search is arguably a must-have feature for any email client.</span></span> <span data-ttu-id="281be-112">Но поиск можно использовать не только для пользователей, но и для поиска в их почтовом ящике.</span><span class="sxs-lookup"><span data-stu-id="281be-112">But search can be used for a lot more than just enabling users to search their mailbox.</span></span> <span data-ttu-id="281be-113">Требуется ли приложению обрабатывать встречи, находящиеся в определенном времени Windows?</span><span class="sxs-lookup"><span data-stu-id="281be-113">Does your app need to process appointments that fall within specific time windows?</span></span> <span data-ttu-id="281be-114">Возможно, вам потребуется создать отчет по всем элементам задач с определенным состоянием или переместить все контакты с определенным названием компании в другую папку.</span><span class="sxs-lookup"><span data-stu-id="281be-114">Maybe you need to report on all task items with a specific status, or move all contacts with a specific company name to a different folder.</span></span> <span data-ttu-id="281be-115">Поиск поможет вам выполнить все эти требования.</span><span class="sxs-lookup"><span data-stu-id="281be-115">Search can help with all of these requirements.</span></span>

## <a name="search-basics"></a><span data-ttu-id="281be-116">Основы поиска</span><span class="sxs-lookup"><span data-stu-id="281be-116">Search basics</span></span>
<span data-ttu-id="281be-117"><a name="bk_SearchBasics"> </a></span><span class="sxs-lookup"><span data-stu-id="281be-117"><a name="bk_SearchBasics"> </a></span></span>

<span data-ttu-id="281be-118">Управляемый API EWS и EWS предоставляют два основных способа указания поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-118">The EWS Managed API and EWS offer two basic methods for specifying a search.</span></span> <span data-ttu-id="281be-119">Вы можете использовать [Фильтр поиска](how-to-use-search-filters-with-ews-in-exchange.md) или [строку запроса](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="281be-119">You can use a [search filter](how-to-use-search-filters-with-ews-in-exchange.md) or a [query string](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md).</span></span> <span data-ttu-id="281be-120">Используемый способ зависит от цели поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-120">The method you use depends on the intent behind your search.</span></span>

<span data-ttu-id="281be-121">**Таблица 1. Сценарии для фильтров поиска и поисковых запросов**</span><span class="sxs-lookup"><span data-stu-id="281be-121">**Table 1. Scenarios for search filters and search queries**</span></span>

|<span data-ttu-id="281be-122">**Задача**</span><span class="sxs-lookup"><span data-stu-id="281be-122">**If you want to…**</span></span>|<span data-ttu-id="281be-123">**Используйте...**</span><span class="sxs-lookup"><span data-stu-id="281be-123">**Use a…**</span></span>|<span data-ttu-id="281be-124">**Примечания**</span><span class="sxs-lookup"><span data-stu-id="281be-124">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="281be-125">Ограничьте поиск определенным свойством или набором свойств</span><span class="sxs-lookup"><span data-stu-id="281be-125">Limit your search to a specific property or set of properties</span></span>  <br/> |<span data-ttu-id="281be-126">Фильтр поиска</span><span class="sxs-lookup"><span data-stu-id="281be-126">Search filter</span></span>  <br/> |<span data-ttu-id="281be-127">Фильтры поиска обеспечивают лучший уровень управления поиском свойств.</span><span class="sxs-lookup"><span data-stu-id="281be-127">Search filters provide the best level of control over which properties are searched.</span></span> <span data-ttu-id="281be-128">Несмотря на то, что строки запросов могут ориентироваться на ограниченный набор свойств с помощью расширенного синтаксиса запросов (AQS), фильтры поиска могут ориентироваться на любое свойство.</span><span class="sxs-lookup"><span data-stu-id="281be-128">Although query strings can target a limited set of properties by using Advanced Query Syntax (AQS), search filters can target any property.</span></span>  <br/> |
|<span data-ttu-id="281be-129">Создание поисковых запросов с использованием нескольких условий</span><span class="sxs-lookup"><span data-stu-id="281be-129">Create searches with multiple criteria</span></span>  <br/> |<span data-ttu-id="281be-130">Фильтр поиска</span><span class="sxs-lookup"><span data-stu-id="281be-130">Search filter</span></span>  <br/> |<span data-ttu-id="281be-131">С помощью фильтров поиска можно объединять несколько критериев поиска с логическими смешивать и или или, позволяя выполнять поиски, например "Тема содержит" заметки о собраниях и отправителя равно "Ольга Даниелс" ".</span><span class="sxs-lookup"><span data-stu-id="281be-131">With search filters, multiple search criteria can be joined together with logical ANDs or ORs, allowing for searches like "subject contains 'Meeting Notes' AND sender equals 'Sadie Daniels'".</span></span> <span data-ttu-id="281be-132">Хотя строки запросов также могут соединяться с несколькими критериями поиска, они ограничены набором свойств, которые поддерживаются строками запросов.</span><span class="sxs-lookup"><span data-stu-id="281be-132">Although query strings can also join multiple search criteria, they are limited to the set of properties supported by query strings.</span></span>  <br/> |
|<span data-ttu-id="281be-133">Настраиваемые свойства поиска</span><span class="sxs-lookup"><span data-stu-id="281be-133">Search custom properties</span></span>  <br/> |<span data-ttu-id="281be-134">Фильтр поиска</span><span class="sxs-lookup"><span data-stu-id="281be-134">Search filter</span></span>  <br/> |<span data-ttu-id="281be-135">Фильтры поиска могут запланировать настраиваемые свойства.</span><span class="sxs-lookup"><span data-stu-id="281be-135">Search filters can target custom properties.</span></span> <span data-ttu-id="281be-136">Строки запросов не выполняют поиск настраиваемых свойств.</span><span class="sxs-lookup"><span data-stu-id="281be-136">Query strings do not search custom properties.</span></span>  <br/> |
|<span data-ttu-id="281be-137">Выполнение поиска с учетом регистра символов строкового свойства</span><span class="sxs-lookup"><span data-stu-id="281be-137">Perform a case sensitive search of string properties</span></span>  <br/> |<span data-ttu-id="281be-138">Фильтр поиска</span><span class="sxs-lookup"><span data-stu-id="281be-138">Search filter</span></span>  <br/> |<span data-ttu-id="281be-139">При поиске в строке запроса регистр не учитывается.</span><span class="sxs-lookup"><span data-stu-id="281be-139">Query string searches are not case sensitive.</span></span>  <br/> |
|<span data-ttu-id="281be-140">Управление режимом включения при поиске строковые свойства</span><span class="sxs-lookup"><span data-stu-id="281be-140">Control the containment mode when searching string properties</span></span>  <br/> |<span data-ttu-id="281be-141">Фильтр поиска</span><span class="sxs-lookup"><span data-stu-id="281be-141">Search filter</span></span>  <br/> |<span data-ttu-id="281be-142">Поиск строки запроса всегда выполняет поиск в подстроках.</span><span class="sxs-lookup"><span data-stu-id="281be-142">Query string searches are always substring searches.</span></span> <span data-ttu-id="281be-143">Если вам нужно выполнить поиск по определенным префиксам или требуется точное совпадение, лучше всего подходит фильтр поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-143">If you need to search for specific prefixes, or require exact matches, a search filter is the best choice.</span></span>  <br/> |
|<span data-ttu-id="281be-144">Поиск папок</span><span class="sxs-lookup"><span data-stu-id="281be-144">Search for folders</span></span>  <br/> |<span data-ttu-id="281be-145">Фильтр поиска</span><span class="sxs-lookup"><span data-stu-id="281be-145">Search filter</span></span>  <br/> |<span data-ttu-id="281be-146">EWS не поддерживает поиск папок со строкой запроса.</span><span class="sxs-lookup"><span data-stu-id="281be-146">EWS does not support searching for folders with a query string.</span></span>  <br/> |
|<span data-ttu-id="281be-147">Создание папки поиска</span><span class="sxs-lookup"><span data-stu-id="281be-147">Create a search folder</span></span>  <br/> |<span data-ttu-id="281be-148">Фильтр поиска</span><span class="sxs-lookup"><span data-stu-id="281be-148">Search filter</span></span>  <br/> |<span data-ttu-id="281be-149">EWS не поддерживает создание папок поиска со строкой запроса.</span><span class="sxs-lookup"><span data-stu-id="281be-149">EWS does not support creating search folders with a query string.</span></span>  <br/> |
|<span data-ttu-id="281be-150">Поиск по всем часто используемым свойствам</span><span class="sxs-lookup"><span data-stu-id="281be-150">Search across all commonly used properties</span></span>  <br/> |<span data-ttu-id="281be-151">Строка запроса</span><span class="sxs-lookup"><span data-stu-id="281be-151">Query string</span></span>  <br/> |<span data-ttu-id="281be-152">Строки запросов, которые не содержат AQS, будут выполнять поиск по всем часто используемым свойствам.</span><span class="sxs-lookup"><span data-stu-id="281be-152">Query strings that do not contain AQS will search across all commonly used properties.</span></span> <span data-ttu-id="281be-153">Например, значение строки запроса "МАКК Чавес" возвратит все сообщения, отправленные МАКК Чавес, а также сообщения с "МАКК Чавес" в тексте или теме.</span><span class="sxs-lookup"><span data-stu-id="281be-153">For example, a query string value of "Mack Chaves" will return all messages sent by Mack Chaves as well as any messages that have "Mack Chaves" in the body or subject.</span></span>  <br/> |
|<span data-ttu-id="281be-154">Создание поиска на основе простого пользовательского ввода</span><span class="sxs-lookup"><span data-stu-id="281be-154">Construct a search based on simple user input</span></span>  <br/> |<span data-ttu-id="281be-155">Строка запроса</span><span class="sxs-lookup"><span data-stu-id="281be-155">Query string</span></span>  <br/> |<span data-ttu-id="281be-156">Строка запроса — это отличный вариант, позволяющий конечному пользователю выполнять быстрый поиск, вводя простую строку.</span><span class="sxs-lookup"><span data-stu-id="281be-156">A query string is a great choice for allowing an end user to do a quick search by typing in a simple string.</span></span> <span data-ttu-id="281be-157">Так как поиск строки запроса включает все часто используемые свойства, результаты будут содержать все элементы, содержащие условия поиска пользователя.</span><span class="sxs-lookup"><span data-stu-id="281be-157">Because a query string search includes all commonly used properties, the results will contain any items that contain the user's search terms.</span></span>  <br/> |

### <a name="using-a-search-filter"></a><span data-ttu-id="281be-158">Использование фильтра поиска</span><span class="sxs-lookup"><span data-stu-id="281be-158">Using a search filter</span></span>

<span data-ttu-id="281be-159">Фильтры поиска предоставляют широкий спектр параметров поиска и большую степень контроля над выполнением поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-159">Search filters give you a wide range of search options and the greatest degree of control over how the search is performed.</span></span> <span data-ttu-id="281be-160">Фильтры поиска можно использовать для выполнения базового поиска по совпадению и сравнению, но вы также можете выполнять поиск в содержимом строкового свойства или при сравнении битовой маски.</span><span class="sxs-lookup"><span data-stu-id="281be-160">You can use search filters to perform basic equality and comparison searches, but you can also search within the contents of string properties or do bitmask comparisons.</span></span>

<span data-ttu-id="281be-161">Например, можно выполнить поиск по содержимому темы элементов с помощью класса [SearchFilter. контаинссубстринг](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.searchfilter.containssubstring%28v=exchg.80%29.aspx) в УПРАВЛЯЕМОМ API EWS.</span><span class="sxs-lookup"><span data-stu-id="281be-161">For example, you can search the contents of the subject of items by using the [SearchFilter.ContainsSubstring](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.searchfilter.containssubstring%28v=exchg.80%29.aspx) class in the EWS Managed API.</span></span> <span data-ttu-id="281be-162">В этом примере создается фильтр поиска для поиска темы для подстроки "заметки к собранию" без учета регистра.</span><span class="sxs-lookup"><span data-stu-id="281be-162">In this example, a search filter is created to search the subject for the substring "meeting notes", ignoring case.</span></span>

```cs
SearchFilter.ContainsSubstring subjectFilter = new SearchFilter.ContainsSubstring(ItemSchema.Subject,
    "meeting notes", ContainmentMode.Substring, ComparisonMode.IgnoreCase);
```

<span data-ttu-id="281be-163">Кроме того, можно выполнять поиск по настраиваемым свойствам.</span><span class="sxs-lookup"><span data-stu-id="281be-163">You can also search against custom properties.</span></span> <span data-ttu-id="281be-164">В этом примере для настраиваемого свойства **итеминдекс** выполняется поиск по значениям, превышающим 3.</span><span class="sxs-lookup"><span data-stu-id="281be-164">In this example, the custom property **ItemIndex** is searched for values greater than 3.</span></span>

```cs
Guid MyAppGuid = new Guid("{AA3DF801-4FC7-401F-BBC1-7C93D6498C2E}");
ExtendedPropertyDefinition customPropDefinition =
    new ExtendedPropertyDefinition(MyAppGuid, "ItemIndex", MapiPropertyType.Integer);
SearchFilter.IsGreaterThan customPropFilter =
    new SearchFilter.IsGreaterThan(customPropDefinition, 3);
```

<span data-ttu-id="281be-165">Кроме того, можно сочетать несколько фильтров поиска для создания более сложных поисков.</span><span class="sxs-lookup"><span data-stu-id="281be-165">You can also combine multiple search filters to create more complex searches.</span></span> <span data-ttu-id="281be-166">Например, можно объединить два предыдущих фильтра с логическим и с помощью класса [SearchFilter. SearchFilterCollection](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.searchfilter.searchfiltercollection%28v=exchg.80%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="281be-166">For example, you can combine the previous two filters with a logical AND by using the [SearchFilter.SearchFilterCollection](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.searchfilter.searchfiltercollection%28v=exchg.80%29.aspx) class.</span></span>

```cs
SearchFilter.SearchFilterCollection compoundFilter =
    new SearchFilter.SearchFilterCollection(LogicalOperator.And, subjectFilter, customPropFilter);
```

### <a name="using-a-query-string"></a><span data-ttu-id="281be-167">Использование строки запроса</span><span class="sxs-lookup"><span data-stu-id="281be-167">Using a query string</span></span>

<span data-ttu-id="281be-168">Строки запросов обеспечивают другой способ поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-168">Query strings provide a different approach to search.</span></span> <span data-ttu-id="281be-169">Вы менее контролируете поля, в которых выполняется поиск, и как выполняется поиск, когда вы используете поиск строки запроса.</span><span class="sxs-lookup"><span data-stu-id="281be-169">You have less control over the fields that are searched and how the search is performed when you use a query string search.</span></span> <span data-ttu-id="281be-170">Это неплохо!</span><span class="sxs-lookup"><span data-stu-id="281be-170">Not that that's a bad thing!</span></span> <span data-ttu-id="281be-171">В некоторых случаях может потребоваться привести более широкое представление сети, поэтому говорите.</span><span class="sxs-lookup"><span data-stu-id="281be-171">In some cases, you might want to cast a wider net, so to speak.</span></span>

<span data-ttu-id="281be-172">Например, можно выполнить поиск по запросу "заметки о собраниях", используя метод управляемого API [ExchangeService. FindItems](https://msdn.microsoft.com/library/jj223808%28v=exchg.80%29.aspx) EWS.</span><span class="sxs-lookup"><span data-stu-id="281be-172">For example, you can search for "meeting notes" by using the [ExchangeService.FindItems](https://msdn.microsoft.com/library/jj223808%28v=exchg.80%29.aspx) EWS Managed API method.</span></span>

```cs
FindItemsResults<Item> results = service.FindItems(folder, "meeting notes", view);
```

<span data-ttu-id="281be-173">Если сравнить результаты этого поиска с результатами предыдущего примера поиска **SearchFilter. контаинссубстринг** , этот поиск будет содержать больше результатов.</span><span class="sxs-lookup"><span data-stu-id="281be-173">If you compare the results of this search to the results of the **SearchFilter.ContainsSubstring** search example earlier, this search will contain more results.</span></span> <span data-ttu-id="281be-174">Поиск фильтра поиска будет возвращать только те элементы, которые содержат слово "заметки о собраниях" в теме, тогда как поиск будет возвращать элементы с "заметками о собраниях" в полях тема, текст и другие.</span><span class="sxs-lookup"><span data-stu-id="281be-174">The search filter search will return only items that have "meeting notes" in the subject, while this search will return items that have "meeting notes" in the subject, body, and other fields.</span></span>

<span data-ttu-id="281be-175">Давайте рассмотрим, как можно уточнить строку запроса, чтобы ближе понять результаты, которые вы видите в фильтре поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-175">Let's take a look at how you can refine the query string to get closer to the results you see from the search filter.</span></span> <span data-ttu-id="281be-176">С помощью AQS можно ограничить поиск темой.</span><span class="sxs-lookup"><span data-stu-id="281be-176">Using AQS, you can limit your search to the subject.</span></span>

```cs
FindItemsResults<Item> results = service.FindItems(folder, "subject:meeting notes", view);
```

<span data-ttu-id="281be-177">Это ближе, но результаты по-прежнему не совсем одинаковы.</span><span class="sxs-lookup"><span data-stu-id="281be-177">This is closer, but the results are still not quite the same.</span></span> <span data-ttu-id="281be-178">Если вы используете строку запроса с несколькими словами, вы получите совпадения даже в том случае, если слова не указаны в указанном порядке или даже если они не являются смежными друг с другом.</span><span class="sxs-lookup"><span data-stu-id="281be-178">When you use a query string with multiple words, you will get matches even if the words are not in the order you specify, or even if they're not adjacent to each other.</span></span> <span data-ttu-id="281be-179">С помощью строки запроса "Subject: заметки к собранию" вы получите совпадения для "заметок о собраниях", "заметки на собрании" и т. д.</span><span class="sxs-lookup"><span data-stu-id="281be-179">With the query string "subject:meeting notes", you will get matches for "meeting notes", "notes from the meeting", and so on.</span></span> <span data-ttu-id="281be-180">Для дальнейшего уточнения можно заключить условия поиска в двойные кавычки, чтобы указать, что вы хотите использовать только эту фразу.</span><span class="sxs-lookup"><span data-stu-id="281be-180">To further refine, you can wrap the search terms in double quotes to indicate that you want that phrase only.</span></span>

```cs
FindItemsResults<Item> results = service.FindItems(folder, "subject:\"meeting notes\"", view);
```

## <a name="requesting-specific-properties-in-search-results"></a><span data-ttu-id="281be-181">Запрос определенных свойств в результатах поиска</span><span class="sxs-lookup"><span data-stu-id="281be-181">Requesting specific properties in search results</span></span>
<span data-ttu-id="281be-182"><a name="bk_RequestSpecific"> </a></span><span class="sxs-lookup"><span data-stu-id="281be-182"><a name="bk_RequestSpecific"> </a></span></span>

<span data-ttu-id="281be-183">По умолчанию результаты поиска будут содержать все свойства элементов, которые отвечают за поиск.</span><span class="sxs-lookup"><span data-stu-id="281be-183">By default, search results will contain all properties on the items that match the search.</span></span> <span data-ttu-id="281be-184">В некоторых случаях это может потребоваться, но в большинстве случаев для приложения требуется только дискретный набор свойств.</span><span class="sxs-lookup"><span data-stu-id="281be-184">In some cases this might be what you want, but in most cases your application only requires a discrete set of properties.</span></span> <span data-ttu-id="281be-185">В этом случае следует ограничить набор свойств, возвращаемых только свойствами, которые требуются приложению.</span><span class="sxs-lookup"><span data-stu-id="281be-185">In this case, you should limit the set of properties that are returned to only the properties your application needs.</span></span> <span data-ttu-id="281be-186">В следующем примере класс [итемвиев](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.itemview%28v=exchg.80%29.aspx) используется, чтобы ограничить возвращаемые свойства темой, датой и временем получения, а также идентификатором элементов.</span><span class="sxs-lookup"><span data-stu-id="281be-186">In the following example, the [ItemView](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.itemview%28v=exchg.80%29.aspx) class is used to limit the returned properties to the subject, date/time received, and ID of the items.</span></span>

```cs
ItemView view = new ItemView(10);
// Creating a new PropertySet with this constructor includes
// ItemSchema.Id.
view.PropertySet = new PropertySet(ItemSchema.Subject, ItemSchema.DateTimeReceived);
```

## <a name="controlling-search-depth"></a><span data-ttu-id="281be-187">Управление глубиной поиска</span><span class="sxs-lookup"><span data-stu-id="281be-187">Controlling search depth</span></span>
<span data-ttu-id="281be-188"><a name="bk_SearchDepth"> </a></span><span class="sxs-lookup"><span data-stu-id="281be-188"><a name="bk_SearchDepth"> </a></span></span>

<span data-ttu-id="281be-189">Настройка обзора для представления позволяет управлять глубиной и областью поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-189">Setting the traversal on the view controls the depth and scope of the search.</span></span>

<span data-ttu-id="281be-190">**Таблица 2. Значения обхода поиска**</span><span class="sxs-lookup"><span data-stu-id="281be-190">**Table 2. Search traversal values**</span></span>

|<span data-ttu-id="281be-191">**Значение обхода**</span><span class="sxs-lookup"><span data-stu-id="281be-191">**Traversal value**</span></span>|<span data-ttu-id="281be-192">**Относится к**</span><span class="sxs-lookup"><span data-stu-id="281be-192">**Applies to**</span></span>|<span data-ttu-id="281be-193">**Описание**</span><span class="sxs-lookup"><span data-stu-id="281be-193">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="281be-194">Поверхност</span><span class="sxs-lookup"><span data-stu-id="281be-194">Shallow</span></span>  <br/> |<span data-ttu-id="281be-195">Элементы и папки</span><span class="sxs-lookup"><span data-stu-id="281be-195">Items and Folders</span></span>  <br/> |<span data-ttu-id="281be-196">Неполные операции поиска ограничиваются прямыми потомками папки, в которой выполняется поиск.</span><span class="sxs-lookup"><span data-stu-id="281be-196">Shallow searches are limited to direct children of the folder being searched.</span></span>  <br/> |
|<span data-ttu-id="281be-197">Углублен</span><span class="sxs-lookup"><span data-stu-id="281be-197">Deep</span></span>  <br/> |<span data-ttu-id="281be-198">Элементы (только с папками поиска) и папками</span><span class="sxs-lookup"><span data-stu-id="281be-198">Items (only with search folders) and Folders</span></span>  <br/> |<span data-ttu-id="281be-199">При глубоком поиске выполняется рекурсивный поиск в папке, в которой выполняется поиск, и вложенные папки.</span><span class="sxs-lookup"><span data-stu-id="281be-199">Deep searches recursively search the folder being searched and subfolders.</span></span>  <br/> |
|<span data-ttu-id="281be-200">Соответствующую</span><span class="sxs-lookup"><span data-stu-id="281be-200">Associated</span></span>  <br/> |<span data-ttu-id="281be-201">Элементы</span><span class="sxs-lookup"><span data-stu-id="281be-201">Items</span></span>  <br/> |<span data-ttu-id="281be-202">Связанные операции поиска включают только связанные элементы из папки, в которой выполняется поиск.</span><span class="sxs-lookup"><span data-stu-id="281be-202">Associated searches only include associated items from the folder being searched.</span></span> <span data-ttu-id="281be-203">Связанные элементы — это скрытые элементы в папке.</span><span class="sxs-lookup"><span data-stu-id="281be-203">Associated items are hidden items within the folder.</span></span>  <br/> |
|<span data-ttu-id="281be-204">SoftDeleted</span><span class="sxs-lookup"><span data-stu-id="281be-204">SoftDeleted</span></span>  <br/> |<span data-ttu-id="281be-205">Элементы и папки</span><span class="sxs-lookup"><span data-stu-id="281be-205">Items and Folders</span></span>  <br/> |<span data-ttu-id="281be-206">Этот тип обхода устарел.</span><span class="sxs-lookup"><span data-stu-id="281be-206">This traversal type is deprecated.</span></span> <span data-ttu-id="281be-207">Поиск в SoftDeleted включает только элементы, которые находятся в корзине.</span><span class="sxs-lookup"><span data-stu-id="281be-207">SoftDeleted searches only include items that are in the dumpster.</span></span> <span data-ttu-id="281be-208">Корзина заменена [папкой "элементы с возможностью восстановления](https://docs.microsoft.com/exchange/policy-and-compliance/recoverable-items-folder/recoverable-items-folder) " в Exchange Online, Exchange Online в составе Office 365 и версиями Exchange, начиная с Exchange 2010.</span><span class="sxs-lookup"><span data-stu-id="281be-208">The dumpster has been replaced by the [Recoverable Items Folder](https://docs.microsoft.com/exchange/policy-and-compliance/recoverable-items-folder/recoverable-items-folder) in Exchange Online, Exchange Online as part of Office 365, and versions of Exchange starting with Exchange 2010.</span></span>  <br/> |

## <a name="managing-search-results"></a><span data-ttu-id="281be-209">Управление результатами поиска</span><span class="sxs-lookup"><span data-stu-id="281be-209">Managing search results</span></span>
<span data-ttu-id="281be-210"><a name="bk_ManageSearchResults"> </a></span><span class="sxs-lookup"><span data-stu-id="281be-210"><a name="bk_ManageSearchResults"> </a></span></span>

<span data-ttu-id="281be-211">Управляемый API EWS и EWS также позволяют изменять способ возврата результатов поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-211">The EWS Managed API and EWS also allow you to change how your search results are returned.</span></span> <span data-ttu-id="281be-212">С помощью представлений можно указать, какие свойства включены в результаты, сортировать результаты и получать результаты, чтобы получить только заданное число результатов для каждого ответа.</span><span class="sxs-lookup"><span data-stu-id="281be-212">You can use views to specify which properties are included in the results, sort results, and page your results to only get back a set number of results per response.</span></span> <span data-ttu-id="281be-213">Вы также можете группировать результаты по определенным значениям полей и контролировать глубину поиска, указав тип обхода.</span><span class="sxs-lookup"><span data-stu-id="281be-213">You can also group results by specific field values and control the depth of a search by specifying a traversal type.</span></span> <span data-ttu-id="281be-214">Наконец, вы можете использовать папки поиска для создания постоянных поисков, которые обновляются динамически по мере поступления новых элементов.</span><span class="sxs-lookup"><span data-stu-id="281be-214">Finally, you can use search folders to create persistent searches that are updated dynamically as new items arrive.</span></span>

### <a name="sorting"></a><span data-ttu-id="281be-215">сортировке;</span><span class="sxs-lookup"><span data-stu-id="281be-215">Sorting</span></span>

<span data-ttu-id="281be-216">Сервер может вернуть отсортированные результаты, что может упростить отображение и обработку элементов по порядку.</span><span class="sxs-lookup"><span data-stu-id="281be-216">You can get the server to return sorted results, which can make it easier to display or process items in order.</span></span> <span data-ttu-id="281be-217">В этом примере результаты сортируются по дате и времени получения, последние элементы — первыми.</span><span class="sxs-lookup"><span data-stu-id="281be-217">In this example, the results will be sorted by the date/time received, with the newest items being first.</span></span>

```cs
view.OrderBy.Add(ItemSchema.DateTimeReceived, SortDirection.Descending);
```

### <a name="paging"></a><span data-ttu-id="281be-218">Разбиение на страницы</span><span class="sxs-lookup"><span data-stu-id="281be-218">Paging</span></span>

<span data-ttu-id="281be-219">При отправке запроса на поиск с помощью управляемого API EWS или EWS вы указываете размер представления, который контролирует максимальное количество возвращаемых элементов.</span><span class="sxs-lookup"><span data-stu-id="281be-219">When you send a search request by using the EWS Managed API or EWS, you specify a view size, which controls the maximum number of items returned.</span></span> <span data-ttu-id="281be-220">Однако количество элементов на сервере, которые совпадают с поиском, может быть больше размера представления.</span><span class="sxs-lookup"><span data-stu-id="281be-220">However, the number of items on the server that match your search might be larger than the view size.</span></span> <span data-ttu-id="281be-221">В этом случае сервер указывает, что доступны дополнительные элементы.</span><span class="sxs-lookup"><span data-stu-id="281be-221">In this case, the server indicates that more items are available.</span></span> <span data-ttu-id="281be-222">Можно [использовать разбиение по страницам для повторения поиска](how-to-perform-paged-searches-by-using-ews-in-exchange.md) и получения следующего набора результатов.</span><span class="sxs-lookup"><span data-stu-id="281be-222">You can [use paging to repeat your search](how-to-perform-paged-searches-by-using-ews-in-exchange.md) and get the next set of results.</span></span>

<span data-ttu-id="281be-223">Например, вы можете отправить запрос поиска с размером 10.</span><span class="sxs-lookup"><span data-stu-id="281be-223">For example, you can send a search request with a view size of 10.</span></span> <span data-ttu-id="281be-224">На сервере может быть 15 элементов, которые отвечают за поиск, но вы получите только первые 10, а также индикатор ( [финдитемсресултс \<TItem\> . Свойство Мореаваилабле](https://msdn.microsoft.com/library/dd635477%28v=exchg.80%29.aspx) , если вы используете управляемый API EWS, на сервере больше результатов.</span><span class="sxs-lookup"><span data-stu-id="281be-224">There might be 15 items on the server that match your search, but you will only get back the first 10, along with an indicator (the [FindItemsResults\<TItem\>.MoreAvailable](https://msdn.microsoft.com/library/dd635477%28v=exchg.80%29.aspx) property if you're using the EWS Managed API) that there are more results on the server.</span></span> <span data-ttu-id="281be-225">Затем вы можете отправить такой же поиск со смещением, равным 10, чтобы запросить следующие 10 элементов, которые отвечают за поисковый запрос.</span><span class="sxs-lookup"><span data-stu-id="281be-225">You can then send the same search with an offset of 10 to ask for the next 10 items that match your search.</span></span> <span data-ttu-id="281be-226">Сервер возвратит оставшиеся пять элементов.</span><span class="sxs-lookup"><span data-stu-id="281be-226">The server will return the remaining five items.</span></span>

<span data-ttu-id="281be-227">**Рис. 1. Пример страничного поиска**</span><span class="sxs-lookup"><span data-stu-id="281be-227">**Figure 1. Paged search example**</span></span>

![Иллюстрация, демонстрирующая страничный поиск.](media/Ex15_Search_PagedSearch.png)

### <a name="grouping"></a><span data-ttu-id="281be-231">Группирование</span><span class="sxs-lookup"><span data-stu-id="281be-231">Grouping</span></span>

 <span data-ttu-id="281be-232">Exchange позволяет группировать результаты поиска по определенному полю.</span><span class="sxs-lookup"><span data-stu-id="281be-232">Exchange enables you to group search results by a specific field.</span></span> <span data-ttu-id="281be-233">Это помогает разбивать результаты поиска на более управляемые наборы.</span><span class="sxs-lookup"><span data-stu-id="281be-233">This can help break up search results into more manageable sets.</span></span> <span data-ttu-id="281be-234">Например, можно выполнить поиск по запросу "заметки собрания" и сгруппировать результаты по отправителю.</span><span class="sxs-lookup"><span data-stu-id="281be-234">For example, you can search for "meeting notes" and group the results by sender.</span></span> <span data-ttu-id="281be-235">Как показано на следующем рисунке, возвращенные элементы будут разделяться на группы со всеми элементами, которые соответствуют условиям того же отправителя в одной группе, всем соответствующим элементам от другого отправителя в другой группе и т. д.</span><span class="sxs-lookup"><span data-stu-id="281be-235">As shown in the following figure, the items returned will be separated into groups, with all the items that match the criteria from the same sender in one group, all the matching items from another sender in another group, and so on.</span></span>

<span data-ttu-id="281be-236">**Рис. 2. Результаты поиска, сгруппированные по отправителю**</span><span class="sxs-lookup"><span data-stu-id="281be-236">**Figure 2. Search results grouped by sender**</span></span>

![Изображение результатов поиска, сгруппированных по отправителям.](media/Ex15_Search_GroupedResults.png)

## <a name="search-folders"></a><span data-ttu-id="281be-238">Папки поиска</span><span class="sxs-lookup"><span data-stu-id="281be-238">Search folders</span></span>
<span data-ttu-id="281be-239"><a name="bk_SearchFolders"> </a></span><span class="sxs-lookup"><span data-stu-id="281be-239"><a name="bk_SearchFolders"> </a></span></span>

<span data-ttu-id="281be-240">При обычном поиске выполняется поиск, результаты возвращаются в приложение для обработки, а поиск прекращается.</span><span class="sxs-lookup"><span data-stu-id="281be-240">With a regular search, the search is executed, the results are returned to your application for processing, and the search ceases to exist.</span></span> <span data-ttu-id="281be-241">Папки поиска позволяют выполнять поиск в сохраняемом виде.</span><span class="sxs-lookup"><span data-stu-id="281be-241">Search folders provide a way to make a search persistent.</span></span> <span data-ttu-id="281be-242">Это отличный вариант для поиска, который вы будете использовать несколько раз.</span><span class="sxs-lookup"><span data-stu-id="281be-242">This is a great option for searches that you know you will want to execute multiple times.</span></span> <span data-ttu-id="281be-243">Вместо того чтобы многократно выполнять один и тот же поиск, в результате чего сервер будет оценивать Поиск с нуля каждый раз, папка поиска делает поиск всегда включенным, позволяя серверу обновлять существующий результирующий набор при добавлении или удалении элементов в области поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-243">Rather than executing the same search repeatedly, causing the server to evaluate the search from scratch each time, a search folder makes a search always on, allowing the server to update the existing result set as items are added to or removed from the search scope.</span></span> <span data-ttu-id="281be-244">Папки поиска действуют как обычные папки, в которых они отображаются как папки с элементами в них.</span><span class="sxs-lookup"><span data-stu-id="281be-244">Search folders act like regular folders, in that they appear as folders that have items in them.</span></span> <span data-ttu-id="281be-245">Различие состоит в том, что в папке находятся только те элементы, которые соответствуют критериям поиска, связанным с папкой.</span><span class="sxs-lookup"><span data-stu-id="281be-245">The difference is that the only items contained in the folder are those that match the search criteria that are associated with the folder.</span></span> <span data-ttu-id="281be-246">После создания папки поиска приложение может получить актуальные результаты поиска, только проверив содержимое папки.</span><span class="sxs-lookup"><span data-stu-id="281be-246">After a search folder is created, your application can get up-to-date results of the search just by checking the contents of the folder.</span></span>

<span data-ttu-id="281be-247">Создание папки поиска является простой при создании фильтров поиска.</span><span class="sxs-lookup"><span data-stu-id="281be-247">Creating a search folder is simple when you've mastered creating search filters.</span></span> <span data-ttu-id="281be-248">В следующем примере создается папка поиска для отображения всех сообщений электронной почты с темой, содержащей "заметки о собраниях".</span><span class="sxs-lookup"><span data-stu-id="281be-248">In the following example, a search folder is created to show all email with a subject that contains "meeting notes".</span></span>

```cs
static void CreateSearchFolder(ExchangeService service)
{
    SearchFilter.ContainsSubstring subjectFilter = new SearchFilter.ContainsSubstring(ItemSchema.Subject,
        "meeting notes", ContainmentMode.Substring, ComparisonMode.IgnoreCase);
    SearchFolder searchFolder = new SearchFolder(service);
    searchFolder.DisplayName = "Meeting Notes";
    searchFolder.SearchParameters.RootFolderIds.Add(WellKnownFolderName.Inbox);
    searchFolder.SearchParameters.Traversal = SearchFolderTraversal.Deep;
    searchFolder.SearchParameters.SearchFilter = subjectFilter;
    searchFolder.Save(WellKnownFolderName.SearchFolders);
}
```

## <a name="in-this-section"></a><span data-ttu-id="281be-249">В этой статье</span><span class="sxs-lookup"><span data-stu-id="281be-249">In this section</span></span>
<span data-ttu-id="281be-250"><a name="bk_InThisSection"> </a></span><span class="sxs-lookup"><span data-stu-id="281be-250"><a name="bk_InThisSection"> </a></span></span>

- [<span data-ttu-id="281be-251">Использование фильтров поиска с EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="281be-251">Use search filters with EWS in Exchange</span></span>](how-to-use-search-filters-with-ews-in-exchange.md)

- [<span data-ttu-id="281be-252">Выполнение поиска AQS с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="281be-252">Perform an AQS search by using EWS in Exchange</span></span>](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md)

- [<span data-ttu-id="281be-253">Выполнение постраничного поиска с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="281be-253">Perform paged searches by using EWS in Exchange</span></span>](how-to-perform-paged-searches-by-using-ews-in-exchange.md)

- [<span data-ttu-id="281be-254">Выполнение группового поиска с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="281be-254">Perform grouped searches by using EWS in Exchange</span></span>](how-to-perform-grouped-searches-by-using-ews-in-exchange.md)

- [<span data-ttu-id="281be-255">Работайте с папками поиска с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="281be-255">Work with search folders by using EWS in Exchange</span></span>](how-to-work-with-search-folders-by-using-ews-in-exchange.md)

## <a name="see-also"></a><span data-ttu-id="281be-256">См. также</span><span class="sxs-lookup"><span data-stu-id="281be-256">See also</span></span>


- [<span data-ttu-id="281be-257">Разработка клиентов веб-служб для Exchange</span><span class="sxs-lookup"><span data-stu-id="281be-257">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)

- [<span data-ttu-id="281be-258">Папка "элементы с возможностью восстановления"</span><span class="sxs-lookup"><span data-stu-id="281be-258">Recoverable Items Folder</span></span>](https://docs.microsoft.com/exchange/policy-and-compliance/recoverable-items-folder/recoverable-items-folder)

- [<span data-ttu-id="281be-259">ExchangeService.FindItems</span><span class="sxs-lookup"><span data-stu-id="281be-259">ExchangeService.FindItems</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)

- [<span data-ttu-id="281be-260">Параметры политики регулирования, которые влияют на поисковые операции EWS</span><span class="sxs-lookup"><span data-stu-id="281be-260">Throttling policy parameters that affect EWS search operations</span></span>](ews-throttling-in-exchange.md#throttling-policy-parameters-that-affect-ews-search-operations)
