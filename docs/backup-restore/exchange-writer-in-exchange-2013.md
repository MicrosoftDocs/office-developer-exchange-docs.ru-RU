---
title: Exchange writer in Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: ec126433-9f0a-46ec-a685-ff4af2f97bc1
description: Сведения о записи Exchange в Exchange 2013 для операций резервного копирования и восстановления.
ms.openlocfilehash: 44270a87c38b08d274d389fa6e46f3864da13ed2
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2020
ms.locfileid: "44452890"
---
# <a name="exchange-writer-in-exchange-2013"></a>Exchange writer in Exchange 2013

Сведения о записи Exchange в Exchange 2013 для операций резервного копирования и восстановления. 
  
**Применимо к:** Exchange Server 2013 
  
Писатель Exchange отвечает за резервное копирование и восстановление активных баз данных Exchange Server 2013. Писатель Exchange также поддерживает функции резервного копирования для выбранной базы данных, в которой теневая копия передается реплицируемым экземплярам базы данных и файлам журнала транзакций. 
  
## <a name="overview-of-the-exchange-writer"></a>Обзор записи Exchange
<a name="bk_Overview"> </a>

Exchange 2013 включает функции мобильности баз данных, которые позволяют реплицировать базы данных между различными серверами Exchange для повышения доступности баз данных и устойчивости сайтов. Другие копии баз данных в группе обеспечения доступности баз данных предоставляют ценные возможности для резервного копирования Exchange, чтобы использовать дополнительные ресурсы, доступные в расположении копии. Кроме того, поскольку резервная копия копируется вместо активного хозяина базы данных, она может быть недоступна во время резервного копирования в течение более длительного периода времени. 
  
Писатель Exchange координирует работу со службами Exchange (работающими от имени запросителя) для подготовки файлов базы данных к резервному копированию, зависания активности операций IO в результате транзакций Exchange перед резервной копией базы данных, а затем разморозить и усечение файлов журнала после завершения резервного копирования.
  
Во время восстановления приложение резервного копирования и восстановления предписывает записи Exchange скоординироваться с хранилищем Exchange (работающим от имени запрашивающая) для проверки целей восстановления, переименовать файл базы данных при необходимости, а затем при необходимости повторить журналы транзакций. Писатель Exchange поддерживает как резервное копирование, так и восстановление.
  
Записи Exchange доступны на любом сервере Exchange с установленной ролью сервера почтовых ящиков. 
  
## <a name="exchange-writer-configuration-settings"></a>Параметры конфигурации записи Exchange
<a name="bk_ExchangeWriterConfig"> </a>

В записи Exchange для VSS используются различные параметры и значения, которые необходимо правильно установить и сохранить во время операций резервного копирования и восстановления. Эти параметры конфигурации хранятся в документе метаданных записи Exchange. Если приложение резервного копирования не сохраняет эти параметры, при попытке резервного копирования баз данных Exchange могут возникнуть непредвиденные ошибки. 
  
В следующей таблице перечислены интерфейсы VSS, которые выдают метаданные о компонентах резервного копирования базы данных. Эти интерфейсы необходимы для получения документа метаданных записи Exchange, который используется для резервного копирования хранилище Exchange.
  
**Таблица 1. Интерфейсы VSS**

|**Интерфейс VSS**|**Описание**|
|:-----|:-----|
|IVssWMComponent  <br/> |Разрешает доступ к сведениям о компонентах, хранимым в записи Exchange.  <br/> |
|IVssExwriterWriterMetadata  <br/> |Позволяет запрашивая приложению резервного копирования и восстановления проверять метаданные записи Exchange. Документ метаданных записи Exchange содержит специальные значения и параметры Exchange 2013, необходимые приложению для резервного копирования и восстановления, чтобы правильно указать соответствующие компоненты для резервного копирования.  <br/> |
|IVssComponent  <br/> |Содержит методы для проверки и изменения сведений о компонентах, содержащихся в документе компонентов резервного копирования запрашивающих. Объекты можно получить только для тех компонентов, которые были явно добавлены в этот документ методом [IVssBackupComponents::AddComponent.](https://msdn.microsoft.com/library/windows/desktop/aa382646%28v=vs.85%29.aspx)  <br/> |
|IVssBackupComponents  <br/> |Используется приложением резервного копирования и восстановления для опроса записи Exchange о состоянии файла и для запуска операций резервного копирования и восстановления. Метод [IVssBackupComponents::SetBackupState ](https://msdn.microsoft.com/library/windows/desktop/aa382833%28v=vs.85%29.aspx) определяет, является ли операция резервного копирования полной, копированием, добавочной или разнонаправленной резервной копией. Метод [IVssBackupComponents::AddRestoreSubcomponent](https://msdn.microsoft.com/library/windows/desktop/aa382649%28v=vs.85%29.aspx) определяет подкомпоненты базы данных Exchange 2013, которые можно выбрать для операции восстановления.  <br/> |
   
В файловой системе Windows Server база данных Exchange 2013 хранится в одном файле базы данных с расширением *EDB. Записи Exchange предоставляет *EDB** в качестве компонента базы данных, а журналы транзакций ( LOG) и файлы контрольных точек ( CHK) объединяются в один компонент, который называется компонент журнала. Дополнительные сведения о файлах баз данных Exchange см. в понятиях резервного копирования и [восстановления для Exchange 2013.](backup-and-restore-concepts-for-exchange-2013.md)
  
## <a name="interactions-between-the-exchange-writer-vss-and-vss-requesters"></a>Взаимодействие между автором Exchange, VSS и запросителями VSS
<a name="bk_interactions"> </a>

Высокоуровневые взаимодействия между VSS, записи Exchange и Exchange 2013 во время операций резервного копирования:
  
1. Программа (или агент) архивации запускает запланированное задание. 
    
2. Запрашиватель VSS в приложении резервного копирования и восстановления отправляет в VSS команду на получение теневой копии выбранных баз данных Exchange 2013. 
    
3. VSS взаимодействует с записи Exchange для подготовки к резервному копированию моментальных снимков. Exchange 2013 запрещает административные действия с базами данных, проверяет зависимости тома и приостанавливать все операции записи для выбранного экземпляра базы данных и файлов журнала транзакций, разрешая доступ только для чтения. 
    
4. VSS взаимодействует с соответствующим поставщиком хранилища, чтобы создать теневую копию тома хранилища, который содержит базы данных Exchange 2013. 
    
5. VSS выпускает Exchange 2013 для возобновления обычных операций. 
    
6. Запрашивающий VSS проверяет физическую согласованность резервного набора, прежде чем сигнализировать об успешном резервном копировании. Exchange 2013 урезает журналы транзакций (если база данных является частью DAG, усечение журнала реплицируется среди всех копий) и записи времени последней резервной копии базы данных.
    
VSS сериализует взаимодействие запрашивающих с записи Exchange, начиная с метода [OnPrepareBackup](https://msdn.microsoft.com/library/windows/desktop/aa381571%28v=vs.85%29.aspx) и заканчивая методом [OnPostSnapshot.](https://msdn.microsoft.com/library/windows/desktop/aa381568%28v=vs.85%29.aspx) Как правило, большинство времени, которое записи Exchange тратит на работу с теневой копией, происходит после метода **OnPostSnapshot,** когда согласованность теневой копии проверяется до завершения резервного копирования. Записи Exchange поддерживает параллельные резервные копии **между OnPostSnapshot** и [OnBackupComplete](https://msdn.microsoft.com/library/windows/desktop/aa381557%28v=vs.85%29.aspx).
  
В Exchange 2013 не разрешается одновременное резервное копирование одной базы данных. Одновременно с заданной базой данных может работать только одно задание резервного копирования. При запуске резервного копирования хранилище Exchange помещает базу данных в состояние выполнения резервного копирования. Это состояние в памяти очищается по завершении процесса резервного копирования или при перезапуске службы. Состояние выполнения резервного копирования в памяти и связанные с ним данные теряются при перезапуске службы, в котором размещен записи Exchange, перезапуске операционной системы или отопуске кластера. Любое из этих событий приведет к сбойу задания резервного копирования.
  
Инициация файла журнала транзакций, инициированная резервным копированием, запускается в зависимости от типа выполняемого резервного копирования. В конфигурациях, не относяхся к DAG, записи Exchange будут усечены файлы журнала транзакций по завершении успешного полного или добавочная резервного копирования. В реплицируемых конфигурациях DAG служба репликации отложена до тех пор, пока все необходимые файлы журнала не будут воспроизведены во все остальные копии. Служба репликации удалит архивированные файлы журналов как из активных, так и из путей к файлам журнала копирования, после того как она проверяет, успешно ли файлы журнала применены к базе данных копирования, а активная база данных и контрольная точка копий базы данных передали файлы журналов для удаления.
  
## <a name="see-also"></a>См. также

- [Журналы транзакций и файлы контрольных точек для резервного копирования и восстановления в Exchange 2013](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md)
    
- [Концепции резервного копирования и восстановления для Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md)
    

