---
title: Проверка целостности резервной копии с помощью средства Eseutil в Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: b0d325ba-4482-4ca2-9a69-c890f985b206
description: Узнайте, как использовать средство командной строки Eseutil для проверки резервной копии хранилища Exchange.
ms.openlocfilehash: 03c4c23d433418911240bbe7c337308a989f3739
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "19760915"
---
#  <a name="validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013"></a>Проверка целостности резервной копии с помощью средства Eseutil в Exchange 2013

Узнайте, как использовать средство командной строки Eseutil для проверки резервной копии хранилища Exchange. 
  
**Применимо к:** Exchange Server 2013 
  
Так как служба теневого копирования томов (VSS) может создавать резервные копии, в то время как Exchange продолжает запись в базу данных, сервер не затрагивает все страницы и выполняет необходимые проверки согласованности. По этой причине любое приложение для резервного копирования и восстановления, использующее VSS, должно проверять согласованность моментальных снимков. Exchange Server 2013 поддерживает следующие два метода проверки целостности моментального снимка: 
  
- API ЧКСГФИЛЕС
    
- Средство командной строки Eseutil
    
Рекомендуется использовать API ЧКСГФИЛЕС, так как приложение для резервного копирования упрощает обнаружение, диагностику и составление отчетов об ошибках, обнаруженных во время проверки согласованности ЧКСГФИЛЕС. Сведения о том, как использовать API ЧКСГФИЛЕС, можно узнать в статье [Проверка целостности резервных копий с помощью API чксгфилес в Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md).
  
## <a name="running-the-eseutil-tool"></a>Запуск средства Eseutil

Чтобы проверить целостность моментального снимка, выполните команду Eseutil для файлов базы данных и журнала, указанных в следующей таблице. 
  
**Таблица 1. Команды Eseutil. exe для каждого типа резервного копирования**

|**Тип файла или тип резервного копирования**|**Полное резервное копирование**|**Копирование резервной копии**|**Добавочная архивация**|**Разностное резервное копирование**|
|:-----|:-----|:-----|:-----|:-----|
|EDB  <br/> |"eseutil/k/i"  <br/> |"eseutil/k/i"  <br/> |Неприменимо  <br/> |Неприменимо  <br/> |
|. log  <br/> |"eseutil/k" (1)  <br/> |"eseutil/k" (1)  <br/> |"eseutil/k" (2)  <br/> |"eseutil/k" (2)  <br/> |
   
> [!NOTE]
> Нет необходимости выполнять команду Eseutil для файлов STM и chk. 
  
Для восстановления базы данных моментальных снимков необходимы все файлы журналов с номером создания файла журнала, который равен или больше номера версии файла журнала контрольной точки. Если он существует, то текущий файл журнала (Енн. log) также необходим для восстановления базы данных. Если какой-либо из необходимых файлов журналов не проходит проверку согласованности, то запрашивающий должен убедиться, что состояние компонента резервного копирования имеет значение FALSE, прежде чем вызвать метод [баккупкомплете](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382651%28v=vs.85%29.aspx) . Чтобы определить файл журнала контрольной точки, выполните команду Eseutil. exe для файла контрольной точки моментального снимка и выполните синтаксический анализ результатов для "Checkpoint:". В приведенном ниже примере показано, как выполнить Eseutil. exe для файла контрольной точки. 
  
```cpp
c:\eseutil.exe /mk E01.chk
Checkpoint: (0x20, 9D, 187)
```

Вторая строка в примере — это возвращаемое значение, где 0x20 — это номер версии журнала контрольной точки в шестнадцатеричном формате. В этом примере все файлы журналов, включая E01000020. log и больше, не должны быть повреждены для восстановления базы данных моментальных снимков, даже если сама база данных уже прошла физическую проверку согласованности.
  
Для восстановления базы данных необходимы все файлы журналов в добавочном или разностном наборе резервных копий. Чтобы проверить согласованность последовательности журналов, выполните с помощью команды Eseutil. exe префикс файла журнала. В приведенном ниже примере показано, как выполнять проверки согласованности для всех файлов формы E01xxxxx. log по указанному пути.
  
```cpp
c:\eseutil /k E01
```

## <a name="checking-the-eseutilexe-output"></a>Проверка выходных данных Eseutil. exe

Запрашивающий должен проверить, что все возвращенные значения ошибки ERRORLEVEL ERRORLEVEL неотрицательны. Сведения о значениях ERRORLEVEL приведены [в статье Reference for Common Error Eseutil](http://technet.microsoft.com/en-us/library/aa996759%28v=exchg.80%29.aspx). Чтобы просмотреть значение ERRORLEVEL в командной строке, введите "Echo% ERRORLEVEL%" после завершения работы средства Eseutil. exe. Отрицательный признак указывает на то, что один или несколько файлов повреждены.
  
Прежде чем инициатор запроса вызовет метод **баккупкомплете** , необходимо убедиться, что состояние компонента резервного копирования отражает результат проверки согласованности. В случае обнаружения повреждений состояние будет равно FALSE; Если повреждения не обнаружены, отображается состояние TRUE. 
  
## <a name="see-also"></a>См. также

- [Проверка целостности резервной копии с помощью API ЧКСГФИЛЕС в Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
- [Создание приложений резервного копирования и восстановления для Exchange 2013](build-backup-and-restore-applications-for-exchange-2013.md)
- [Справочник по классу функция cchksgfiles](cchksgfiles-class-reference.md)
- [Основные понятия резервного копирования и восстановления для Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md)
    

