---
title: Олицетворение и EWS в Exchange
manager: sethgros
ms.date: 08/24/2020
ms.audience: Developer
ms.assetid: 7e1ea63c-eb29-43d2-827f-2f2b1846483b
description: Узнайте, как и когда использовать олицетворение в приложениях-службах Exchange.
localization_priority: Priority
ms.openlocfilehash: da35fb04f316c21a1c85c71b789b7f1485653466
ms.sourcegitcommit: 636c05a929279812c6ef87d75b01c166a4a05584
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2020
ms.locfileid: "47254974"
---
# <a name="impersonation-and-ews-in-exchange"></a><span data-ttu-id="29473-103">Олицетворение и EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="29473-103">Impersonation and EWS in Exchange</span></span>

<span data-ttu-id="29473-104">Узнайте, как и когда использовать олицетворение в [приложениях-службах](ews-application-types.md) Exchange.</span><span class="sxs-lookup"><span data-stu-id="29473-104">Learn how and when to use impersonation in your Exchange [service applications](ews-application-types.md).</span></span>
  
<span data-ttu-id="29473-105">Вы можете предоставить пользователям доступ к почтовым ящикам других пользователей одним из трех способов:</span><span class="sxs-lookup"><span data-stu-id="29473-105">You can enable users to access other users' mailboxes in one of three ways:</span></span>
  
- <span data-ttu-id="29473-106">добавив представителей и указав разрешения для каждого из них;</span><span class="sxs-lookup"><span data-stu-id="29473-106">By adding delegates and specifying permissions for each delegate.</span></span>
    
- <span data-ttu-id="29473-107">вручную изменив разрешения для папки;</span><span class="sxs-lookup"><span data-stu-id="29473-107">By modifying folder permissions directly.</span></span>
    
- <span data-ttu-id="29473-108">с помощью олицетворения.</span><span class="sxs-lookup"><span data-stu-id="29473-108">By using impersonation.</span></span>
    
<span data-ttu-id="29473-109">Когда следует выбирать олицетворение вместо делегирования или изменения разрешений для папки?</span><span class="sxs-lookup"><span data-stu-id="29473-109">When should you choose impersonation over delegation or folder permissions?</span></span> <span data-ttu-id="29473-110">Принимая это решение, воспользуйтесь приведенными ниже рекомендациями.</span><span class="sxs-lookup"><span data-stu-id="29473-110">The following guidelines will help you decide:</span></span>
  
- <span data-ttu-id="29473-111">Изменение разрешений для папки подойдет в том случае, если вы хотите предоставить пользователю доступ к папке, но не хотите, чтобы пользователь имел разрешения "отправить от имени".</span><span class="sxs-lookup"><span data-stu-id="29473-111">Use folder permissions when you want to provide a user access to a folder but do not want the user to have "send on behalf of" permissions.</span></span> 
    
- <span data-ttu-id="29473-112">Используйте делегированный доступ, если хотите предоставить одному пользователю разрешение на выполнение действий от имени другого пользователя.</span><span class="sxs-lookup"><span data-stu-id="29473-112">Use delegate access when you want to give one user permission to perform work on behalf of another user.</span></span> <span data-ttu-id="29473-113">Как правило, это разрешение вида "один к одному" или "один ко многим". Например, один помощник администратора управляет календарем администратора или один диспетчер переговорных управляет календарями использования нескольких переговорных.</span><span class="sxs-lookup"><span data-stu-id="29473-113">Typically, this is a one-to-one or one-to-a-few permission - for example, a single administrative assistant managing the calendar for an administrator, or a single room scheduler managing the calendars for a group of meeting rooms.</span></span>
    
- <span data-ttu-id="29473-114">Олицетворение подойдет в том случае, если вашему приложению-службе нужен доступ к нескольким почтовым ящикам, в которых оно будет "действовать как" их владелец.</span><span class="sxs-lookup"><span data-stu-id="29473-114">Use impersonation when you have a service application that needs to access multiple mailboxes and "act as" the mailbox owner.</span></span>
    
<span data-ttu-id="29473-115">Олицетворение — лучший вариант при работе с несколькими почтовыми ящиками, так как позволяет легко предоставить одной служебной учетной записи доступ к каждому почтовому ящику в базе данных.</span><span class="sxs-lookup"><span data-stu-id="29473-115">Impersonation is the best choice when you're dealing with multiple mailboxes because you can easily grant one service account access to every mailbox in a database.</span></span> <span data-ttu-id="29473-116">Варианты делегирования и изменения разрешений для папки лучше всего использовать для предоставления доступа только нескольким пользователям, поскольку вам придется добавлять разрешения для каждого почтового ящика отдельно.</span><span class="sxs-lookup"><span data-stu-id="29473-116">Delegation and folder permissions are best when you're only granting access to a few users, because you have to add permissions individually to each mailbox.</span></span> <span data-ttu-id="29473-117">На рис. 1 показаны некоторые различия между этими типами доступа.</span><span class="sxs-lookup"><span data-stu-id="29473-117">Figure 1 shows some of the differences between each type of access.</span></span>
  
<span data-ttu-id="29473-118">**Рис. 1. Способы доступа к почтовым ящикам других пользователей**</span><span class="sxs-lookup"><span data-stu-id="29473-118">**Figure 1. Ways to access other users' mailboxes**</span></span>

![Схема, на которой показаны типы доступа к почтовому ящику, связь между владельцами почтовых ящиков и делегатом для каждого типа, а также тип разрешения. Отправка от лица разрешений для делегирования и разрешений папок. Отправка как разрешений для олицетворения.](media/Ex15_Delegate_Overview.png)
  
<span data-ttu-id="29473-122">Олицетворение хорошо подходит для приложений, которые подключаются к Exchange Online, Exchange Online в составе Office 365 и к локальным версиям Exchange и выполняют такие операции, как архивация электронной почты, автоматическая настройка параметров при отсутствии на рабочем месте для пользователей в отпуске и любые другие задачи, для выполнения которых необходимо, чтобы приложение действовало как владелец почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="29473-122">Impersonation is ideal for applications that connect to Exchange Online, Exchange Online as part of Office 365, and on-premises versions of Exchange and perform operations, such as archiving email, setting OOF automatically for users on vacation, or any other task that requires that the application act as the owner of a mailbox.</span></span> <span data-ttu-id="29473-123">Когда приложение использует олицетворение для отправки сообщения, сообщение выглядит как отправленное владельцем почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="29473-123">When an application uses impersonation to send a message, the email appears to be sent from the mailbox owner.</span></span> <span data-ttu-id="29473-124">Получатель не сможет установить, что оно было отправлено с помощью учетной записи службы.</span><span class="sxs-lookup"><span data-stu-id="29473-124">There is no way for the recipient to know the mail was sent by the service account.</span></span> <span data-ttu-id="29473-125">Делегирование, с другой стороны, дает другой учетной записи электронной почты разрешение на выполнение действий от имени владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="29473-125">Delegation, on the other hand, gives another mailbox account permission to act on behalf of a mailbox owner.</span></span> <span data-ttu-id="29473-126">При отправке сообщения электронной почты представителем в поле "От" указывается владелец почтового ящика, а в поле "Отправитель" — представитель, отправивший сообщение.</span><span class="sxs-lookup"><span data-stu-id="29473-126">When an email message is sent by a delegate, the "from" value identifies the mailbox owner, and the "sender" value identifies the delegate that sent the mail.</span></span> 
  
## <a name="security-considerations-for-impersonation"></a><span data-ttu-id="29473-127">Соображения безопасности, связанные с олицетворением</span><span class="sxs-lookup"><span data-stu-id="29473-127">Security considerations for impersonation</span></span>

<span data-ttu-id="29473-128">Олицетворение позволяет вызывающей стороне олицетворить определенную учетную запись пользователя.</span><span class="sxs-lookup"><span data-stu-id="29473-128">Impersonation enables a caller to impersonate a given user account.</span></span> <span data-ttu-id="29473-129">Таким образом вызывающая сторона может выполнять операции, используя вместо разрешений своей учетной записи те разрешения, которые сопоставлены с олицетворенной учетной записью.</span><span class="sxs-lookup"><span data-stu-id="29473-129">This enables the caller to perform operations by using the permissions that are associated with the impersonated account, instead of the permissions that are associated with the caller's account.</span></span> <span data-ttu-id="29473-130">Поэтому при использовании олицетворения необходимо учитывать перечисленные ниже соображения безопасности.</span><span class="sxs-lookup"><span data-stu-id="29473-130">For this reason, you should be aware of the following security considerations:</span></span>
  
- <span data-ttu-id="29473-131">Олицетворение могут применять только учетные записи, которым администратор сервера Exchange назначил роль **ApplicationImpersonation**.</span><span class="sxs-lookup"><span data-stu-id="29473-131">Only accounts that have been granted the **ApplicationImpersonation** role by an Exchange server administrator can use impersonation.</span></span> 
    
- <span data-ttu-id="29473-132">Необходимо создать область управления, ограничивающую олицетворение определенной группой учетных записей.</span><span class="sxs-lookup"><span data-stu-id="29473-132">You should create a management scope that limits impersonation to a specified group of accounts.</span></span> <span data-ttu-id="29473-133">Если область управления не создана, роль **ApplicationImpersonation** назначается всем учетным записям в организации.</span><span class="sxs-lookup"><span data-stu-id="29473-133">If you do not create a management scope, the **ApplicationImpersonation** role is granted to all accounts in an organization.</span></span> 
    
- <span data-ttu-id="29473-134">Как правило, роль **ApplicationImpersonation** предоставляется служебной учетной записи, предназначенной для отдельного приложения или группы приложений, а не учетной записи пользователя.</span><span class="sxs-lookup"><span data-stu-id="29473-134">Typically, the **ApplicationImpersonation** role is granted to a service account dedicated to a particular application or group of applications, rather than a user account.</span></span> <span data-ttu-id="29473-135">Вы можете создать столько служебных учетных записей, сколько потребуется.</span><span class="sxs-lookup"><span data-stu-id="29473-135">You can create as many or as few service accounts as you need.</span></span> 
    
<span data-ttu-id="29473-136">Вы можете ознакомиться с дополнительной информацией о [настройке олицетворения](how-to-configure-impersonation.md), однако вам необходимо обратиться к своему администратору Exchange, чтобы обеспечить создание служебных учетных записей с необходимыми [разрешениями и правами доступа](https://technet.microsoft.com/library/dd351175%28v=exchg.150%29.aspx), соответствующим требованиям вашей организации в области безопасности.</span><span class="sxs-lookup"><span data-stu-id="29473-136">You can read more about [configuring impersonation](how-to-configure-impersonation.md), but you should work with your Exchange administrator to ensure that the service accounts that you need are created with the [permissions and access](https://technet.microsoft.com/library/dd351175%28v=exchg.150%29.aspx) that meet the security requirements of your organization.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="29473-137">Содержание</span><span class="sxs-lookup"><span data-stu-id="29473-137">In this section</span></span>

- [<span data-ttu-id="29473-138">Настройка олицетворения</span><span class="sxs-lookup"><span data-stu-id="29473-138">Configure impersonation</span></span>](how-to-configure-impersonation.md)
    
- [<span data-ttu-id="29473-139">Определение учетной записи для олицетворения</span><span class="sxs-lookup"><span data-stu-id="29473-139">Identify the account to impersonate</span></span>](how-to-identify-the-account-to-impersonate.md)
    
- [<span data-ttu-id="29473-140">Добавление встреч с помощью олицетворения в Exchange</span><span class="sxs-lookup"><span data-stu-id="29473-140">Add appointments by using Exchange impersonation</span></span>](how-to-add-appointments-by-using-exchange-impersonation.md)

## <a name="performance-considerations-for-ews-impersonation"></a><span data-ttu-id="29473-141">Соображения, связанные с безопасностью при олицетворении с помощью EWS</span><span class="sxs-lookup"><span data-stu-id="29473-141">Performance considerations for EWS impersonation</span></span>

<span data-ttu-id="29473-142">При использовании олицетворения с помощью EWS, необходимо всегда правильно устанавливать параметры заголовка X-AnchorMailbox.</span><span class="sxs-lookup"><span data-stu-id="29473-142">When EWS Impersonation is used, the X-AnchorMailbox should always be correctly set.</span></span>  <span data-ttu-id="29473-143">В противном случае вы можете получить сообщение об ошибке 500 или 503.</span><span class="sxs-lookup"><span data-stu-id="29473-143">Otherwise, you may get error messages 500 or 503 at times.</span></span> <span data-ttu-id="29473-144">Это очень важно для показателей производительности и уведомлений в Exchange Online и Exchange 2013.</span><span class="sxs-lookup"><span data-stu-id="29473-144">It is critical for performance and also for notifications with Exchange Online/Exchange 2013.</span></span>  <span data-ttu-id="29473-145">Если не настроить этот заголовок, время выполнения вызова может увеличиться в два и более раз.</span><span class="sxs-lookup"><span data-stu-id="29473-145">Not setting it can double or more the time it takes to complete the call.</span></span> <span data-ttu-id="29473-146">В некоторых случаях можно также задать время ожидания.</span><span class="sxs-lookup"><span data-stu-id="29473-146">In some cases, you can also get timeouts.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="29473-147">См. также</span><span class="sxs-lookup"><span data-stu-id="29473-147">See also</span></span>


- [<span data-ttu-id="29473-148">Разработка клиентов веб-служб для Exchange</span><span class="sxs-lookup"><span data-stu-id="29473-148">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="29473-149">Передача прав доступа и EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="29473-149">Delegate access and EWS in Exchange</span></span>](delegate-access-and-ews-in-exchange.md)
    
- [<span data-ttu-id="29473-150">Разрешения в Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="29473-150">Exchange 2013 Permissions</span></span>](https://technet.microsoft.com/library/dd351175%28v=exchg.150%29.aspx)
    

