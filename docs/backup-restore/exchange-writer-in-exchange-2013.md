---
title: Модуль записи Exchange в Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: ec126433-9f0a-46ec-a685-ff4af2f97bc1
description: Поиск сведений о модуле записи Exchange в Exchange 2013 для операций резервного копирования и восстановления.
ms.openlocfilehash: 44270a87c38b08d274d389fa6e46f3864da13ed2
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2020
ms.locfileid: "44452890"
---
# <a name="exchange-writer-in-exchange-2013"></a>Модуль записи Exchange в Exchange 2013

Поиск сведений о модуле записи Exchange в Exchange 2013 для операций резервного копирования и восстановления. 
  
**Применимо к:** Exchange Server 2013 
  
Модуль записи Exchange несет ответственность за резервное копирование и восстановление активных баз данных Exchange Server 2013. Кроме того, средство записи Exchange поддерживает функцию резервного копирования для выбранной базы данных, в которой теневая копия применяется к реплицированному экземпляру базы данных и файлов журналов транзакций. 
  
## <a name="overview-of-the-exchange-writer"></a>Обзор средства записи Exchange
<a name="bk_Overview"> </a>

Exchange 2013 включает функции мобильности баз данных, которые позволяют реплицировать базы данных между разными серверами Exchange для повышения доступности баз данных и устойчивости сайтов. Другие копии базы данных в группе обеспечения доступности баз данных (DAG) обеспечивают важную возможность для резервного копирования Exchange для использования дополнительных ресурсов, доступных в местоположении копирования. Кроме того, так как резервное копирование выполняется вместо активной базы данных, копия может быть недоступна в течение более длительного периода времени. 
  
Для подготовки файлов базы данных для резервного копирования необходимо закрепить действия ввода-вывода, полученные в результате транзакций Exchange, перед резервным копированием базы данных, а затем разморозить и усечь файлы журнала после завершения резервного копирования.
  
Во время восстановления приложение резервного копирования и восстановления предписывает Exchange Writer согласовать с хранилищем Exchange (работая от имени инициатора запроса), чтобы проверить целевые объекты восстановления, переименовать файл базы данных, если необходимо, а затем при необходимости перезапустить журналы транзакций. Служба Exchange Writer поддерживает резервное копирование и восстановление.
  
Средство записи Exchange Writer доступно на любом сервере Exchange, на котором установлена роль сервера почтовых ящиков. 
  
## <a name="exchange-writer-configuration-settings"></a>Параметры конфигурации модуля записи Exchange
<a name="bk_ExchangeWriterConfig"> </a>

Модуль записи Exchange для VSS использует разнообразные параметры и значения, которые должны быть правильно заданы и сохранены во время операций резервного копирования и восстановления. Эти параметры конфигурации хранятся в документе метаданных модуля записи Exchange. Если приложение резервного копирования не сохраняет эти параметры, при попытке резервного копирования баз данных Exchange могут возникать непредвиденные ошибки. 
  
В следующей таблице перечислены интерфейсы VSS, которые предоставляют метаданные о компонентах резервной копии базы данных. Эти интерфейсы необходимы для получения документа метаданных модуля записи Exchange, используемого для резервного копирования хранилища Exchange.
  
**Таблица 1. Интерфейсы VSS**

|**Интерфейс VSS**|**Описание**|
|:-----|:-----|
|ивссвмкомпонент  <br/> |Предоставляет доступ к сведениям о компонентах, хранящимся в модуле записи Exchange.  <br/> |
|ивссексаминевритерметадата  <br/> |Позволяет приложению с запросом резервного копирования и восстановления проверять метаданные средства записи Exchange. Документ метаданных модуля записи Exchange содержит значения и параметры, относящиеся к Exchange 2013, которые необходимы приложению, запрашивающему резервное копирование и восстановление, чтобы правильно указать соответствующие компоненты для резервного копирования.  <br/> |
|ивсскомпонент  <br/> |Содержит методы для проверки и изменения сведений о компонентах, содержащихся в документе компонентов резервного копирования инициатора запроса. Объекты можно получить только для тех компонентов, которые были добавлены в этот документ явным образом методом [ивссбаккупкомпонентс:: AddComponent](https://msdn.microsoft.com/library/windows/desktop/aa382646%28v=vs.85%29.aspx) .  <br/> |
|ивссбаккупкомпонентс  <br/> |Используется приложением запроса резервного копирования и восстановления для опроса модуля записи Exchange о состоянии файла и выполнении операций резервного копирования и восстановления. Метод [ивссбаккупкомпонентс:: сетбаккупстате](https://msdn.microsoft.com/library/windows/desktop/aa382833%28v=vs.85%29.aspx) определяет, является ли операция резервного копирования полной, копией, добавочной или разностной резервной копией. Метод [ивссбаккупкомпонентс:: аддресторесубкомпонент](https://msdn.microsoft.com/library/windows/desktop/aa382649%28v=vs.85%29.aspx) определяет подкомпоненты базы данных Exchange 2013, которые можно выбрать для операции восстановления.  <br/> |
   
В файловой системе Windows Server база данных Exchange 2013 хранится в виде одного файла базы данных с расширением *EDB. Служба Exchange Writer предоставляет EDB-файл в *качестве компонента базы данных, а файлы журналов транзакций*и файлы контрольных точек (* chk) объединяются в один компонент, который называется компонентом журнала. Дополнительные сведения о файлах базы данных Exchange приведены в статье [Основные понятия резервного копирования и восстановления для exchange 2013](backup-and-restore-concepts-for-exchange-2013.md).
  
## <a name="interactions-between-the-exchange-writer-vss-and-vss-requesters"></a>Взаимодействие между инициаторами записи Exchange, VSS и VSS
<a name="bk_interactions"> </a>

Высокоуровневое взаимодействие между VSS, Exchange Writer и Exchange 2013 во время операций резервного копирования выглядит следующим образом:
  
1. Программа (или агент) архивации запускает запланированное задание. 
    
2. Инициатор запроса VSS в приложении резервного копирования и восстановления отправляет команду VSS для получения теневой копии выбранных баз данных Exchange 2013. 
    
3. Служба VSS взаимодействуют с модулем записи Exchange для подготовки резервной копии моментального снимка. Exchange 2013 запрещает административные действия для баз данных, проверяет зависимости тома и приостанавливает все операции записи с выбранным экземпляром файлов базы данных и журналов транзакций, разрешая доступ только для чтения. 
    
4. Служба VSS взаимодействуют с соответствующим поставщиком хранилища для создания теневой копии тома хранилища, содержащего базы данных Exchange 2013. 
    
5. VSS освобождает Exchange 2013 для возобновления обычных операций. 
    
6. Инициатор запроса VSS проверяет физическую согласованность набора резервных копий перед сигнализацией о том, что резервное копирование прошло успешно. Exchange 2013 усекает журналы транзакций (если база данных входит в группу DAG, усечение журнала реплицируется между всеми копиями) и записывает время последней резервной копии базы данных.
    
Служба VSS сериализует взаимодействие запрашивающих пользователей с модулем записи Exchange, начиная с метода [онпрепаребаккуп](https://msdn.microsoft.com/library/windows/desktop/aa381571%28v=vs.85%29.aspx) и заканчивая методом [онпостснапшот](https://msdn.microsoft.com/library/windows/desktop/aa381568%28v=vs.85%29.aspx) . Как правило, большая часть времени, затрачиваемого модулем записи Exchange на работу с теневой копией, выполняется после метода **онпостснапшот** , когда перед завершением резервного копирования проверяется согласованность теневой копии. Средство записи Exchange Writer поддерживает параллельные резервные копии между **онпостснапшот** и [онбаккупкомплете](https://msdn.microsoft.com/library/windows/desktop/aa381557%28v=vs.85%29.aspx).
  
Exchange 2013 не позволяет параллельно создавать резервные копии одной и той же базы данных. Одновременно может выполняться только одно задание резервного копирования для определенной базы данных. При выполнении резервного копирования хранилище Exchange помещает базу данных в состояние, в котором выполняется резервное копирование. Это состояние в памяти очищается либо после завершения процесса резервного копирования, либо при перезапуске службы. Состояние выполнения резервного копирования в памяти и связанные с ним данные теряются при перезапуске службы, в которой размещается средство записи Exchange, при перезапуске операционной системы или при отработке отказа кластера. Любое из этих событий приведет к сбою задания резервного копирования.
  
Усечение файла журнала транзакций, инициированного резервным копированием, инициируется в зависимости от типа выполняемого резервного копирования. В конфигурациях без DAG служба Exchange Writer усекает файлы журнала транзакций после выполнения полного или добавочного резервного копирования. В реплицированных конфигурациях DAG усечение журнала будет задержано службой репликации до тех пор, пока все необходимые файлы журналов не будут преобразованы во все остальные копии. После проверки того, что файлы журнала успешно применены к базе данных копирования, а контрольная точка копий базы данных и базы данных копирует файлы журналов, служба репликации удалит файлы журнала, которые были удалены.
  
## <a name="see-also"></a>См. также

- [Журналы транзакций и файлы контрольных точек для резервного копирования и восстановления в Exchange 2013](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md)
    
- [Основные понятия резервного копирования и восстановления для Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md)
    

