---
title: Взаимодействие с веб-служб Exchange с помощью управляемого интерфейса API веб-служб Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: d1b78293-da02-413a-875c-681e99146af3
description: Найдите сведения о том, как использовать управляемый API веб-служб Exchange для взаимодействия с веб-служб Exchange в Exchange.
ms.openlocfilehash: 773fcc3f7e95d25effb5a686d4b79ec22610df8c
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "19760995"
---
# <a name="communicate-with-ews-by-using-the-ews-managed-api"></a><span data-ttu-id="7247c-103">Взаимодействие с веб-служб Exchange с помощью управляемого интерфейса API веб-служб Exchange</span><span class="sxs-lookup"><span data-stu-id="7247c-103">Communicate with EWS by using the EWS Managed API</span></span>

<span data-ttu-id="7247c-104">Найдите сведения о том, как использовать управляемый API веб-служб Exchange для взаимодействия с веб-служб Exchange в Exchange.</span><span class="sxs-lookup"><span data-stu-id="7247c-104">Find information about how to use the EWS Managed API to communicate with EWS in Exchange.</span></span>
  
<span data-ttu-id="7247c-105">Класс [ExchangeService](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.exchangeservice%28v=exchg.80%29.aspx) в управляемый API EWS содержит методы и свойства, которые позволяют задать учетные данные пользователя, определение конечной точки веб-служб Exchange, отправлять и получать сообщения SOAP и настроить привязку для связи с веб-служб Exchange.</span><span class="sxs-lookup"><span data-stu-id="7247c-105">The [ExchangeService](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.exchangeservice%28v=exchg.80%29.aspx) class in the EWS Managed API contains the methods and properties that you use to set user credentials, identify the EWS endpoint, send and receive SOAP messages, and configure the binding to communicate with EWS.</span></span> <span data-ttu-id="7247c-106">Прежде чем использовать управляемый API веб-служб Exchange для выполнения любой задачи, необходимо создать экземпляр класса **ExchangeService** и связать его с веб-служб Exchange.</span><span class="sxs-lookup"><span data-stu-id="7247c-106">Before you can use the EWS Managed API to perform any task, you have to create an instance of the **ExchangeService** class and bind it to EWS.</span></span> 
  
<span data-ttu-id="7247c-107">После настройки конечной точки веб-служб Exchange и объекта [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) с использованием учетных данных пользователей, любой объект почтового ящика, который ссылается на объект [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) можно использовать следующие типы метод для взаимодействия с веб-служб Exchange:</span><span class="sxs-lookup"><span data-stu-id="7247c-107">After you set up an [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) object with user credentials and the EWS endpoint, any mailbox object that references the [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) object can use the following method types to communicate with EWS:</span></span> 
  
- <span data-ttu-id="7247c-108">Методы объекта ExchangeService — все методы объекта **ExchangeService** , не наследуется из базового типа **объекта** выполнять вызовы веб-служб Exchange.</span><span class="sxs-lookup"><span data-stu-id="7247c-108">ExchangeService object methods — All the methods on the **ExchangeService** object that are not inherited from the base **Object** type make calls to EWS.</span></span> 
    
- <span data-ttu-id="7247c-109">Элемент почтовых ящиков Exchange и папки введите методы.</span><span class="sxs-lookup"><span data-stu-id="7247c-109">Exchange mailbox item and folder type methods.</span></span>
    
<span data-ttu-id="7247c-110">**В таблице 1. Элемент почтового ящика и папок введите методы, которые взаимодействуют с веб-служб Exchange**</span><span class="sxs-lookup"><span data-stu-id="7247c-110">**Table 1. Mailbox item and folder type methods that communicate with EWS**</span></span>

|<span data-ttu-id="7247c-111">Метод</span><span class="sxs-lookup"><span data-stu-id="7247c-111">Method</span></span>|<span data-ttu-id="7247c-112">Назначение</span><span class="sxs-lookup"><span data-stu-id="7247c-112">What it does</span></span>|<span data-ttu-id="7247c-113">Операции, которые он вызывает</span><span class="sxs-lookup"><span data-stu-id="7247c-113">Operations that it calls</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="7247c-114">Нагрузки</span><span class="sxs-lookup"><span data-stu-id="7247c-114">Load</span></span>](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.item.load%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="7247c-115">Получение свойств объекта конфигурации элемента, вложения или пользователя.</span><span class="sxs-lookup"><span data-stu-id="7247c-115">Gets properties on an item, attachment, or user configuration object.</span></span>  <br/> |[<span data-ttu-id="7247c-116">GetItem Operation</span><span class="sxs-lookup"><span data-stu-id="7247c-116">GetItem operation</span></span>](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="7247c-117">Операция GetAttachment</span><span class="sxs-lookup"><span data-stu-id="7247c-117">GetAttachment operation</span></span>](http://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="7247c-118">Операция GetUserConfiguration</span><span class="sxs-lookup"><span data-stu-id="7247c-118">GetUserConfiguration operation</span></span>](http://msdn.microsoft.com/library/71d50e3c-92bd-435f-8118-b28bb85f8138%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="7247c-119">Привязка</span><span class="sxs-lookup"><span data-stu-id="7247c-119">Bind</span></span>](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="7247c-120">Заполняет элемент на стороне клиента с помощью сведений из существующего элемента на сервере.</span><span class="sxs-lookup"><span data-stu-id="7247c-120">Populates a new item on the client with information from an existing item on the server.</span></span>  <br/> |[<span data-ttu-id="7247c-121">GetItem Operation</span><span class="sxs-lookup"><span data-stu-id="7247c-121">GetItem operation</span></span>](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="7247c-122">Сохранение</span><span class="sxs-lookup"><span data-stu-id="7247c-122">Save</span></span>](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.item.save%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="7247c-123">Сохранение копии элемента клиента на сервере.</span><span class="sxs-lookup"><span data-stu-id="7247c-123">Saves the copy of the client item on the server.</span></span>  <br/> |[<span data-ttu-id="7247c-124">UpdateItem Operation</span><span class="sxs-lookup"><span data-stu-id="7247c-124">UpdateItem operation</span></span>](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="7247c-125">Операцию UpdateFolder</span><span class="sxs-lookup"><span data-stu-id="7247c-125">UpdateFolder operation</span></span>](http://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="7247c-126">CreateItem Operation</span><span class="sxs-lookup"><span data-stu-id="7247c-126">CreateItem operation</span></span>](http://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="7247c-127">CreateFolder Operation</span><span class="sxs-lookup"><span data-stu-id="7247c-127">CreateFolder operation</span></span>](http://msdn.microsoft.com/library/6f6c334c-b190-4e55-8f0a-38f2a018d1b3%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="7247c-128">[обновление](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="7247c-128">[Update](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx)</span></span> <br/> |<span data-ttu-id="7247c-129">Обновляет данные на сервере с помощью изменения, внесенные в клиенте.</span><span class="sxs-lookup"><span data-stu-id="7247c-129">Updates the server with the changes made on the client.</span></span><br/><br/><span data-ttu-id="7247c-130">Для элементов и папок метод **Update** использует [UpdateItem операции](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) и [операции UpdateFolder](http://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="7247c-130">For items and folders, the **Update** method uses the [UpdateItem operation](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) and the [UpdateFolder operation](http://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx).</span></span>  <br/> |[<span data-ttu-id="7247c-131">UpdateItem Operation</span><span class="sxs-lookup"><span data-stu-id="7247c-131">UpdateItem operation</span></span>](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="7247c-132">Операцию UpdateFolder</span><span class="sxs-lookup"><span data-stu-id="7247c-132">UpdateFolder operation</span></span>](http://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="7247c-133">[удаление](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx);</span><span class="sxs-lookup"><span data-stu-id="7247c-133">[Delete](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx)</span></span> <br/> |<span data-ttu-id="7247c-134">Удаляет элемент на сервере.</span><span class="sxs-lookup"><span data-stu-id="7247c-134">Deletes an item on the server.</span></span><br/><br/><span data-ttu-id="7247c-135">Для элементов и папок метод **Delete** использует и [DeleteFolder операции](http://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="7247c-135">For items and folders, the **Delete** method uses the and the [DeleteFolder operation](http://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx).</span></span>  <br/> |[<span data-ttu-id="7247c-136">Операция DeleteItem</span><span class="sxs-lookup"><span data-stu-id="7247c-136">DeleteItem operation</span></span>](http://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="7247c-137">Операция DeleteFolder</span><span class="sxs-lookup"><span data-stu-id="7247c-137">DeleteFolder operation</span></span>](http://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="7247c-138">Copy</span><span class="sxs-lookup"><span data-stu-id="7247c-138">Copy</span></span>](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="7247c-139">Создает копию элемента или папки на сервере.</span><span class="sxs-lookup"><span data-stu-id="7247c-139">Creates a copy of the item or folders on the server.</span></span>  <br/> |[<span data-ttu-id="7247c-140">CopyItem Operation</span><span class="sxs-lookup"><span data-stu-id="7247c-140">CopyItem operation</span></span>](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="7247c-141">Операция CopyFolder</span><span class="sxs-lookup"><span data-stu-id="7247c-141">CopyFolder operation</span></span>](http://msdn.microsoft.com/library/c7ea0d68-9793-4144-b378-d99536776db9%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="7247c-142">Перемещение</span><span class="sxs-lookup"><span data-stu-id="7247c-142">Move</span></span>](http://msdn.microsoft.com/ru-ru/library/microsoft.exchange.webservices.data.item.move%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="7247c-143">Перемещает элементы или папки на сервере.</span><span class="sxs-lookup"><span data-stu-id="7247c-143">Moves items or folders on the server.</span></span>  <br/> |[<span data-ttu-id="7247c-144">MoveItem Operation</span><span class="sxs-lookup"><span data-stu-id="7247c-144">MoveItem operation</span></span>](http://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="7247c-145">Операция MoveFolder</span><span class="sxs-lookup"><span data-stu-id="7247c-145">MoveFolder operation</span></span>](http://msdn.microsoft.com/library/c7233966-6c87-4a14-8156-b1610760176d%28Office.15%29.aspx) <br/> |
   
## <a name="to-use-the-ews-managed-api-to-communicate-with-ews"></a><span data-ttu-id="7247c-146">Чтобы использовать управляемый API веб-служб Exchange для взаимодействия с веб-служб Exchange</span><span class="sxs-lookup"><span data-stu-id="7247c-146">To use the EWS Managed API to communicate with EWS</span></span>

1. <span data-ttu-id="7247c-147">Создайте экземпляр класса **ExchangeService** .</span><span class="sxs-lookup"><span data-stu-id="7247c-147">Instantiate the **ExchangeService** class.</span></span> 
    
   ```csharp
    ExchangeService service = new ExchangeService();
   ```

   > [!NOTE]
   > <span data-ttu-id="7247c-148">Создание экземпляра **ExchangeService** с пустой конструктор будет создать экземпляр, который привязан к последней известной версии Exchange.</span><span class="sxs-lookup"><span data-stu-id="7247c-148">Instantiating **ExchangeService** with an empty constructor will create an instance that is bound to the latest known version of Exchange.</span></span> <span data-ttu-id="7247c-149">Кроме того можно распределять определенной версии Exchange с указанием версии как параметр.</span><span class="sxs-lookup"><span data-stu-id="7247c-149">Alternatively, you can target a specific version of Exchange by specifying version as a parameter.</span></span> `ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2007_SP1);`
  
2. <span data-ttu-id="7247c-150">Задание учетных данных пользователя, который отправляет запросы на сервере Exchange.</span><span class="sxs-lookup"><span data-stu-id="7247c-150">Set the credentials of the user who sends requests to the Exchange server.</span></span> <span data-ttu-id="7247c-151">Если вы хотите подключиться к веб-служб Exchange с компьютера, который вошел в систему к домену, с использованием учетных данных пользователя, прошедшего проверку подлинности, задайте свойству **UseDefaultCredentials** объекта **ExchangeService** в **значение true**.</span><span class="sxs-lookup"><span data-stu-id="7247c-151">If you want to connect to EWS from a computer that is logged on to the domain, using the credentials of the authenticated user, set the **UseDefaultCredentials** property on the **ExchangeService** object to **true**.</span></span>
    
   ```cs
    // Connect by using the default credentials of the authenticated user.
    service.UseDefaultCredentials = true;
   ```

   <span data-ttu-id="7247c-152">Если вы не хотите подключиться, используя учетные данные пользователя по умолчанию, необходимо задайте свойство **учетные данные** для объекта **ExchangeService** , чтобы явным образом укажите учетные данные другого пользователя.</span><span class="sxs-lookup"><span data-stu-id="7247c-152">If you do not want to connect by using the default user credentials, set the **Credentials** property on the **ExchangeService** object to explicitly specify the credentials of a different user.</span></span> <span data-ttu-id="7247c-153">При использовании Exchange Online или Exchange Online в составе Office 365 используется обычная проверка подлинности с помощью только что имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="7247c-153">If you are using Exchange Online or Exchange Online as part of Office 365, you'll use basic authentication, with just a user name and password.</span></span> <span data-ttu-id="7247c-154">Имя домена является обязательным для проверки подлинности NTLM.</span><span class="sxs-lookup"><span data-stu-id="7247c-154">A domain name is required for NTLM authentication.</span></span> 
    
   ```cs
    // Connect by using the credentials of user1 at contoso.com.
    service.Credentials = new WebCredentials("user1@contoso.com", "password");
   ```

   <span data-ttu-id="7247c-155">Также можно указать учетные данные пользователя, с помощью доменное имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="7247c-155">You can also specify the credentials of the user by using the user's domain name and password.</span></span>
    
   ```cs
    // Connect by using the credentials of contoso/user1.
    service.Credentials = new WebCredentials("user1", "password", "contoso");
   ```

   > [!NOTE]
   > <span data-ttu-id="7247c-156">Если свойство **UseDefaultCredentials** имеет значение **true**, значение свойства **учетных данных** игнорируется.</span><span class="sxs-lookup"><span data-stu-id="7247c-156">If the **UseDefaultCredentials** property is set to **true**, the value of the **Credentials** property is ignored.</span></span> 
  
3. <span data-ttu-id="7247c-157">Задайте URL-адрес конечной точки веб-служб Exchange.</span><span class="sxs-lookup"><span data-stu-id="7247c-157">Set the URL of the EWS endpoint.</span></span> <span data-ttu-id="7247c-158">Этот URL-адрес определяет местонахождение файла exchange.asmx на сервере клиентского доступа.</span><span class="sxs-lookup"><span data-stu-id="7247c-158">This URL locates the exchange.asmx file on Client Access server.</span></span>
    
   ```cs
    // Use Autodiscover to set the URL endpoint.
    service.AutodiscoverUrl("user1@contoso.com");
   ```

   > [!NOTE]
   >  <span data-ttu-id="7247c-159">Несмотря на то, что свойство **URL-адрес** **ExchangeService** можно задать значение жестко, мы рекомендуем использовать вместо этого службы автообнаружения по следующим причинам: > автообнаружения определяет наиболее конечной точки для определенного пользователя (конечная точка, который является ближайшим на сервер почтовых ящиков пользователя).</span><span class="sxs-lookup"><span data-stu-id="7247c-159">Although you can explicitly set the **Url** property of the **ExchangeService** to a hardcoded value, we recommend that you use the Autodiscover service instead, for the following reasons: >  Autodiscover determines the best endpoint for a given user (the endpoint that is closest to the user's Mailbox server).</span></span> <span data-ttu-id="7247c-160">> Веб-служб Exchange URL-адрес может изменяться, если развернуть новые серверы клиентского доступа.</span><span class="sxs-lookup"><span data-stu-id="7247c-160">>  The EWS URL might change if new Client Access servers are deployed.</span></span> <span data-ttu-id="7247c-161">В этом сценарии с помощью [службы автообнаружения](autodiscover-for-exchange.md) означает, что изменения кода не требуются.</span><span class="sxs-lookup"><span data-stu-id="7247c-161">In this scenario, using [Autodiscover](autodiscover-for-exchange.md) means no code changes are necessary.</span></span> <span data-ttu-id="7247c-162">> Вам необходимо явно задать URL-адрес или вызова **AutodiscoverUrl**, но не следует оба.</span><span class="sxs-lookup"><span data-stu-id="7247c-162">>  You should either set the URL explicitly or call **AutodiscoverUrl**, but you should not do both.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="7247c-163">См. также</span><span class="sxs-lookup"><span data-stu-id="7247c-163">See also</span></span>

- [<span data-ttu-id="7247c-164">Начало работы с клиентскими приложениями, использующими управляемый API EWS</span><span class="sxs-lookup"><span data-stu-id="7247c-164">Get started with EWS Managed API client applications</span></span>](get-started-with-ews-managed-api-client-applications.md) 
- [<span data-ttu-id="7247c-165">Использование службы автообнаружения для поиска точек подключения</span><span class="sxs-lookup"><span data-stu-id="7247c-165">Use Autodiscover to find connection points</span></span>](how-to-use-autodiscover-to-find-connection-points.md)   
- [<span data-ttu-id="7247c-166">Разработка клиентов веб-служб для Exchange</span><span class="sxs-lookup"><span data-stu-id="7247c-166">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    

