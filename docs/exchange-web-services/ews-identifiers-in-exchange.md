---
title: Идентификаторы EWS в Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 39b6b20b-e081-4347-9e15-9b8cf829fdf0
description: Узнайте об идентификаторах в Exchange и о том, как их можно использовать в управляемых API и приложениях EWS.
ms.openlocfilehash: fbf6d7756f73b1c5d345f3b34deeb7ea8a347986
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2018
ms.locfileid: "21353975"
---
# <a name="ews-identifiers-in-exchange"></a>Идентификаторы EWS в Exchange

Узнайте об идентификаторах в Exchange и о том, как их можно использовать в управляемых API и приложениях EWS.
  
Каждый объект в хранилище Exchange имеет уникальный идентификатор. Вы можете использовать идентификатор объекта для ссылки на объект и отличить его от других объектов. Двумя наиболее распространенными идентификаторами, с которыми можно работать, являются идентификаторы папок и элементов. 
  
Чтобы определить идентификаторы и их важность для вашего приложения, полезно понимать связь между объектами в Exchange. Когда управляемый API EWS или приложение EWS взаимодействуют с Exchange, вы работаете с иерархией объектов, включающей в себя объекты почтовых ящиков, папок и элементов. Хранилищем может быть любой из этих типов объектов. Чаще всего это почтовый ящик на сервере Exchange Server, но он также может быть общедоступной папкой на сервере Exchange. (Помните, что в Exchange Online, Exchange Online в составе Office 365 и версиях Exchange, начиная с Exchange 2013, общедоступные папки — это просто другой тип почтового ящика, а не другой тип хранилища.) Хранилище содержит папки, а папки содержат элементы, а каждая из этих папок и элементов содержит идентификатор, как показано на следующем рисунке. 
  
**Рис. 1. Иерархия почтовых ящиков, папок и элементов**

![Иллюстрация, показывающая иерархию объектов почтового ящика. Почтовый ящик находится на верхнем уровне, а папка "Входящие" — на уровень ниже. На диаграмме показана папка, содержащая сообщения. Идентификаторы и ключи изменения для каждого объекта перечислены в сокращенном виде.](media/Ex15_Identifier_diagram.png)
  
## <a name="ews-identifiers"></a>Идентификаторы EWS
<a name="bk_CommonIdentifiers"> </a>

Идентификаторы, используемые EWS для папок и элементов, называются идентификаторами EWS или Евсидс. Евсидс можно найти в службах EWS во многих разных объектах, но для разных объектов они называются нечто другим. Так как эти объекты можно использовать в приложении, необходимо знать, как идентификаторы этих объектов относятся к Евсид. 
  
Идентификаторы в EWS также применяются и к управляемому API EWS. В управляемом API EWS идентификаторы являются свойствами объектов и внутренне управляются для сопоставления с элементами EWS.
  
**Таблица 1. Идентификаторы объектов в EWS**

|**Object**|**Идентификатор**|**Как она связана с Евсид?**|
|:-----|:-----|:-----|
|[календаритем](http://msdn.microsoft.com/library/b0c1fd27-b6da-46e5-88b8-88f00c71ba80%28Office.15%29.aspx) <br/> |Дочерний элемент [ItemId](http://msdn.microsoft.com/library/3350b597-57a0-4961-8f44-8624946719b4%28Office.15%29.aspx) содержит уникальный идентификатор элемента календаря.  <br/> |Дочерний элемент [ItemId](http://msdn.microsoft.com/library/3350b597-57a0-4961-8f44-8624946719b4%28Office.15%29.aspx) совпадает с евсид для этого элемента.  <br/> |
|[ConversationId](http://msdn.microsoft.com/library/d5f1ddb3-9af3-4677-a6ba-111b304a951e%28Office.15%29.aspx) <br/> |Атрибут **ID** содержит идентификатор диалога, в состав которого входит этот элемент.  <br/> |Атрибут **ID** совпадает с евсид для этого элемента.  <br/> |
|[AttachmentId](http://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) <br/> |Предоставляет уникальный идентификатор вложения. Атрибут [рутитемид](http://msdn.microsoft.com/library/f613c705-17ce-48ce-aa64-4dc2cea25e31%28Office.15%29.aspx) содержит уникальный идентификатор элемента корневого хранилища, к которому присоединено вложение.  <br/> |Вложения могут быть другими элементами в хранилище Exchange, в этом случае [AttachmentId](http://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) — это то же самое, что и евсид. Во всех случаях [рутитемид](http://msdn.microsoft.com/library/f613c705-17ce-48ce-aa64-4dc2cea25e31%28Office.15%29.aspx) является евсид, так как он ссылается на элемент в хранилище.  <br/> |
|[персонаид](http://msdn.microsoft.com/library/eec3a468-afd5-4d72-a61e-cd1964fb686c%28Office.15%29.aspx) <br/> |Атрибут **ID** возвращает строку, содержащую идентификатор пользователя.  <br/> |Атрибут **ID** совпадает с евсид для пользователя.  <br/> |
|[ContactId](http://msdn.microsoft.com/library/86f66275-1e39-48ed-bd89-ac3bffc465a7%28Office.15%29.aspx) <br/> |Атрибут **ID** возвращает строку, содержащую идентификатор контакта.  <br/> |Атрибут **ID** совпадает с евсид для контакта.  <br/> |
|[GroupId](http://msdn.microsoft.com/library/656d9b9a-8a65-4a75-8466-5b0d96512dab%28Office.15%29.aspx) <br/> |Атрибут **ID** возвращает строку, содержащую идентификатор группы.  <br/> |Атрибут **ID** совпадает с евсид для группы.  <br/> |
|[ассоЦиатедкалендаритемид](http://msdn.microsoft.com/library/5b29898c-ea59-4e6a-914c-c011ec754032%28Office.15%29.aspx) <br/> |Атрибут **ID** определяет элемент календаря, связанный с [митингмессаже](http://msdn.microsoft.com/library/c95956a8-7505-44b4-bea4-11d1f5182796%28Office.15%29.aspx), [свойство meetingrequest](http://msdn.microsoft.com/library/c44f8804-a355-473d-a837-48cc91617251%28Office.15%29.aspx), [митингреспонсе](http://msdn.microsoft.com/library/9f798e79-dafd-4d4d-9967-95fd8e5c0502%28Office.15%29.aspx)или [митингканцеллатион](http://msdn.microsoft.com/library/a9c61f7f-2ecd-4b21-9dce-24d9f61aeeea%28Office.15%29.aspx).  <br/> |Атрибут **ID** совпадает с евсид для элемента календаря.  <br/> |
|[усерконфигуратионпропертиес](http://msdn.microsoft.com/library/c143a6ec-62ad-4d48-b844-b1ad88054bc1%28Office.15%29.aspx) <br/> |Значение **ID** для этого элемента указывает свойство идентификатора.  <br/> |Этот идентификатор напрямую не сопоставляется с Евсид, так как он является идентификатором свойства, а не элементом.  <br/> |
|[оккурренцеитемид](http://msdn.microsoft.com/library/4a15bbc3-5b93-4193-b9ec-da32f0a9a552%28Office.15%29.aspx) <br/> |Атрибут **рекуррингмастерид** определяет шаблон повторяющегося элемента.  <br/> |Значение **оккурренцеитемид** не соответствует непосредственно в евсид, но **рекуррингмастерид** работает, так как ссылается на объект повторяющегося элемента повторяющегося элемента.  <br/> |
|[сторинтрид](http://msdn.microsoft.com/library/f536e264-8c4d-4cc5-bab8-22a4fa38de39%28Office.15%29.aspx) <br/> |Содержит идентификатор хранилища Exchange для элемента.  <br/> |Значение **сторинтрид** не сопоставляется с евсид, но оно предоставляет идентификатор хранилища, в котором хранятся элементы.  <br/> |
   
## <a name="working-with-identifiers"></a>Работа с идентификаторами
<a name="bk_WorkingWithIdentifiers"> </a>

Сервер Exchange Server обрабатывает идентификаторы множеством различных способов. При разработке управляемого API EWS или приложения EWS учитывайте следующее:
  
- Значение элемента **ItemId** для папок и элементов задается с учетом регистра. При просмотре идентификатора элемента для папки или элемента, возвращаемых [операцией FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) (или методом [FindItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) для управляемого API EWS), может показаться, что это дубликат другого идентификатора элемента; Тем не менее, один или несколько символов в идентификаторах элементов для двух элементов будут иметь другой регистр. 
    
- Если вы собираетесь сохранить идентификатор элемента в базе данных для последующего извлечения, рекомендуем размер поля составляет 512 байт, чтобы он был достаточно большим для хранения GUID.
    
- Не следует предполагать, что ваш идентификатор всегда будет действительным, если вам потребуется получить его позже. Если элемент перемещается в хранилище, идентификатор может измениться в связи с тем, как будет обработано перемещение. Элемент на самом деле копируется и создается новый идентификатор, а затем [исходный элемент удаляется](deleting-items-by-using-ews-in-exchange.md).
    
- Идентификаторы в Exchange непрозрачны. Например, Евсид создается на основе нескольких несущественных элементов информации, которые не являются разработчиками, но очень важны для Exchange.
    
- При работе с элементами в Exchange следует помнить о том, что атрибут **чанжекэй** имеет другое значение. Это значение в дополнение к ИДЕНТИФИКАТОРу элемента используется для отслеживания состояния элемента. При каждом изменении элемента создается новый ключ изменения. Например, при выполнении [операции UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx)можно использовать атрибут **чанжекэй** , чтобы сообщить серверу о том, что обновление применяется к самой последней версии элемента. Если обновление элемента было изменено другим приложением, ключи изменений не будут совпадать и вы не сможете выполнить обновление. 
    
## <a name="distinguished-folder-ids"></a>Идентификаторы различающихся папок
<a name="bk_DistinguishedFolderIds"> </a>

Exchange включает ряд предварительно заданных папок почтовых ящиков, каждый из которых назначается идентификатором, называемым ИДЕНТИФИКАТОРом различающегося папки. Они определяются перечислением управляемого API [веллкновнфолдернаме](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.wellknownfoldername%28v=exchg.80%29.aspx) EWS и элементом [дистингуишедфолдерид](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) EWS. Эти идентификаторы различающихся папок можно использовать для упрощения ссылки на одну из предварительно определенных папок. Например, для папки "Входящие" можно просто использовать для идентификатора папку "Входящие", а не определять идентификатор папки. 
  
Другие папки, создаваемые для упорядочивания элементов электронной почты, также имеют идентификатор, который является уникальным для этой папки. Этот идентификатор не изменяется даже при изменении других свойств папки.
  
Вы можете использовать идентификаторы различающихся папок в качестве точки входа для доступа к представителям. При инициации доступа к представителю выполняется поиск элементов или папок, а также указывается идентификатор папки, в которой будет выполняться поиск. Когда представитель-представитель получает доступ к серверу, для явного указания почтового ящика для доступа делегата используется элемент [почтового ящика](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) , который является дочерним по отношению к элементу **дистингуишедфолдерид** . 
  
## <a name="handling-errors"></a>Обработка ошибок
<a name="bk_DealingWithErrors"> </a>

Каждая программа привязывается к ошибке каждый раз, а затем приложения на основе EWS не удаляют исключение (Пун). Могут возникать некоторые ошибки, связанные с идентификаторами, в элементе [респонсекоде](http://msdn.microsoft.com/library/4b84d670-74c9-4d6d-84e7-f0a9f76f0d93%28Office.15%29.aspx) EWS или в составе перечисления управляемого API [сервицееррор](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.serviceerror%28v=exchg.80%29.aspx) EWS. 
  
В управляемом API EWS или приложении EWS могут возникать следующие ошибки. При работе с приложением управляемого API EWS ошибки обычно возникают из-за проблем со значениями свойств; для приложений EWS ошибки связаны со значениями или операциями XML-элементов.
  
**Таблица 2. Ошибки, связанные с идентификатором**

|**Ошибка**|**Происходит, когда...**|**Описание**|
|:-----|:-----|:-----|
|ерроркалендарканнотусеидфороккурренцеид  <br/> |Значение **оккуренцеид** не соответствует допустимому повторяющемуся элементу календаря.  <br/> |Значение **оккуренцеид** , указанное в запросе, может быть допустимым в структуре, но запрос не может совпадать с существующим повторяющимся образцом. Повторяющийся элемент может быть удален из календаря. Убедитесь, что элемент по-прежнему существует и используется правильный идентификатор.  <br/> |
|ерроркалендарканнотусеидфоррекуррингмастерид  <br/> |Атрибут **рекуррингмастерид** не соответствует допустимому экземпляру элемента **оккурренцеид** .  <br/> |Значение **рекуррингмастерид** , указанное в запросе, может быть допустимым в структуре, но запрос не может сопоставлять его с существующим экземпляром элемента. В календаре может быть удалено вхождение элемента. Убедитесь, что элемент по-прежнему существует и используется правильный идентификатор.  <br/> |
|еррорканнотусефолдеридфоритемид  <br/> |Переданный **идентификатор** представляет папку, а не элемент.  <br/> |Идентификатор может быть допустимым в формате, но не в том, что сервер ожидался для операции. Убедитесь, что вы ссылаетесь на правильный идентификатор для операции.  <br/> |
|еррорканнотусеитемидфорфолдерид  <br/> |Переданный **идентификатор** представляет элемент, а не папку.  <br/> |Идентификатор может быть допустимым в формате, но не в том, что сервер ожидался для операции. Убедитесь, что вы ссылаетесь на правильный **идентификатор** для операции.  <br/> |
|еррорчанжекэйрекуиредфорвритеоператионс  <br/> |При выполнении определенных операций обновления необходимо предоставить действительный ключ изменения.  <br/> |Либо при запросе обновления было пропущено значение **чанжекэй** , либо ключ изменения был неправильным. При выполнении операций обновления убедитесь, что у вас есть правильный ключ изменения.  <br/> |
|ерроринвалидаттачментид  <br/> |Вложение не найдено в коллекции вложений для элемента.  <br/> |Этот код ответа может быть получен, если у вас есть **идентификатор** вложения, а затем вложение удалено, и вы пытаетесь вызвать [операцию GetAttachment](http://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx) для идентификатора вложения. Убедитесь, что вложение существует в коллекции вложений.  <br/> |
|ерроринвалидчанжекэй  <br/> |Передан недопустимый ключ изменения.  <br/> |Обратите внимание, что для многих операций и методов не требуется передавать ключ изменения. Тем не менее, если вы предоставляете ключ изменения, он должен быть допустимым, хотя и не обязательно должен быть актуальным.  <br/> |
|ерроринвалидфолдерид  <br/> |**Идентификатор** папки поврежден.  <br/> |Убедитесь, что у вас есть правильно отформатированный и допустимый идентификатор.  <br/> |
|ерроринвалидид  <br/> |Структура ключа **ID** и/или изменений внутренне несогласованна.  <br/> |В Exchange возникла проблема с **идентификатором** после его синтаксического анализа. Возможно, возникла ошибка при преобразовании. Это может произойти, например, при наличии элемента **идформаттипе. хексентрид** для элемента в Outlook, но его можно преобразовать в евсид, чтобы оно имело формат **идформаттипе. EntryID** . Убедитесь, что используется правильный тип преобразования.  <br/> |
|ерроринвалидидемпти  <br/> |Приложение указало пустой **идентификатор** .  <br/> |Приложение передается в виде пустой строки для идентификатора. Убедитесь, что у вас есть правильно отформатированный и допустимый идентификатор.  <br/> |
|ерроринвалидидмалформед  <br/> |Внутренняя структура **идентификатора** несогласованна.  <br/> |В Exchange возникла проблема с **идентификатором** после его синтаксического анализа. Возможно, идентификатор был преобразован неправильно. Убедитесь, что используется правильный тип преобразования.  <br/> |
|ерроринвалидидмалформедевслегациидформат  <br/> |Для запроса с версией Exchange 2007 с пакетом обновления 1 (SP1) или более поздней версии был указан **идентификатор** папки или элемента, использующего формат Exchange 2007.  <br/> |Нельзя использовать идентификаторы Exchange 2007 в запросах Exchange 2007 с пакетом обновления 1 (SP1) или более поздних Для их преобразования в первую очередь необходимо использовать операцию [ConvertId](http://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx) EWS или метод [CONVERTID](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.convertid%28v=exchg.80%29.aspx) EWS Managed API.  <br/> |
|ерроринвалидиднотанитематтачментид  <br/> |Свойство **AttachmentId** не ссылается на вложение элемента.  <br/> |Идентификатор может быть допустимым в формате, но не в том, что сервер ожидался для операции. Убедитесь, что вы ссылаетесь на правильный идентификатор для операции.  <br/> |
|ерроринвалидидретурнедбиресолвенамес  <br/> |Контакт в вашем почтовом ящике поврежден.  <br/> |[ResolveNames](http://msdn.microsoft.com/library/6b4eb4b3-9ad6-4804-a09f-7e20cfea4dbb%28Office.15%29.aspx) EWS или метод [РЕСОЛВЕНАМЕ](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.resolvename%28v=exchg.80%29.aspx) EWS Managed API вернул один или несколько идентификаторов, но они являются недопустимыми. Возможно, вам потребуется повторно создать контакт.  <br/> |
|ерроринвалидидстореобжектидтулонг  <br/> |Внутренняя структура **идентификатора** несогласованна.  <br/> |В Exchange возникла проблема с **идентификатором** после его синтаксического анализа. Возможно, **идентификатор** был преобразован неправильно. Убедитесь, что используется правильный тип преобразования.  <br/> |
|ерроринвалидидтуманяттачментлевелс  <br/> |Иерархии вложений превышают максимально допустимое количество уровней 255.  <br/> |Значение свойства **AttachmentId** , указанное в запросе, может быть допустимым в структуре, но запрошенное вложение слишком глубоко в иерархии. Код мог попытаться присоединить элемент к превышению ограничения в 255 уровней.  <br/> |
|ерроринвалидимконтактид  <br/> |Эта ошибка может возвращаться, если не удается найти контакт в группе IM при использовании [операции RemoveImContactFromGroup](http://msdn.microsoft.com/library/a190bbec-c71b-4e6a-880b-55854c724d8c%28Office.15%29.aspx). Эта ошибка относится к клиентам, предназначенным для Exchange Online и версиям Exchange, начиная с Exchange 2013.  <br/> |Значение свойства **ContactId** , указанное в запросе, может быть допустимым в структуре, но нет контактов в почтовом ящике, которые совпадают с этой структурой. Возможно, он уже удален.  <br/> |
|ерроринвалидимграупид  <br/> |Эта ошибка может возвращаться, если не удается найти группу в почтовом ящике при использовании [операции RemoveImGroup](http://msdn.microsoft.com/library/5e788016-68e0-4a3f-9243-03f6b6c6b389%28Office.15%29.aspx). Эта ошибка относится к клиентам, предназначенным для Exchange Online и версиям Exchange, начиная с Exchange 2013.  <br/> |Значение свойства **groupId** , указанное в запросе, может быть допустимым в структуре, но нет групп в почтовом ящике, которые совпадают с этой структурой. Возможно, группа уже была удалена.  <br/> |
|ерроринвалидреференцеитем  <br/> |Идентификатор элемента, на который указывает ссылка, не является **MessageType** или **пространстве exchangewebservices. календаритемтипетипе**или одним из их потомков. Идентификатор элемента ссылки предназначен для объекта **календаритемтипе** , и организатор пытается ответить или ReplyAll.  <br/> |Идентификатор может быть допустимым в формате, но не в том, что сервер ожидался для операции. Убедитесь, что вы ссылаетесь на правильный идентификатор для операции.  <br/> |
|еррормиссингманажедфолдерид  <br/> |Свойство идентификаторов политик 0x6732 для папки отсутствует.  <br/> |Папка повреждена. Рекомендуется воссоздать его.  <br/> |
   
## <a name="converting-identifiers"></a>Преобразование идентификаторов
<a name="bk_ConvertingIdentifiers"> </a>

Может потребоваться преобразовать идентификатор из одного формата в другой. Например, может потребоваться преобразовать идентификатор из внешней службы EWS, например идентификатор, поступающий из подключения MAPI, в формат, который может использовать ваше приложение. Для этого можно использовать операцию [ConvertId](http://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx) EWS или метод [CONVERTID](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.convertid%28v=exchg.80%29.aspx) EWS Managed API. 
  
Например, EntryID — это уникальный идентификатор, созданный хранилищем сообщений MAPI, которое назначается хранилищем при сохранении элемента. Чтобы использовать идентификатор EntryID в приложении, сначала необходимо преобразовать его в Евсид. 
  
Outlook Web App использует собственные версии идентификаторов, называемые Оваид, в URL-адресах для доступа к папкам и элементам. Если приложению требуется доступ к элементам в Outlook Web App, необходимо преобразовать Оваид в Евсид.
  
Для преобразования нескольких различных форматов идентификатора можно использовать операцию или метод **ConvertId** . 
  
**Таблица 3. Преобразуемые форматы идентификаторов в Exchange**

|**Формат**|**Описание**|
|:-----|:-----|
|евслегациид  <br/> |Евсид, применяемый к Exchange 2007.  <br/> |
|евсид  <br/> |Евсид, который применяется к Exchange Online и версиям Exchange начиная с Exchange 2007 с пакетом обновления 1 (SP1).  <br/> |
|StoreId  <br/> |Идентификатор хранилища Exchange, в котором хранятся папки и элементы.  <br/> |
|оваид  <br/> |Идентификатор Outlook Web App, используемый с Outlook Web App в Exchange 2007 и Exchange 2010. <br/><br/>**Примечание**: Exchange Online и версии Exchange начиная с Exchange 2013 Используйте Евсид для Outlook Web App.           |
|Код  <br/> |Идентификатор MAPI, который обычно называется свойством **PR_ENTRYID** сообщения MAPI.  <br/> |
|хексентрид  <br/> |Представление свойства **PR_ENTRYID** в шестнадцатеричном формате, которое используется для идентификатора события календаря доступности. Это также формат идентификатора, который использует Outlook.  <br/> |
   
## <a name="see-also"></a>См. также

- [Разработка клиентов веб-служб для Exchange](develop-web-service-clients-for-exchange.md)  
- [Операция ConvertId](http://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx)  
- [Перечисление Сервицееррор](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.serviceerror%28v=exchg.80%29.aspx) 
- [Удаление элементов с помощью EWS в Exchange](deleting-items-by-using-ews-in-exchange.md)
    

