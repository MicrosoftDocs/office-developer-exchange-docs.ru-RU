---
title: Экспорт и импорт элементов с помощью веб-служб Exchange в Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: ad5f75f9-47c3-4f51-a535-80cba4243683
description: Узнайте о Экспорт и импорт встреч, сообщения электронной почты, контакты, задачи и другие элементы почтового ящика с помощью управляемого интерфейса API веб-служб Exchange или веб-служб Exchange в Exchange.
ms.openlocfilehash: 00c72806b95c162077733f77a52c4ea4da03631f
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2018
ms.locfileid: "21353653"
---
# <a name="exporting-and-importing-items-by-using-ews-in-exchange"></a>Экспорт и импорт элементов с помощью веб-служб Exchange в Exchange

Узнайте о Экспорт и импорт встреч, сообщения электронной почты, контакты, задачи и другие элементы почтового ящика с помощью управляемого интерфейса API веб-служб Exchange или веб-служб Exchange в Exchange. 
  
Exchange не мин gold важной информации: электронной почты, контакты, задачи и календарей приведены основные функции организации. Веб-служб Exchange можно экспортировать и импортировать основные типы элементов с помощью трех различных подходов:
  
- Типы элементов Exchange. Мы рекомендуем этот подход для импорта и экспорта элементов в и из других систем и файлы.
    
- Возможности на уровне элементов (EWS). Мы рекомендуем этот параметр для экспорта или копирование из одного сервера Exchange или почтовых ящиков и импорта на другой.
    
- Потоки MIME в виде общих стандартных форматов, например iCalendar и визитных карточек. Ограниченный набор свойств и преобразования MIME обходится дорого, поэтому рекомендуется подход только для импорта или экспорта небольшой объем данных.
    
> [!IMPORTANT]
> Веб-служб Exchange не предназначен для почтового ящика резервного копирования и восстановления. Для резервного копирования и восстановления баз данных, используйте [API резервного копирования и восстановления](../backup-restore/backup-and-restore-for-exchange-2013.md). Смотрите также [резервное копирование, восстановление и аварийное восстановление](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx) на сайте TechNet. 
  
**В таблице 1. Экспорт и импорт контактов, электронной почты и элементы календаря**

|Задача|Метод управляемого API EWS|Операция служб EWS|����������|
|:-----|:-----|:-----|:-----|
|Экспортируйте копию контактов, электронной почты, задачи или элемента календаря с помощью [указанного свойства](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Appointment.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> [Task.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.bind%28v=exchg.80%29.aspx) <br/> |[GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |Мы рекомендуем этот параметр, если выполняется импорт элементов почтового ящика к другой системе не Exchange или файл (в том числе визитных карточек и типы файлов iCal).<br/>Поскольку обеспечивает контроль над набором экспортированного свойств, а производительность лучше подходит для Exchange server, обычно это лучший вариант.<br/><br/>В зависимости от свойства задайте для элемента почтового ящика и ли приложение будет учитывать все идентификаторы не Схематизированный свойство (расширенные свойства), которые могут быть заданы в элемент, этот параметр не может привести к точного копии.<br/><br/>Эти методы и операции предоставляют Схематизированный набор свойств для элемента, а также запрошенные расширенных свойств.<br/>Метод **Bind** или операции **GetItem** может предоставить только точное экспорта элементов, если вы знаете расширенные свойства, заданные для элемента.<br/>Можно запросить все известные [Расширенные свойства](properties-and-extended-properties-in-ews-in-exchange.md) для включения корректном.<br/><br/>**Совет**: можно использовать функцию трассировки в управляемый API EWS для получения XML-представление экспортируемые элементы.           Дополнительные сведения можно [экспортировать элемента в пользовательском формате](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom).  <br/> |
|Импортируйте копию контактов, электронной почты, задачи или элемента календаря с помощью [указанного свойства](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx) <br/> [EmailMessage.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Appointment.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> [Task.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.save%28v=exchg.80%29.aspx) <br/> |[CreateItem](http://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> |Мы рекомендуем этот параметр для импорта элементов почтового ящика в Exchange.<br/>Может потребоваться задать особые свойства для некоторых типов элементов для поддержания состояние импортированных элемента.<br/>Так как некоторые свойства устанавливаются только по Exchange, а не с клиентами, не всегда возможно точное импорта.<br/><br/>Например нельзя импортировать собрания человек в почтовый ящик, поскольку Exchange устанавливает отношения между организатора и участников. <br/>В этом связь может быть установлена только с организаторов отправку и участники получение и отвечать на приглашения на собрание.<br/><br/>Объекты **встречи** в Exchange могут иметь сложных отношений и параметры.<br/> Встречи, которые имеют участников (собрания) имеют параметры, объединение Организатор собрания и участников собрания.<br/>Эти параметры не сохраняются при экспорте и импорте встреч.<br/>Программная повторная установка собрания организатор/attendee связи непосредственно на встречи не поддерживается.<br/>Параметр отсутствует для восстановления этих отношений — для выполнения последующей обработки после импорта, у инициатора повторно отправить собраний и у участников принять приглашения на собрания.<br/>Олицетворение Exchange можно использовать для звонков для организатора и участников.<br/>Необходимо изменить свойство UID объекта **встречи** , перед импортом следует избегать собраний неправильно относиться к другим собраний в почтовый ящик.  <br/> |
|Экспортируйте копию контактов, электронной почты, задачи или элемента календаря в надежностью.  <br/> |Не применимо  <br/> |[ExportItems](http://msdn.microsoft.com/library/e2846abb-0b16-4732-bbd8-038a674672f6%28Office.15%29.aspx) <br/> |Это лучший вариант для экспорта элементов почтового ящика, которые вы хотите импортировать обратно в почтовый ящик Exchange.<br/>Этот параметр служит для копирования элементов между почтовыми ящиками.<br/><br/>Операция **ExportItems** предоставляет непрозрачный поток, который представляет элемент, который можно использовать для перемещения информации между почтовыми ящиками.<br/>**ExportItems** с помощью операции [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) позволяет создать индекс для поиска элементов в другой системе.<br/>Нельзя изменить в потоке экспорта.  <br/> Для получения дополнительных сведений см [экспорта элементов с корректном](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity).  <br/> |
|Импортируйте копию контактов, электронной почты, задачи или элемента календаря в надежностью.  <br/> |Не применимо  <br/> |[UploadItems](http://msdn.microsoft.com/library/a88cbe99-7968-454d-a545-4f92c330909f%28Office.15%29.aspx) <br/> |Это единственный параметр Импорт элементов, которые были экспортированы операцией **ExportItems** .  <br/> |
|Экспортируйте копию контактов, электронной почты или элемента календаря как поток MIME для типа файла.  <br/> |[Contact.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Appointment.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> |**GetItem** <br/> |Свойство [MimeContent](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx) получить представление потока MIME элемента.<br/><br/>Это обеспечит базовой подмножество всех свойств элемента.<br/>Как рекомендуется используйте только MIME-поток для одноразовых операций.<br/>Не полагайтесь на MIME для крупных и часто используемые Импорт/экспорт элементов, так как Exchange выполняет преобразование содержимого MIME и может повлиять на производительность.<br/><br/>Поток MIME **контакт** находится в файле [vCard](http://www.faqs.org/rfcs/rfc2426.html) (.vcf).<br/>В зависимости от свойства, установленные на контакт это не дает точное копии.<br/>Обратите внимание, что нельзя импортировать контакта с помощью потока MIME визитных карточек.<br/>Для получения дополнительных сведений см [Экспорт в файл визитной карточки контакта](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime).<br/><br/>Поток MIME **EmailMessage** — указывать.<br/>Формат EML с помощью проводника удобно, так как Outlook и другие клиенты электронной почты можно определить его.<br/>MIME-поток можно также использовать для создания файла .mht, который удобно, так как многие браузеры могут воспользоваться этим типом файла.<br/>Веб-служб Exchange не предоставляет файлового потока MSG-файл для экспорта сообщения электронной почты в Msg-файл.<br/>Доступны следующие варианты для экспорта MSG-файл: либо [конструкции. MSG-файла](http://msdn.microsoft.com/en-us/library/cc463912%28v=EXCHG.80%29.aspx) из результатов метод **EmailMessage.Bind** или операции **GetItem** звонок или использовать API сторонних производителей, который вызывает веб-служб Exchange и создает MSG-файл из результатов.<br/>Дополнительные сведения можно [экспортировать сообщение электронной почты указывать](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime).<br/><br/>Поток MIME **встречи** — iCal (ICS)-файла.<br/>Формат .ics удобно, так как Outlook и другие клиенты электронной почты можно определить его.<br/>Не является приемлемым для экспорта собрания, поскольку сведения об участниках не указан в MIME-поток. <br/>Вложения и другие свойства не могут включаться в MIME-поток.<br/>Рассмотрите возможность создания формате iCal из объекта [встречи](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx) или XML, возвращенные операцией **GetItem** .<br/>Таким образом, вы можете захватить несколько свойств Exchange с помощью расширенных свойств ("X-" Свойства) в файле iCal.<br/>Вы также можете экспортировать встречи в XML-форм.<br/>Вызвать операции **GetItem** и сохранить XML-кода в системе.<br/>Можно также использовать [возможности трассировки](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md) в управляемый API EWS для получения XML-код для размещения в базе данных XML.<br/>Для получения дополнительных сведений см [Экспорт встречи в формате iCal](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime).  <br/> |
|Импортируйте копии элемента электронной почты или календаря в виде потока MIME для типа файла.  <br/> |[EmailMessage.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Appointment.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> |**CreateItem** <br/> |Можно импортировать файл EML с помощью проводника или .ics с помощью свойства **MimeContent** на объекте **EmailMessage** или **встречи** .<br/>Необходимо установить [PidTagMessageFlags (0x0E07)](http://msdn.microsoft.com/en-us/library/office/cc839733%28v=office.15%29.aspx) расширенные свойства, если сообщение электронной почты не черновик.<br/><br/>Такой подход нельзя использовать для импорта собрания.  <br/> |
   
## <a name="alternatives-to-exporting-and-importing-items-by-using-ews"></a>Альтернативы для экспорта и импорта элементов с помощью веб-служб Exchange
<a name="alternatives"> </a>

Другие параметры доступны для exporing и импорт элементов, чтобы и из почтового ящика Exchange. Ниже приведены некоторые рекомендации, которые следует учитывать при при проектировании импорта и экспорта стратегии.
  
- Использование PowerShell для вызова веб-служб Exchange и форматирования выходных данных в CSV-файл.
    
- Использование библиотек сторонних производителей, которые реализуют MAPI для экспорта и импорта элементов. Слишком доступны библиотеки сторонних производителей, которые преобразование веб-служб Exchange в файлы MSG-файл.
    
- С помощью командлетов командной консоли Exchange и [MailboxImportRequest](http://technet.microsoft.com/en-us/library/ff607310%28v=exchg.150%29.aspx) и [MailboxExportRequest](http://technet.microsoft.com/en-us/library/ff607299%28v=exchg.150%29.aspx) для [удовлетворения соответствующих импорта почтовых ящиков и экспорта запросов](http://technet.microsoft.com/en-us/library/ee633455%28v=exchg.150%29.aspx). 
    
- Используйте [Параметры импорта Outlook](http://office.microsoft.com/en-us/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx) для импорта и экспорта элементов. 
    
## <a name="in-this-section"></a>В этой статье
<a name="alternatives"> </a>

- [Экспорт элементов с помощью веб-служб Exchange в Exchange](how-to-export-items-by-using-ews-in-exchange.md)    
- [Импорт элементов с помощью веб-служб Exchange в Exchange](how-to-import-items-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a>См. также

- [Резервное копирование, восстановление и аварийное восстановление](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx)  
- [Ведение журнала](http://technet.microsoft.com/en-us/library/aa998649%28v=exchg.150%29.aspx)    
- [Ведение календаря в Интернете и планирование спецификация объект ядра (RFC 5545)](http://tools.ietf.org/html/rfc5545)   
- [Синхронизация почтового ящика и веб-службах Exchange](mailbox-synchronization-and-ews-in-exchange.md)
    

