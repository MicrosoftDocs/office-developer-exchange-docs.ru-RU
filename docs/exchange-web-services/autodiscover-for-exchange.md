---
title: Автообнаружение для Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: da0f9402-4e35-42c7-a15e-1e9e4e966e8b
description: Сведения о службе автообнаружения в Exchange.
ms.openlocfilehash: f56717eaced5db9028c556c6c2d9aa7794f4988e
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19760961"
---
# <a name="autodiscover-for-exchange"></a>Автообнаружение для Exchange

Информация, содержащаяся в этом документе, может относиться к функциям и продуктам предварительной версии и может претерпеть значительные изменения до окончательного коммерческого выпуска. Настоящий документ предоставляется "как есть" и служит только для информационных целей. Корпорация Майкрософт не предоставляет никаких гарантий, явных или подразумеваемых, в связи с этим документом Сведения о службе автообнаружения в Exchange.
  
Служба автообнаружения Exchange позволяет клиентскому приложению с легкостью настроиться практически без участия пользователя. Большинство пользователей знают свои адрес электронной почты и пароль, и с помощью этих сведений вы можете получить все остальные сведения, необходимые для начала работы. Для клиентов веб-служб Exchange (EWS) автообнаружение обычно используется, чтобы найти URL-адрес конечной точки EWS, но служба автообнаружения также может предоставлять сведения для настройки клиентов, использующих другие протоколы. Автообнаружение работает с клиентскими приложениями как за брандмауэрами, так и за их пределами, и будет работать в сценариях с лесом ресурсов или несколькими лесами.
  
## <a name="overview-of-the-autodiscover-process"></a>Обзор процесса автообнаружения
<a name="bk_Before"> </a>

Процесс автообнаружения состоит из трех основных этапов. На первом этапе создается список потенциальных серверов автообнаружения, а на втором вы проверяете каждый сервер в списке, пока (при благоприятном исходе) не будет получен успешный ответ. Если ни один из кандидатов не подошел, вы переходите к третьему этапу, который представляет последнюю попытку найти конечную точку автообнаружения.
  
Метод [ExchangeService.AutodiscoverUrl](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.autodiscoverurl%28v=exchg.80%29.aspx) в управляемом API EWS реализует все три этапа, поэтому при использовании управляемого API EWS вам не нужно беспокоиться о реализации автообнаружения. На следующем рисунке показаны три этапа процесса автообнаружения. 
  
**Рисунок 1. Три этапа процесса автообнаружения**

![Иллюстрация процесса автообнаружения с тремя этапами: определение пула кандидатов, попытка связи с конечными точками и альтернативными объектами.](media/Ex15_Autodiscover_Overview.png)
  
### <a name="phase-1-defining-the-candidate-pool"></a>Этап 1. Определение пула кандидатов
<a name="bk_Phase1"> </a>

Прежде чем использовать службу автообнаружения, необходимо найти подходящий сервер автообнаружения для пользователя. К счастью, служба автообнаружения задает ограниченное количество мест для поиска. Если найдено несколько кандидатов, служба автообнаружения также определяет [способ создания и сортировки списка по приоритету](how-to-generate-a-list-of-autodiscover-endpoints.md).
  
**Таблица 1. Источники кандидатов на конечную точку автообнаружения**

|**Место для поиска**|**Результат поиска**|
|:-----|:-----|
|Доменные службы Active Directory (AD DS)  <br/> |Для клиентов, присоединенных к домену, поиск следует начинать отсюда. Exchange публикует объекты точек подключения службы (SCP) в AD DS, что позволяет направлять запросы автообнаружения на сайты Active Directory. Результаты [поиска SCP](how-to-find-autodiscover-endpoints-by-using-scp-lookup-in-exchange.md) должны находиться в начале списка кандидатов.  <br/><br/>**Примечание**: поиска SCP недоступно для клиентов, не присоединенного к домену или, не имеющие доступа к серверам Active Directory. В этом случае следует пропустить поиска SCP. <br/>|
|Домен адреса электронной почты пользователя  <br/> | Служба автообнаружения задает две стандартных формы URL-адресов конечных точек, получаемых из доменной части адреса электронной почты пользователя:  <br/>`"https://" + domain + "/autodiscover/autodiscover" +  *fileExtension*`  <br/>`"https://autodiscover." + domain + "/autodiscover/autodiscover" +  *fileExtension*`<br/><br/>  Значение  *fileExtension*  зависит от используемого метода автообнаружения, [SOAP](http://msdn.microsoft.com/library/61c21ea9-7fea-4f56-8ada-bf80e1e6b074%28Office.15%29.aspx) или [POX](http://msdn.microsoft.com/library/877152f0-f4b1-4f63-b2ce-924f4bdf2d20%28Office.15%29.aspx). Служба SOAP использует расширение файлов SVC, а POX использует XML.  <br/> |
   
На следующем рисунке показано, как создать список конечных точек автообнаружения.
  
**Рисунок 2. Процесс создания списка конечных точек автообнаружения**

![Иллюстрация процесса создания списка конечных точек для автообнаружения. Стрелки показывают, что список конечных точек образован после поиска SCP или на основе адреса электронной почты пользователя.](media/Ex15_Autodiscover_Overview_Phase1.png)
  
### <a name="phase-2-trying-each-candidate"></a>Этап 2. Проверка кандидатов
<a name="bk_Phase2"> </a>

После создания упорядоченного списка потенциальных кандидатов следует проверить каждого из них, [отправив запрос на URL-адрес](how-to-get-user-settings-from-exchange-by-using-autodiscover.md) и проверив результаты, как показано на рисунке 3. Когда вы получите успешный ответ, все готово! 
  
**Рисунок 3. Проверка кандидатов на конечные точки по порядку**

![Рисунок, показывающий сервер, проходящий по каждой конечной точке в порядке приоритета до получения успешного ответа.](media/Ex15_Autodiscover_Overview_Phase2.png)
  
Прежде чем отправлять запрос кандидату, убедитесь в его надежности. Помните, что вы отправляете учетные данные пользователя, поэтому важно убедиться, что вы сообщаете их только надежным серверам. Как минимум, следует убедиться:
  
- что конечная точка является конечной точкой HTTPS. Клиентские приложения не должны проходить проверку подлинности или отправлять данные конечным точкам без SSL;
    
- что сертификат SSL, предоставленный сервером, действителен и поступил из надежного центра.
    
> [!NOTE]
> [!Примечание] Это лишь базовые рекомендации по безопасности. Работая с проверкой подлинности, убедитесь, что ваш код соответствует требованиям к безопасности в вашей организации. 
  
Тип отправляемого запроса зависит от того, как вы получаете доступ к службе автообнаружения.
  
**Таблица 2. Типы запросов автообнаружения**

|**Используемый метод**|**Средство для отправки запроса**|
|:-----|:-----|
|Управляемый API EWS  <br/> |Метод [GetUserSettings](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.autodiscover.autodiscoverservice.getusersettings%28v=exchg.80%29.aspx).  <br/> |
|Служба автообнаружения SOAP  <br/> |Операция [GetUserSettings](http://msdn.microsoft.com/library/758d965c-ef63-4de4-9120-e293abf14ff8%28Office.15%29.aspx).  <br/> |
|Служба автообнаружения POX  <br/> |Запрос HTTP POST с [текстом запроса автообнаружения](http://msdn.microsoft.com/library/75671b1d-f35b-497b-8d8c-706f3f2535fd%28Office.15%29.aspx).  <br/> |
   
### <a name="phase-3-trying-other-alternatives"></a>Этап 3. Проверка других альтернатив
<a name="bk_Phase3"> </a>

В некоторых случаях вы можете проверить все конечные точки в списке, и все они возвращают ошибку. Прежде чем сдаваться, вы можете попробовать еще несколько способов: отправить запрос GET без проверки подлинности или запросить у DNS запись SRV. Если эти попытки не принесли результатов, то подключиться к службе автообнаружения невозможно.
  
**Рисунок 4. Проверка других альтернатив**

![Рисунок, на котором показаны дополнительные конечные точки, созданные после запроса GET без проверки подлинности и запроса DNS.](media/Ex15_Autodiscover_Overview_Phase3.png)
  
#### <a name="sending-an-unauthenticated-get-request"></a>Отправка запроса GET без проверки подлинности

Для начала следует попробовать отправить запрос GET без проверки подлинности конечной точке, полученной из адреса электронной почты пользователя. Эта конечная точка имеет формат "http://autodiscover." + домен + "/autodiscover/autodiscover.xml". Обратите внимание, что это НЕ конечная точка SSL. Если сервер возвращает ответ об ошибке перенаправления 302, вы можете попробовать [повторно отправить запрос автообнаружения](handling-autodiscover-error-messages.md#bk_ResendRequest) на URL-адрес конечной точки в заголовке Location ответа. 
  
#### <a name="querying-dns-for-an-srv-record"></a>Запрос к DNS на запись SRV

Если запрос GET без проверки подлинности не принес результатов, вы можете попробовать запросить у DNS запись SRV для службы автообнаружения. Запись будет иметь вид "_autodiscover._tcp." + домен. Этот запрос может вернуть несколько записей, но следует использовать только те записи, которые указывают на конечную точку SSL, а также имеют самые высокие приоритет и вес.
  
## <a name="options-for-using-autodiscover"></a>Варианты использования автообнаружения
<a name="bk_Options"> </a>

Вы можете получить доступ к службе автообнаружения с помощью веб-службы SOAP или POX. Выбор метода зависит от ваших требований и среды. Тем не менее, мы рекомендуем по возможности использовать веб-службу SOAP. Кроме того, можно использовать управляемый API EWS. Он реализует часть клиента в службах автообнаружения SOAP и POX.
  
**Таблица 3: Варианты доступа к службе автообнаружения**

|**Вариант**|**Преимущества**|**Недостатки**|
|:-----|:-----|:-----|
|[Управляемый API EWS](get-started-with-ews-managed-api-client-applications.md) <br/> | Реализует процесс автообнаружения.<br/><br/>Использует службы автообнаружения SOAP и POX.<br/><br/>Работает с Exchange Online, Exchange Online в составе Office 365 и всеми версиями Exchange, начиная с Exchange 2007 с пакетом обновления 1 (SP1).<br/><br/>Простой в использовании.  <br/> | Ограничен параметрами пользователей, доступными в перечислении [Microsoft.Exchange.WebServices.Autodiscover.UserSettingName](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.autodiscover.usersettingname%28v=EXCHG.80%29.aspx).<br/><br/>Доступен только для приложений .NET Framework.  <br/> |
|[Служба автообнаружения SOAP](http://msdn.microsoft.com/library/61c21ea9-7fea-4f56-8ada-bf80e1e6b074%28Office.15%29.aspx) <br/> | Не зависит от платформы.<br/><br/>Позволяет запрашивать только интересующие вас параметры.  <br/> | Недоступна в Exchange 2007.  <br/> |
|[Служба автообнаружения POX](http://msdn.microsoft.com/library/877152f0-f4b1-4f63-b2ce-924f4bdf2d20%28Office.15%29.aspx) <br/> | Не зависит от платформы.<br/><br/>Поддерживается в Exchange Online и всех версиях Exchange, начиная с Exchange 2007 с пакетом обновления (SP1).  <br/> | Не позволяет запрашивать конкретные параметры.  <br/> |
   
## <a name="in-this-section"></a>В этом разделе

- [Найдите конечных точек службы автообнаружения с помощью поиска SCP в Exchange](how-to-find-autodiscover-endpoints-by-using-scp-lookup-in-exchange.md)
    
- [Создать список конечных точек службы автообнаружения](how-to-generate-a-list-of-autodiscover-endpoints.md)
    
- [Использование службы автообнаружения для поиска точек подключения](how-to-use-autodiscover-to-find-connection-points.md)
    
- [Получить параметры пользователя из Exchange с помощью службы автообнаружения](how-to-get-user-settings-from-exchange-by-using-autodiscover.md)
    
- [Получение параметров домена с сервера Exchange](how-to-get-domain-settings-from-an-exchange-server.md)
    
- [Обновление сведений о конфигурации с помощью службы автообнаружения](how-to-refresh-configuration-information-by-using-autodiscover.md)
    
- [Обработка сообщений об ошибках службы автообнаружения](handling-autodiscover-error-messages.md)
    
- [Повышение производительности при использовании автообнаружения для Exchange](improving-performance-when-using-autodiscover-for-exchange.md)
    
## <a name="see-also"></a>См. также

- [Начать работу с использованием веб-служб Exchange](start-using-web-services-in-exchange.md)    
- [Exchange 2013: получение параметров пользователей с помощью автообнаружения](http://code.msdn.microsoft.com/Exchange-2013-Get-user-7e22c86e)
- [Пример проверки автообнаружения](http://code.msdn.microsoft.com/exchange/Autodiscover-Checker-e1ebca42)  
- [Разработка клиентов веб-служб для Exchange](develop-web-service-clients-for-exchange.md)
    

