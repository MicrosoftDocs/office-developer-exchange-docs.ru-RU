---
title: EWS регулирование в Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: b4fff4c9-c625-4d2a-9d14-bb28a5da5baf
description: Узнайте о политиках регулирования, влияющих на EWS при использовании Exchange.
ms.openlocfilehash: 64393c173a6fc60cd4be969e8c7457d5b0109713
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2018
ms.locfileid: "21354017"
---
# <a name="ews-throttling-in-exchange"></a><span data-ttu-id="0b73b-103">EWS регулирование в Exchange</span><span class="sxs-lookup"><span data-stu-id="0b73b-103">EWS throttling in Exchange</span></span>

<span data-ttu-id="0b73b-104">Узнайте о политиках регулирования, влияющих на EWS при использовании Exchange.</span><span class="sxs-lookup"><span data-stu-id="0b73b-104">Learn about the throttling policies that affect EWS when you are using Exchange.</span></span>
  
<span data-ttu-id="0b73b-105">**Предоставлено:** Glen масштабируется; Выступление Майкла Main, корпорация Майкрософт</span><span class="sxs-lookup"><span data-stu-id="0b73b-105">**Provided by:** Glen Scales; Michael Mainer, Microsoft Corporation</span></span> 
  
<span data-ttu-id="0b73b-106">В этой статье представлены сведения о регулировании EWS в Exchange Online, Exchange Online в составе Office 365 и локальных версиях Exchange, начиная с Exchange 2010.</span><span class="sxs-lookup"><span data-stu-id="0b73b-106">The article provides information about EWS throttling in Exchange Online, Exchange Online as part of Office 365, and on-premises versions of Exchange starting with Exchange 2010.</span></span> <span data-ttu-id="0b73b-107">Регулирование в Exchange способствует обеспечению надежности и бесперебойной работы сервера за счет ограничения объема ресурсов сервера, которые может использовать один пользователь или приложение.</span><span class="sxs-lookup"><span data-stu-id="0b73b-107">Throttling in Exchange helps to ensure server reliability and uptime by limiting the amount of server resources that a single user or application can consume.</span></span> <span data-ttu-id="0b73b-108">Регулирование — это реактивный ответ на чрезмерное количество системных ресурсов, которые могут повлиять на надежность и функциональность службы.</span><span class="sxs-lookup"><span data-stu-id="0b73b-108">Throttling is a reactive response to overuse of system resources that may affect service reliability and functionality.</span></span> <span data-ttu-id="0b73b-109">Exchange постоянно отслеживает работоспособность критически важных ресурсов инфраструктуры, таких как базы данных почтовых ящиков.</span><span class="sxs-lookup"><span data-stu-id="0b73b-109">Exchange constantly monitors the health of critical infrastructure resources, such as mailbox databases.</span></span> <span data-ttu-id="0b73b-110">Когда обнаруживаются высокие факторы нагрузки, которые приводят к снижению производительности этих ресурсов, подключения EWS регулируется пропорционально в соответствии с количеством, которое каждый вызывающий абонент создал в условиях высокой нагрузки.</span><span class="sxs-lookup"><span data-stu-id="0b73b-110">When high load factors are detected that degrade the performance of these resources, EWS connections are throttled proportionally based on the amount that each caller has contributed to this high load condition.</span></span> <span data-ttu-id="0b73b-111">В результате пользователь может находиться в пределах пределов регулирования и замедления, пока работоспособность ресурса не станет работоспособной.</span><span class="sxs-lookup"><span data-stu-id="0b73b-111">The result is that a user may be within their throttling limit and still experience slowdowns until the health of the resource is back to operational levels.</span></span>
  
<span data-ttu-id="0b73b-112">Каждый протокол клиентского доступа в Exchange, в том числе EWS, имеет политику регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-112">Each client access protocol in Exchange, including EWS, has a throttling policy.</span></span> <span data-ttu-id="0b73b-113">При проектировании приложений, использующих EWS, важно учитывать политики регулирования, чтобы обеспечить надежность приложения и работоспособность сервера Exchange.</span><span class="sxs-lookup"><span data-stu-id="0b73b-113">When you design applications that use EWS, it is important to account for throttling policies, to help ensure application reliability and the health of your Exchange server.</span></span> <span data-ttu-id="0b73b-114">В этой статье определяются различные политики регулирования и ограничения для служб EWS, независимо от того, где вы нацелены на Exchange Online или версии локального Exchange, начиная с Exchange Server 2010.</span><span class="sxs-lookup"><span data-stu-id="0b73b-114">This article identifies the different throttling policies and service limits for EWS, whether you are targeting Exchange Online or versions of Exchange on-premises starting with Exchange Server 2010.</span></span> <span data-ttu-id="0b73b-115">Кроме того, в этой статье также определяются различия в политиках регулирования в различных версиях Exchange.</span><span class="sxs-lookup"><span data-stu-id="0b73b-115">As applicable, this article also identifies differences in throttling policies in different versions of Exchange.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="0b73b-116">Политика регулирования по умолчанию, доступ к политике регулирования и настройке политики регулирования различаются между Exchange Online и локальной системой Exchange.</span><span class="sxs-lookup"><span data-stu-id="0b73b-116">Default throttling policy, access to throttling policy, and throttling policy configuration differs between Exchange Online and Exchange on-premises.</span></span> <span data-ttu-id="0b73b-117">Конкретные значения параметров регулирования точны только для конкретной версии Exchange.</span><span class="sxs-lookup"><span data-stu-id="0b73b-117">Specific throttling setting values are only accurate for a specific version of Exchange.</span></span> <span data-ttu-id="0b73b-118">Так как значения параметров меняются в разных версиях, и так как администраторы Exchange могут изменять политики регулирования по умолчанию для локальных развертываний, в этой статье не предоставляются значения параметров по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0b73b-118">Because setting values vary across versions, and because Exchange administrators can change the default throttling policies for on-premises deployments, this article does not provide the default setting values.</span></span> <span data-ttu-id="0b73b-119">Более важно знать о том, что следует учитывать при проектировании приложения, которое работает с ограничениями на регулирование, и соответствующим образом реагирует на сценарии регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-119">It is more important for you to be aware of the considerations for designing an application that functions within throttling limits and reacts appropriately to throttling scenarios.</span></span> 
  
<span data-ttu-id="0b73b-120">Если вы разработчик приложения, то вам необходимо проложить регулирование структуры приложения.</span><span class="sxs-lookup"><span data-stu-id="0b73b-120">If you are an application developer, you need to factor throttling into your application design.</span></span> <span data-ttu-id="0b73b-121">Разные версии Exchange имеют разные значения по умолчанию для параметров регулирования EWS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-121">Different versions of Exchange have different default values for the EWS throttling parameters.</span></span> <span data-ttu-id="0b73b-122">Клиентские приложения и приложения-службы, предназначенные для доступа к разным версиям Exchange, должны учитывать эти параметры, будь это значения по умолчанию, настраиваемые значения, заданные администратором Exchange или устанавливаемые по умолчанию и не обнаруживаемые для Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="0b73b-122">Client and service applications that are designed to access different versions of Exchange will need to account for these settings, whether they be default values, custom values set by an Exchange administrator, or, as for Exchange Online, set by default and not discoverable.</span></span> <span data-ttu-id="0b73b-123">Так как значения параметров регулирования невозможно обнаружить программным образом, спецификации клиентского проекта должны включать в себя план для адаптации приложения к различным потенциальным ограничениям регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-123">Because throttling parameter values cannot be discovered programmatically, your client design specifications should include a plan for the application to adapt to different potential throttling limits.</span></span> <span data-ttu-id="0b73b-124">При разработке многопоточных приложений, которые будут получать доступ к большому количеству почтовых ящиков, или когда многие клиенты обращаются к одному и тому же почтовому ящику, учитывайте предельные значения, которые политика по умолчанию применяет к Exchange.</span><span class="sxs-lookup"><span data-stu-id="0b73b-124">When you design multithreaded applications that will access a large number of mailboxes, or when many clients are accessing the same mailbox, consider the limits on concurrency that the default policy applies to Exchange.</span></span> 
  
## <a name="throttling-policies-that-affect-ews"></a><span data-ttu-id="0b73b-125">Политики регулирования, влияющие на EWS</span><span class="sxs-lookup"><span data-stu-id="0b73b-125">Throttling policies that affect EWS</span></span>
<span data-ttu-id="0b73b-126"><a name="bk_PolicyParameters"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-126"><a name="bk_PolicyParameters"> </a></span></span>

<span data-ttu-id="0b73b-127">Политики регулирования в Exchange влияют не только на EWS, но и все клиентские подключения к серверу Exchange, в том числе протоколы, используемые Office Outlook, Outlook Web App и Exchange ActiveSync.</span><span class="sxs-lookup"><span data-stu-id="0b73b-127">The throttling polices in Exchange affect not only EWS, but also all client connections to the Exchange server, including the protocols used by Office Outlook, Outlook Web App, and Exchange ActiveSync.</span></span> 
  
<span data-ttu-id="0b73b-128">Политика регулирования **кпустартперцент** может повлиять на производительность EWS при работе с Exchange 2010.</span><span class="sxs-lookup"><span data-stu-id="0b73b-128">The **CPUStartPercent** throttling policy can affect EWS performance when you are running Exchange 2010.</span></span> <span data-ttu-id="0b73b-129">Когда средняя загрузка ЦП процессами Exchange, выполняемыми на сервере клиентского доступа, в том числе и не ограничена процессом EWS, превышает значение, заданное этой политикой, входящие запросы задерживаются, чтобы уменьшить загрузку ЦП.</span><span class="sxs-lookup"><span data-stu-id="0b73b-129">When the average CPU utilization of Exchange processes running on the Client Access server — including, but not limited to, the EWS process — exceeds the value specified by this policy, inbound requests will be delayed to reduce CPU utilization.</span></span> <span data-ttu-id="0b73b-130">Вы не можете изменить значение этой политики, но зная об этом, можно решить проблемы с производительностью.</span><span class="sxs-lookup"><span data-stu-id="0b73b-130">You cannot change the value of this policy, but knowing about it can help you troubleshoot performance issues.</span></span> <span data-ttu-id="0b73b-131">Логика выборки, которую выполняет сервер клиентского доступа. это значение является средним в 10-секундном пошаговом окне.</span><span class="sxs-lookup"><span data-stu-id="0b73b-131">The sampling logic the Client Access server performs for this value is an average over a 10 second rolling window.</span></span> <span data-ttu-id="0b73b-132">Это позволяет процессу правильно реагировать на быстрые пиковые нагрузки при использовании ЦП.</span><span class="sxs-lookup"><span data-stu-id="0b73b-132">This allows the process to respond appropriately to quick spikes in CPU utilization.</span></span> <span data-ttu-id="0b73b-133">При превышении этого порога исходящих подключений к EWS задерживается.</span><span class="sxs-lookup"><span data-stu-id="0b73b-133">When this threshold is exceeded, inbound connections to EWS are delayed.</span></span> <span data-ttu-id="0b73b-134">Эта задержка ограничена в 500 миллисекунд (МС) при теоретическом объеме 100% использования ЦП на запрос EWS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-134">This delay is capped at 500 milliseconds (msecs) at a theoretical 100% CPU usage per EWS request.</span></span> <span data-ttu-id="0b73b-135">Если пакетный запрос EWS для получения 100 элементов передается, сервер проверит загрузку ЦП 100 раз (один раз для каждого элемента) в течение максимальной задержки в 50 секунд.</span><span class="sxs-lookup"><span data-stu-id="0b73b-135">If a batch EWS request to get 100 items is passed, the server will check the CPU usage 100 times (once per item) for a maximum delay of 50 seconds.</span></span> <span data-ttu-id="0b73b-136">Время задержки линейно пропорционально использованию ЦП.</span><span class="sxs-lookup"><span data-stu-id="0b73b-136">The delay time is linearly proportional to CPU usage.</span></span> <span data-ttu-id="0b73b-137">По адресу **кпустартперцент**задержка составляет 0 (поток получается) и увеличивается в линейном до 500 мс при 100% использования ЦП.</span><span class="sxs-lookup"><span data-stu-id="0b73b-137">At **CPUStartPercent**, the delay is 0 (a thread yield) and it increases linearly up to 500 msec at 100% CPU usage.</span></span> <span data-ttu-id="0b73b-138">Так как политики регулирования применяются ко всем пользователям Exchange, маловероятно, что использование ЦП превысит ограничение **кпустартперцент** на сервере клиентского доступа Exchange, так как отдельные пользователи или приложения не могут получить достаточный уровень использования ЦП, чтобы повлиять на работу сервера.</span><span class="sxs-lookup"><span data-stu-id="0b73b-138">Because throttling policies apply to all Exchange users, it's unlikely that CPU usage would exceed the **CPUStartPercent** limit on an Exchange Client Access server, because individual users or applications cannot gain enough CPU utilization to affect server operation.</span></span> 
  
<span data-ttu-id="0b73b-139">В следующей таблице перечислены параметры политики регулирования, которые влияют на приложения, использующие EWS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-139">The following table lists the throttling policy parameters that affect applications that use EWS.</span></span>
  
<span data-ttu-id="0b73b-140">**Таблица 1: параметры политики регулирования, влияющие на EWS**</span><span class="sxs-lookup"><span data-stu-id="0b73b-140">**Table 1: Throttling policy parameters that affect EWS**</span></span>

|<span data-ttu-id="0b73b-141">**Имя параметра политики регулирования**</span><span class="sxs-lookup"><span data-stu-id="0b73b-141">**Throttling policy parameter name**</span></span>|<span data-ttu-id="0b73b-142">**Относится к**</span><span class="sxs-lookup"><span data-stu-id="0b73b-142">**Applies to**</span></span>|<span data-ttu-id="0b73b-143">**Описание**</span><span class="sxs-lookup"><span data-stu-id="0b73b-143">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="0b73b-144">**DiscoveryMaxConcurrency**</span><span class="sxs-lookup"><span data-stu-id="0b73b-144">**DiscoveryMaxConcurrency**</span></span> <br/> |<span data-ttu-id="0b73b-145">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-145">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-146">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-146">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-147">Указывает количество одновременных подключений поиска, которые пользователь может иметь в одно и то же время.</span><span class="sxs-lookup"><span data-stu-id="0b73b-147">Specifies the number of concurrent discovery search connections that a user can have at the same time.</span></span>  <br/> |
|<span data-ttu-id="0b73b-148">**дисковеримакскэйвордс**</span><span class="sxs-lookup"><span data-stu-id="0b73b-148">**DiscoveryMaxKeywords**</span></span> <br/> |<span data-ttu-id="0b73b-149">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-149">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-150">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-150">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-151">Задает максимальное количество ключевых слов, которые пользователь может включить в поиск при обнаружении.</span><span class="sxs-lookup"><span data-stu-id="0b73b-151">Specifies the maximum number of keywords that a user can include in a discovery search.</span></span>  <br/> |
|<span data-ttu-id="0b73b-152">**DiscoveryMaxKeywordsPerPage**</span><span class="sxs-lookup"><span data-stu-id="0b73b-152">**DiscoveryMaxKeywordsPerPage**</span></span> <br/> |<span data-ttu-id="0b73b-153">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-153">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-154">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-154">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-155">Задает число ключевых слов, для которых отображается статистика.</span><span class="sxs-lookup"><span data-stu-id="0b73b-155">Specifies the number of keywords for which to show statistics.</span></span>  <br/> |
|<span data-ttu-id="0b73b-156">**дисковеримаксмаилбоксес**</span><span class="sxs-lookup"><span data-stu-id="0b73b-156">**DiscoveryMaxMailboxes**</span></span> <br/> |<span data-ttu-id="0b73b-157">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-157">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-158">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-158">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-159">Указывает максимальное количество исходных почтовых ящиков, которые пользователь может включить в поиск при обнаружении.</span><span class="sxs-lookup"><span data-stu-id="0b73b-159">Specifies the maximum number of source mailboxes that a user can include in a discovery search.</span></span>  <br/> |
|<span data-ttu-id="0b73b-160">**дисковеримаксмаилбоксесресултсонли**</span><span class="sxs-lookup"><span data-stu-id="0b73b-160">**DiscoveryMaxMailboxesResultsOnly**</span></span> <br/> |<span data-ttu-id="0b73b-161">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-161">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-162">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-162">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-163">Указывает максимальное количество почтовых ящиков, которые можно искать в поиске с обнаружением электронных данных на месте без возможности просмотра статистики.</span><span class="sxs-lookup"><span data-stu-id="0b73b-163">Specifies the maximum number of mailboxes you can search in an In-Place eDiscovery search without being able to view the statistics.</span></span>  <br/> |
|<span data-ttu-id="0b73b-164">**дисковерипревиевсеарчресултспажесизе**</span><span class="sxs-lookup"><span data-stu-id="0b73b-164">**DiscoveryPreviewSearchResultsPageSize**</span></span> <br/> |<span data-ttu-id="0b73b-165">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-165">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-166">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-166">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-167">Указывает количество сообщений, возвращенных при отклике на предварительный просмотр поиска eDiscovery.</span><span class="sxs-lookup"><span data-stu-id="0b73b-167">Specifies the number of messages returned in a eDiscovery search preview response.</span></span>  <br/> |
|<span data-ttu-id="0b73b-168">**EwsCutoffBalance**</span><span class="sxs-lookup"><span data-stu-id="0b73b-168">**EwsCutoffBalance**</span></span> <br/> |<span data-ttu-id="0b73b-169">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-169">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-170">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-170">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-171">Определяет пределы потребления ресурсов для пользователя EWS, прежде чем он будет полностью заблокирован для выполнения операций с определенным компонентом.</span><span class="sxs-lookup"><span data-stu-id="0b73b-171">Defines the resource consumption limits for EWS user before that user is completely blocked from performing operations on a specific component.</span></span>  <br/> |
|<span data-ttu-id="0b73b-172">**евсмаксбурст**</span><span class="sxs-lookup"><span data-stu-id="0b73b-172">**EwsMaxBurst**</span></span> <br/> |<span data-ttu-id="0b73b-173">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-173">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-174">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-174">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-175">Определяет период времени, в течение которого пользователь EWS может использовать повышенный объем ресурсов перед регулированием.</span><span class="sxs-lookup"><span data-stu-id="0b73b-175">Defines the amount of time that an EWS user can consume an elevated amount of resources before being throttled.</span></span> <span data-ttu-id="0b73b-176">Значение измеряется в миллисекундах.</span><span class="sxs-lookup"><span data-stu-id="0b73b-176">This is measured in milliseconds.</span></span> <span data-ttu-id="0b73b-177">Это значение устанавливается отдельно для каждого компонента.</span><span class="sxs-lookup"><span data-stu-id="0b73b-177">This value is set separately for each component.</span></span>  <br/> |
|<span data-ttu-id="0b73b-178">**EwsRechargeRate**</span><span class="sxs-lookup"><span data-stu-id="0b73b-178">**EwsRechargeRate**</span></span> <br/> |<span data-ttu-id="0b73b-179">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-179">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-180">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-180">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-181">Определяет частоту, с которой бюджет пользователя EWS обновляется (бюджет увеличивается на) во время бюджетного времени.</span><span class="sxs-lookup"><span data-stu-id="0b73b-181">Defines the rate at which an EWS user's budget is recharged (budget grows by) during the budget time.</span></span>  <br/> |
|<span data-ttu-id="0b73b-182">**евсмакссубскриптионс**</span><span class="sxs-lookup"><span data-stu-id="0b73b-182">**EWSMaxSubscriptions**</span></span> <br/> |<span data-ttu-id="0b73b-183">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-183">Exchange 2010</span></span>  <br/> <span data-ttu-id="0b73b-184">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-184">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-185">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-185">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-186">Определяет максимальное количество активных подписок на уведомление о принудительной отправке, опрашивающей и потоковой передачи, которое пользователь может иметь на определенном сервере клиентского доступа одновременно.</span><span class="sxs-lookup"><span data-stu-id="0b73b-186">Defines the maximum number of active push, pull, and streaming notification subscriptions that a user can have on a specific Client Access server at one time.</span></span> <span data-ttu-id="0b73b-187">Для разных версий Exchange это изменяется в бюджете.</span><span class="sxs-lookup"><span data-stu-id="0b73b-187">This is budgeted differently for different Exchange versions.</span></span>  <br/> |
|<span data-ttu-id="0b73b-188">**евсфастсеарчтимеаутинсекондс**</span><span class="sxs-lookup"><span data-stu-id="0b73b-188">**EWSFastSearchTimeoutInSeconds**</span></span> <br/> |<span data-ttu-id="0b73b-189">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-189">Exchange 2010</span></span>  <br/> |<span data-ttu-id="0b73b-190">Определяет период времени в секундах, в течение которого операции быстрого поиска выполняются с помощью службы поиска Exchange в EWS до истечения времени ожидания. Быстрый поиск — это поиск, выполненный с использованием строки запроса расширенного синтаксиса запросов (AQS) в [операции FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="0b73b-190">Defines the amount of time in seconds that fast searches made by using Exchange Search in EWS continue before they time out. Fast searches are searches made by using an Advanced Query Syntax (AQS) query string in a [FindItem operation](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx).</span></span>  <br/> |
|<span data-ttu-id="0b73b-191">**евсфиндкаунтлимит**</span><span class="sxs-lookup"><span data-stu-id="0b73b-191">**EWSFindCountLimit**</span></span> <br/> |<span data-ttu-id="0b73b-192">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-192">Exchange 2010</span></span>  <br/> <span data-ttu-id="0b73b-193">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-193">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-194">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-194">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-195">Определяет максимальное количество элементов из [операции FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) или [операции FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) , которые могут существовать в памяти на сервере клиентского доступа одновременно для одного пользователя.</span><span class="sxs-lookup"><span data-stu-id="0b73b-195">Defines the maximum number of items from a [FindItem operation](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) or [FindFolder operation](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) that can exist in memory on the Client Access server at one time for one user.</span></span> <span data-ttu-id="0b73b-196">Значение по умолчанию для этого свойства — 1000.</span><span class="sxs-lookup"><span data-stu-id="0b73b-196">The default value for this property is 1000.</span></span> <span data-ttu-id="0b73b-197">[Резервное значение](http://technet.microsoft.com/en-us/library/dd297964%28v=exchg.141%29.aspx#fallback)для этого параметра — 1000.</span><span class="sxs-lookup"><span data-stu-id="0b73b-197">The [fallback value](http://technet.microsoft.com/en-us/library/dd297964%28v=exchg.141%29.aspx#fallback)for this value is 1000.</span></span>  <br/> <span data-ttu-id="0b73b-198">В Exchange Online и локальной версии Exchange, начиная с Exchange 2013, эта политика регулирования не может запрашивать или настраиваться командлетом.</span><span class="sxs-lookup"><span data-stu-id="0b73b-198">In Exchange Online and on-premises versions of Exchange starting with Exchange 2013, this throttling policy cannot be queried or configured by a cmdlet.</span></span> <span data-ttu-id="0b73b-199">В Exchange Online и локальной версии Exchange, начиная с Exchange 2013, Евсфиндкаунтлимит для [поиска AQS](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md) и любых поисковых систем Exchange с ограничением — 250 результаты.</span><span class="sxs-lookup"><span data-stu-id="0b73b-199">In Exchange Online and on-premises versions of Exchange starting with Exchange 2013, the EWSFindCountLimit for [AQS search](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md) and any Exchange search with a restriction is 250 results.</span></span> <span data-ttu-id="0b73b-200">Поиск в Exchange без ограничения возвратит до 1000 результатов.</span><span class="sxs-lookup"><span data-stu-id="0b73b-200">An Exchange search without a restriction will return up to 1000 results.</span></span>  <br/> |
|<span data-ttu-id="0b73b-201">**евсперценттимеинад**</span><span class="sxs-lookup"><span data-stu-id="0b73b-201">**EWSPercentTimeInAD**</span></span> <br/> |<span data-ttu-id="0b73b-202">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-202">Exchange 2010</span></span>  <br/> |<span data-ttu-id="0b73b-203">Определяет процент времени в минуту, в течение которого определенный пользователь может выполнять запросы Active Directory.</span><span class="sxs-lookup"><span data-stu-id="0b73b-203">Defines the percentage of time per minute during which a specific user can execute Active Directory requests.</span></span>  <br/> |
|<span data-ttu-id="0b73b-204">**EWSPercentTimeInCAS**</span><span class="sxs-lookup"><span data-stu-id="0b73b-204">**EWSPercentTimeInCAS**</span></span> <br/> |<span data-ttu-id="0b73b-205">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-205">Exchange 2010</span></span>  <br/> |<span data-ttu-id="0b73b-206">Определяет процент времени в минуту, в течение которого определенный пользователь может выполнять серверный код клиентского доступа.</span><span class="sxs-lookup"><span data-stu-id="0b73b-206">Defines the percentage of time per minute during which a specific user can execute Client Access server code.</span></span>  <br/> |
|<span data-ttu-id="0b73b-207">**евсперценттимеинмаилбоксрпк**</span><span class="sxs-lookup"><span data-stu-id="0b73b-207">**EWSPercentTimeInMailboxRPC**</span></span> <br/> |<span data-ttu-id="0b73b-208">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-208">Exchange 2010</span></span>  <br/> |<span data-ttu-id="0b73b-209">Определяет процент времени в минуту, в течение которого определенный пользователь может выполнять запросы RPC для почтового ящика</span><span class="sxs-lookup"><span data-stu-id="0b73b-209">Defines the percentage of time per minute during which a specific user can execute mailbox RPC requests</span></span>  <br/> |
|<span data-ttu-id="0b73b-210">**евсмаксконкурренци**</span><span class="sxs-lookup"><span data-stu-id="0b73b-210">**EWSMaxConcurrency**</span></span> <br/> |<span data-ttu-id="0b73b-211">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-211">Exchange 2010</span></span>  <br/> <span data-ttu-id="0b73b-212">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-212">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-213">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-213">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-214">Определяет количество параллельно открытых подключений, которые может иметь определенный пользователь, на сервере Exchange, который использует EWS одновременно.</span><span class="sxs-lookup"><span data-stu-id="0b73b-214">Defines the number of concurrent open connections that a specific user can have against an Exchange server that is using EWS at one time.</span></span> <span data-ttu-id="0b73b-215">Значение по умолчанию для Exchange 2010 — 10.</span><span class="sxs-lookup"><span data-stu-id="0b73b-215">The default value for Exchange 2010 is 10.</span></span> <span data-ttu-id="0b73b-216">Значение по умолчанию для Exchange 2013 и Exchange Online — 27.</span><span class="sxs-lookup"><span data-stu-id="0b73b-216">The default value for Exchange 2013 and Exchange Online is 27.</span></span>  <br/> <span data-ttu-id="0b73b-217">Эта политика применяется ко всем операциям, за исключением потоковых уведомлений.</span><span class="sxs-lookup"><span data-stu-id="0b73b-217">This policy applies to all operations except for streaming notifications.</span></span> <span data-ttu-id="0b73b-218">Потоковые уведомления Используйте **хангингконнектионлимит** для указания количества доступных подключений к потоковым событиям.</span><span class="sxs-lookup"><span data-stu-id="0b73b-218">Streaming notifications use the **HangingConnectionLimit** to indicate the number of open streaming event connections that are available.</span></span> <span data-ttu-id="0b73b-219">Для получения дополнительных сведений Узнайте, [какие значения регулирования необходимо учитывать?](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_throttling).</span><span class="sxs-lookup"><span data-stu-id="0b73b-219">For more information, see [What throttling values do I need to take into consideration?](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_throttling).</span></span>  <br/> |
|<span data-ttu-id="0b73b-220">**MessageRateLimit**</span><span class="sxs-lookup"><span data-stu-id="0b73b-220">**MessageRateLimit**</span></span> <br/> |<span data-ttu-id="0b73b-221">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-221">Exchange 2010</span></span>  <br/> <span data-ttu-id="0b73b-222">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-222">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-223">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-223">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-224">Определяет количество сообщений в минуту, которые могут быть отправлены.</span><span class="sxs-lookup"><span data-stu-id="0b73b-224">Defines the number of messages per minute that can be submitted.</span></span>  <br/> |
|<span data-ttu-id="0b73b-225">**RecipientRateLimit**</span><span class="sxs-lookup"><span data-stu-id="0b73b-225">**RecipientRateLimit**</span></span> <br/> |<span data-ttu-id="0b73b-226">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-226">Exchange 2010</span></span>  <br/> <span data-ttu-id="0b73b-227">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-227">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-228">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-228">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-229">Определяет предельное число получателей, которые могут быть отправлены в течение 24 часов.</span><span class="sxs-lookup"><span data-stu-id="0b73b-229">Defines the limit to the number of recipients that a user can address in a 24-hour period.</span></span>  <br/> |
|<span data-ttu-id="0b73b-230">**форвардилимит**</span><span class="sxs-lookup"><span data-stu-id="0b73b-230">**ForwardeeLimit**</span></span> <br/> |<span data-ttu-id="0b73b-231">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-231">Exchange 2010</span></span>  <br/> <span data-ttu-id="0b73b-232">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-232">Exchange 2013</span></span>  <br/> <span data-ttu-id="0b73b-233">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-233">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-234">Определяет максимальное количество получателей для действий переадресации/перенаправления папки "Входящие" в 24-часовом периоде.</span><span class="sxs-lookup"><span data-stu-id="0b73b-234">Defines the limit to the number of recipients for Inbox forward/redirect actions in a 24-hour period.</span></span>  <br/> |
   
> [!CAUTION]
> <span data-ttu-id="0b73b-235">Не следует устанавливать **значение NULL**для политик регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-235">Do not set throttling polices to **null**.</span></span> <span data-ttu-id="0b73b-236">При этом будет задано значение, равное unlimited, что указывает на то, что политика регулирования не задана.</span><span class="sxs-lookup"><span data-stu-id="0b73b-236">This will set the policy to equal unlimited, which indicates that a throttling policy isn't set.</span></span> 
  
## <a name="displaying-the-policies-that-apply-to-exchange-mailboxes"></a><span data-ttu-id="0b73b-237">Отображение политик, которые применяются к почтовым ящикам Exchange</span><span class="sxs-lookup"><span data-stu-id="0b73b-237">Displaying the policies that apply to Exchange mailboxes</span></span>
<span data-ttu-id="0b73b-238"><a name="bk_PolicyCmdlets"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-238"><a name="bk_PolicyCmdlets"> </a></span></span>

<span data-ttu-id="0b73b-239">Локальная служба Exchange предоставляет командлеты командной консоли Exchange, которые можно использовать для настройки и получения политики регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-239">Exchange on-premises provides Exchange Management Shell cmdlets that you can use to set and get throttling policy.</span></span> <span data-ttu-id="0b73b-240">Exchange Online не предоставляет доступ к командлетам политики регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-240">Exchange Online does not provide access to the throttling policy cmdlets.</span></span>
  
<span data-ttu-id="0b73b-241">Для отображения политик регулирования для локального развертывания Exchange Server можно использовать следующие командлеты:</span><span class="sxs-lookup"><span data-stu-id="0b73b-241">You can use the following cmdlets to display throttling polices for an on-premises Exchange Server deployment:</span></span>
  
- <span data-ttu-id="0b73b-242">**Get-ThrottlingPolicy** — получает параметры регулирования клиента для одной или нескольких политик регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-242">**Get-ThrottlingPolicy** — Gets the client throttling settings for one or more throttling policies.</span></span> <span data-ttu-id="0b73b-243">Дополнительные сведения см. в статье [Get – ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd351264.aspx) на сайте TechNet.</span><span class="sxs-lookup"><span data-stu-id="0b73b-243">For more information, see [Get-ThrottlingPolicy ](http://technet.microsoft.com/en-us/library/dd351264.aspx) on TechNet.</span></span> 
    
- <span data-ttu-id="0b73b-244">**Get-ThrottlingPolicyAssociation** — позволяет просматривать отношение между объектом и связанными с ним политиками регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-244">**Get-ThrottlingPolicyAssociation** — Enables you to view the relationship between an object and its associated throttling policies.</span></span> <span data-ttu-id="0b73b-245">Объект может быть пользователем с почтовым ящиком, пользователем без почтового ящика или контактом.</span><span class="sxs-lookup"><span data-stu-id="0b73b-245">The object can be a user with a mailbox, a user without a mailbox, or a contact.</span></span> <span data-ttu-id="0b73b-246">Дополнительные сведения см. в статье [Get – ThrottlingPolicyAssociation](http://technet.microsoft.com/en-us/library/ff459241.aspx) на сайте TechNet.</span><span class="sxs-lookup"><span data-stu-id="0b73b-246">For more information, see [Get-ThrottlingPolicyAssociation](http://technet.microsoft.com/en-us/library/ff459241.aspx) on TechNet.</span></span> 
    
<span data-ttu-id="0b73b-247">Используйте следующую команду, чтобы отобразить политику регулирования по умолчанию для Exchange 2010.</span><span class="sxs-lookup"><span data-stu-id="0b73b-247">Use the following command to show the default throttling policy for Exchange 2010.</span></span>
  
<span data-ttu-id="0b73b-248">**Get – ThrottlingPolicy | Where – Object {$ _. IsDefault — EQ "true"} | Format — List**</span><span class="sxs-lookup"><span data-stu-id="0b73b-248">**Get-ThrottlingPolicy | Where-Object {$_.IsDefault -eq "True"} | format-list**</span></span>
  
<span data-ttu-id="0b73b-249">Используйте следующую команду, чтобы отобразить глобальную политику регулирования (которая соответствует политике регулирования по умолчанию в Exchange 2010) в Exchange 2013.</span><span class="sxs-lookup"><span data-stu-id="0b73b-249">Use the following command to show the global throttling policy (which equates to the default throttling policy in Exchange 2010) in Exchange 2013.</span></span>
  
<span data-ttu-id="0b73b-250">**Get – ThrottlingPolicy | Where – Object {$ _. Сроттлингполицископе — EQ "Global"} | Format — List**</span><span class="sxs-lookup"><span data-stu-id="0b73b-250">**Get-ThrottlingPolicy | Where-Object {$_.ThrottlingPolicyScope -eq "Global"} | format-list**</span></span>
  
<span data-ttu-id="0b73b-251">Используйте следующую команду, чтобы показать политику регулирования, связанную с пользователем в Exchange 2010 или Exchange 2013.</span><span class="sxs-lookup"><span data-stu-id="0b73b-251">Use the following command to show the throttling policy associated with a user in Exchange 2010 or Exchange 2013.</span></span> <span data-ttu-id="0b73b-252">Замените имя пользователя john@contoso.com именем пользователя целевого пользователя, для которого требуется получить сведения о политике регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-252">Replace the user name john@contoso.com with the user name of the target user for whom you want to get throttling policy information.</span></span>
  
<span data-ttu-id="0b73b-253">**Get – ThrottlingPolicyAssociation john@contoso.com | Format — List**</span><span class="sxs-lookup"><span data-stu-id="0b73b-253">**Get-ThrottlingPolicyAssociation john@contoso.com | format-list**</span></span>
  
<span data-ttu-id="0b73b-254">При выполнении этой команды в командной консоли Exchange выводятся результаты, аналогичные приведенным ниже.</span><span class="sxs-lookup"><span data-stu-id="0b73b-254">Running this command in Exchange Management Shell results in an output similar to the following.</span></span>
  
```powershell
PS C:\>Get-ThrottlingPolicyAssociation john@contoso.com
RunspaceId               : 72153d6-9dce-2fae-8dbd-5ca5f760g2df
ObjectId                 : john
ThrottlingPolicyId       :
Name                     : john
Identity                 : FHXB-28178dom.contoso.com/Users/john
IsValid                  : True
NeedsToSuppressPii       : False
ExchangeVersion          : 0.10 (15.0.0.0)
DistinguishedName        : CN=john,CN=Users,DC=FHXB-28178dom,DC=contoso,DC=com
Guid                     : 2c10dab6-de28-1937-ad8g-535832613a08
```

> [!NOTE]
> <span data-ttu-id="0b73b-255">Если свойство **сроттлингполициид** пусто, к почтовому ящику применяется политика по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0b73b-255">When the **ThrottlingPolicyId** property is blank, the default policy is applied to the mailbox.</span></span> 
  
<span data-ttu-id="0b73b-256">Политику регулирования можно настроить на сервере Exchange Server с помощью командлетов [Set — ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd298094.aspx) и [Set ThrottlingPolicyAssociation](http://technet.microsoft.com/en-us/library/ff459231.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0b73b-256">You can set throttling policy on an Exchange server by using the [Set-ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd298094.aspx) and [Set-ThrottlingPolicyAssociation](http://technet.microsoft.com/en-us/library/ff459231.aspx) cmdlets.</span></span> <span data-ttu-id="0b73b-257">Вы можете создавать и удалять политики регулирования, не установленные по умолчанию, с помощью командлетов [New – ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd351045.aspx) и [Remove – ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd351178.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0b73b-257">You can create and remove nondefault throttling policies by using the [New-ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd351045.aspx) and [Remove-ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd351178.aspx) cmdlets.</span></span> 
  
> [!TIP]
> <span data-ttu-id="0b73b-258">Мы рекомендуем разрабатывать приложения так, чтобы они соответствовали политике регулирования по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0b73b-258">We recommend that you design your applications to adhere to the default throttling policy.</span></span> <span data-ttu-id="0b73b-259">Вносить изменения в политики регулирования по умолчанию только в том случае, если проект клиентского приложения не может поддерживать политику по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0b73b-259">Only make changes to default throttling policies if your client application design cannot accommodate the default policy.</span></span> <span data-ttu-id="0b73b-260">Имейте в виду, что менее ограниченные политики регулирования могут негативно повлиять на надежность службы.</span><span class="sxs-lookup"><span data-stu-id="0b73b-260">Be aware that less restrictive throttling policies can negatively affect service reliability.</span></span> 

<span data-ttu-id="0b73b-261"><a name="bk_ThrottlingConsiderations"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-261"><a name="bk_ThrottlingConsiderations"> </a></span></span>

## <a name="throttling-considerations-for-applications-that-use-ews-impersonation"></a><span data-ttu-id="0b73b-262">Вопросы регулирования для приложений, использующих олицетворение EWS</span><span class="sxs-lookup"><span data-stu-id="0b73b-262">Throttling considerations for applications that use EWS impersonation</span></span>


<span data-ttu-id="0b73b-263">[Олицетворение](impersonation-and-ews-in-exchange.md) это способ проверки подлинности, который позволяет одной учетной записи получать доступ к многим учетным записям.</span><span class="sxs-lookup"><span data-stu-id="0b73b-263">[Impersonation](impersonation-and-ews-in-exchange.md) is an authorization method that enables a single account to access many accounts.</span></span> <span data-ttu-id="0b73b-264">Если учетная запись службы олицетворяет пользователей, она выступает в качестве пользователей и, соответственно, принимает права, назначенные этим пользователям.</span><span class="sxs-lookup"><span data-stu-id="0b73b-264">When a service account impersonates users, it acts as the users and therefore assumes the rights that are assigned to those users.</span></span> <span data-ttu-id="0b73b-265">Файлы журналов записывают доступ олицетворенного пользователя.</span><span class="sxs-lookup"><span data-stu-id="0b73b-265">Log files record the access as the impersonated user.</span></span> <span data-ttu-id="0b73b-266">Администраторы используют управление доступом на основе ролей (RBAC) для настройки олицетворения с помощью командной консоли Exchange.</span><span class="sxs-lookup"><span data-stu-id="0b73b-266">Administrators use role-based access control (RBAC) to configure impersonation via the Exchange Management Shell.</span></span> 
  
<span data-ttu-id="0b73b-267">При использовании олицетворения бюджеты для всех порогов регулирования применяются по-разному в зависимости от версии Exchange.</span><span class="sxs-lookup"><span data-stu-id="0b73b-267">When impersonation is used, the budgets for all the throttling thresholds apply differently depending on the version of Exchange.</span></span> <span data-ttu-id="0b73b-268">Бюджет либо рассчитывается с учетной записью, которая является олицетворенной, либо учетной записью службы.</span><span class="sxs-lookup"><span data-stu-id="0b73b-268">The budget is either calculated against the account that is impersonated, or the service account.</span></span> <span data-ttu-id="0b73b-269">Если приложение является многопоточной и делает параллельные запросы к нескольким почтовым ящикам, следует учитывать, как пороговое значение регулирования влияет на производительность приложения.</span><span class="sxs-lookup"><span data-stu-id="0b73b-269">If your application is multithreaded and makes concurrent requests against multiple mailboxes, you should consider how the throttling threshold will affect your application's performance.</span></span> <span data-ttu-id="0b73b-270">Как правило, при создании приложения на основе службы, которое использует олицетворение для доступа ко всем почтовым ящикам, учитывайте следующие условия для учетных записей служб.</span><span class="sxs-lookup"><span data-stu-id="0b73b-270">In general, be aware of the following limits on service accounts when you create a service-based application that uses impersonation to access all mailboxes:</span></span> 
  
- <span data-ttu-id="0b73b-271">При использовании олицетворения учетная запись службы имеет отдельный бюджет для следующих параметров политики:</span><span class="sxs-lookup"><span data-stu-id="0b73b-271">When you use Impersonation, the service account has a separate budget for the following policy parameters:</span></span>
    
  - <span data-ttu-id="0b73b-272">**евсмаксконкурренци**</span><span class="sxs-lookup"><span data-stu-id="0b73b-272">**EWSMaxConcurrency**</span></span>
    
  - <span data-ttu-id="0b73b-273">**евсперценттимеинад**</span><span class="sxs-lookup"><span data-stu-id="0b73b-273">**EWSPercentTimeInAD**</span></span>
    
  - <span data-ttu-id="0b73b-274">**EWSPercentTimeInCAS**</span><span class="sxs-lookup"><span data-stu-id="0b73b-274">**EWSPercentTimeInCAS**</span></span>
    
  - <span data-ttu-id="0b73b-275">**евсперценттимеинмаилбоксрпк**</span><span class="sxs-lookup"><span data-stu-id="0b73b-275">**EWSPercentTimeInMailboxRPC**</span></span>
    
  - <span data-ttu-id="0b73b-276">**евсмакссубскриптионс**</span><span class="sxs-lookup"><span data-stu-id="0b73b-276">**EWSMaxSubscriptions**</span></span>
    
  - <span data-ttu-id="0b73b-277">**евсфастсеарчтимеаутинсекондс**</span><span class="sxs-lookup"><span data-stu-id="0b73b-277">**EWSFastSearchTimeoutInSeconds**</span></span>
    
  - <span data-ttu-id="0b73b-278">**евсфиндкаунтлимит**</span><span class="sxs-lookup"><span data-stu-id="0b73b-278">**EWSFindCountLimit**</span></span>
    
- <span data-ttu-id="0b73b-279">Бюджет **евсмаксконкурренци** является общим для учетной записи службы, а учетная запись, которая олицетворяется для всех подключений к версиям Exchange более ранних, чем Exchange 2010 с пакетом обновления 2 (SP2) накопительный пакет обновления 4 (RU4).</span><span class="sxs-lookup"><span data-stu-id="0b73b-279">The **EWSMaxConcurrency** budget is shared for the service account and the account being impersonated for all connections to versions of Exchange earlier than Exchange 2010 Service Pack 2 (SP2) Update Rollup 4 (RU4).</span></span> <span data-ttu-id="0b73b-280">Начиная с Exchange 2010 с пакетом обновления 2 (SP2) RU4 и включая Exchange Online, доступ к учетной записи службы использует отдельный бюджет от пользователя **евсмаксконкурренци** бюджет.</span><span class="sxs-lookup"><span data-stu-id="0b73b-280">Starting with Exchange 2010 SP2 RU4, and including Exchange Online, the service account access uses a separate budget from the user **EWSMaxConcurrency** budget.</span></span> <span data-ttu-id="0b73b-281">Дополнительные сведения об обновлении политики регулирования одновременных подключений Exchange для EWS приведены в [статье Описание накопительного пакета обновления 4 для Exchange Server 2010 с пакетом обновления 2 (](http://support.microsoft.com/kb/2706690)SP2).</span><span class="sxs-lookup"><span data-stu-id="0b73b-281">For more information about the update to the Exchange concurrent connection throttling policy for EWS, see [Description of Update Rollup 4 for Exchange Server 2010 Service Pack 2](http://support.microsoft.com/kb/2706690).</span></span>
    
    <span data-ttu-id="0b73b-282">Потоковые уведомления EWS в версиях Exchange, начиная с Exchange 2010 и включая Exchange Online, имеют дополнительный клонированный бюджет **евсмаксконкурренци** из всех других клиентских подключений EWS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-282">EWS streaming notifications in versions of Exchange starting with Exchange 2010, and including Exchange Online, have an additional cloned **EWSMaxConcurrency** budget from all other EWS client connections.</span></span> <span data-ttu-id="0b73b-283">Потоковые подключения к уведомлениям пересчитываются в отдельном бюджете, чем все остальные операции EWS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-283">Streaming notification connections are counted against a separate budget than all other EWS operations.</span></span> <span data-ttu-id="0b73b-284">Максимальный бюджет для почтовых потоков фактически является двумя различными бюджетами: один бюджет предназначен для всех учетных записей служб, а один — для олицетворения учетной записи.</span><span class="sxs-lookup"><span data-stu-id="0b73b-284">The streaming notification maximum concurrency budget is actually two different budgets: one budget is for all service accounts, and one budget is for the account being impersonated.</span></span> <span data-ttu-id="0b73b-285">Потоковые уведомления в Exchange Online и версиях Exchange начиная с Exchange 2013 Используйте [хангингконнектионлимит](ews-throttling-in-exchange.md#bk_ThrottlingNotifications) для ограничения числа подключений.</span><span class="sxs-lookup"><span data-stu-id="0b73b-285">Streaming notifications in Exchange Online and versions of Exchange starting with Exchange 2013 use the [HangingConnectionLimit](ews-throttling-in-exchange.md#bk_ThrottlingNotifications) to limit the number of connections.</span></span> 
    
    <span data-ttu-id="0b73b-286">Например, предположим, что **евсмаксконкурренци** равен 5.</span><span class="sxs-lookup"><span data-stu-id="0b73b-286">For example, let's assume that **EWSMaxConcurrency** is equal to five.</span></span> <span data-ttu-id="0b73b-287">У пользователя может быть пять открытых подключений по запросу, в то время как учетная запись службы может иметь пять одновременных подключений опрашивающей отправки к почтовому ящику пользователя одновременно с пользователем.</span><span class="sxs-lookup"><span data-stu-id="0b73b-287">A user can have five open pull notification connections, while an service account can have five concurrent pull notification connections against the user's mailbox at the same time as the user.</span></span> 
    
- <span data-ttu-id="0b73b-288">В следующей таблице показано, как рассчитываются бюджеты регулирования **евсмакссубскриптионс** между учетной записью службы и учетной записью для олицетворения.</span><span class="sxs-lookup"><span data-stu-id="0b73b-288">The following table identifies how **EWSMaxSubscriptions** throttling budgets are calculated between the service account and the account to impersonate.</span></span> 
    
   <span data-ttu-id="0b73b-289">**Таблица 2: бюджетный учет Евсмакссубскриптионс**</span><span class="sxs-lookup"><span data-stu-id="0b73b-289">**Table 2: EWSMaxSubscriptions budget accounting**</span></span>

   |<span data-ttu-id="0b73b-290">**Версия Exchange**</span><span class="sxs-lookup"><span data-stu-id="0b73b-290">**Exchange version**</span></span>|<span data-ttu-id="0b73b-291">**Евсмакссубскриптионс регулирование бюджетного учета**</span><span class="sxs-lookup"><span data-stu-id="0b73b-291">**EWSMaxSubscriptions throttling budget accounting**</span></span>|
   |:-----|:-----|
   |<span data-ttu-id="0b73b-292">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0b73b-292">Exchange Online</span></span>  <br/> |<span data-ttu-id="0b73b-293">Выставление счета для целевого почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="0b73b-293">Charged against the target mailbox.</span></span>  <br/> |
   |<span data-ttu-id="0b73b-294">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="0b73b-294">Exchange 2013</span></span>  <br/> |<span data-ttu-id="0b73b-295">Выставление счета для целевого почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="0b73b-295">Charged against the target mailbox.</span></span>  <br/> |
   |<span data-ttu-id="0b73b-296">Exchange 2010 SP3</span><span class="sxs-lookup"><span data-stu-id="0b73b-296">Exchange 2010 SP3</span></span>  <br/> |<span data-ttu-id="0b73b-297">Выставление счета для целевого почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="0b73b-297">Charged against the target mailbox.</span></span>  <br/> |
   |<span data-ttu-id="0b73b-298">Exchange 2010 с пакетом обновления 2 (SP2)</span><span class="sxs-lookup"><span data-stu-id="0b73b-298">Exchange 2010 SP2</span></span>  <br/> |<span data-ttu-id="0b73b-299">Оплачиваются по учетной записи звонка.</span><span class="sxs-lookup"><span data-stu-id="0b73b-299">Charged against the calling account.</span></span> <span data-ttu-id="0b73b-300">Начиная с Exchange 2010 с пакетом обновления 2 (SP2) RU4, бюджет расставляется в соответствии с целевым почтовым ящиком.</span><span class="sxs-lookup"><span data-stu-id="0b73b-300">Starting with Exchange 2010 SP2 RU4, the budget is charged against the target mailbox.</span></span>  <br/> |
   |<span data-ttu-id="0b73b-301">Exchange 2010 с пакетом обновления 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="0b73b-301">Exchange 2010 SP1</span></span>  <br/> |<span data-ttu-id="0b73b-302">Оплачиваются по учетной записи звонка.</span><span class="sxs-lookup"><span data-stu-id="0b73b-302">Charged against the calling account.</span></span>  <br/> |
   |<span data-ttu-id="0b73b-303">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="0b73b-303">Exchange 2010</span></span>  <br/> |<span data-ttu-id="0b73b-304">Оплачиваются по учетной записи звонка.</span><span class="sxs-lookup"><span data-stu-id="0b73b-304">Charged against the calling account.</span></span>  <br/> |
   
- <span data-ttu-id="0b73b-305">Так как бюджет регулирования **евсмакссубскриптионс** задается для олицетворения учетной записи, ограничение числа почтовых ящиков, на которые может подписаться учетная запись службы и получения потоковых уведомлений, при условии, что используется олицетворение, не ограничено.</span><span class="sxs-lookup"><span data-stu-id="0b73b-305">Because the **EWSMaxSubscriptions** throttling budget is charged against the account being impersonated, there is no limit on the number of mailboxes a service account can subscribe to and receive streaming notifications for, as long as impersonation is being used.</span></span> <span data-ttu-id="0b73b-306">Для олицетворения учетной записи не может быть более _n_ одновременных запросов на один целевой почтовый ящик, где _n_ — значение **евсмакссубскриптионс** .</span><span class="sxs-lookup"><span data-stu-id="0b73b-306">For the account being impersonated, you can't have more than  _n_ concurrent requests per target mailbox, where  _n_ is the **EWSMaxSubscriptions** value.</span></span> <span data-ttu-id="0b73b-307">Если вы не используете олицетворение, то в одной и той же учетной записи службы не может быть больше _n_ групповых одновременных запросов.</span><span class="sxs-lookup"><span data-stu-id="0b73b-307">If you were not using impersonation, the same service account could not have more than  _n_ concurrent requests total.</span></span> <span data-ttu-id="0b73b-308">Таким образом, сделать вывод заключается в том, что использование олицетворения для учетной записи службы позволяет экспоненциально увеличить количество почтовых ящиков, которые можно обслуживать.</span><span class="sxs-lookup"><span data-stu-id="0b73b-308">So, the takeaway is that by using impersonation on a service account, you exponentially increase the number of mailboxes you can service.</span></span> <span data-ttu-id="0b73b-309">Более подробную информацию можно узнать [в статье поддержание сходства между группой подписок и сервером почтовых ящиков в Exchange](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md).</span><span class="sxs-lookup"><span data-stu-id="0b73b-309">For more information, see [Maintain affinity between a group of subscriptions and the Mailbox server in Exchange](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md).</span></span>
    
- <span data-ttu-id="0b73b-310">Параметры политики **евсперценттимеинмаилбоксрпк**, **EWSPercentTimeInCAS**и **евсперценттимеинад** ссылаются на действия, выполняемые одним потоком.</span><span class="sxs-lookup"><span data-stu-id="0b73b-310">The **EWSPercentTimeInMailboxRPC**, **EWSPercentTimeInCAS**, and **EWSPercentTimeInAD** policy parameters refer to actions performed by a single thread.</span></span> <span data-ttu-id="0b73b-311">Если приложение выполняет несколько параллельных операций, следует учитывать совокупный объем этих операций в бюджете ресурсов пользователя.</span><span class="sxs-lookup"><span data-stu-id="0b73b-311">When an application performs multiple concurrent operations, you should account for the cumulative effect of these operations on the user resource budget.</span></span> 
    
## <a name="throttling-implications-for-ews-batch-requests"></a><span data-ttu-id="0b73b-312">Влияние регулирования на пакетные запросы EWS</span><span class="sxs-lookup"><span data-stu-id="0b73b-312">Throttling implications for EWS batch requests</span></span>
<span data-ttu-id="0b73b-313"><a name="bk_ThrottlingBatch"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-313"><a name="bk_ThrottlingBatch"> </a></span></span>

<span data-ttu-id="0b73b-314">С помощью веб-служб Exchange вы можете выполнить пакетные запросы к нескольким элементам в один запрос, выполняемый сервером клиентского доступа.</span><span class="sxs-lookup"><span data-stu-id="0b73b-314">EWS enables you to batch multiple item requests into a single request that is executed by the Client Access server.</span></span> <span data-ttu-id="0b73b-315">Это позволяет повысить эффективность и производительность.</span><span class="sxs-lookup"><span data-stu-id="0b73b-315">This allows for greater efficiency and performance.</span></span> <span data-ttu-id="0b73b-316">Когда сервер Exchange Server выполняет пакетный запрос, он проверяет бюджет пользователя после выполнения каждого элемента в пакете.</span><span class="sxs-lookup"><span data-stu-id="0b73b-316">When an Exchange server executes a batched request, it checks the user's budget after the execution of each item within the batch.</span></span> <span data-ttu-id="0b73b-317">Если приложение превышает бюджет, обработка следующего элемента в пакете задерживается до тех пор, пока не будет оплачен бюджет для этого пользователя.</span><span class="sxs-lookup"><span data-stu-id="0b73b-317">If the application is over budget, the processing of the next item in the batch is delayed until the budget for that user has recharged.</span></span> <span data-ttu-id="0b73b-318">Чтобы обеспечить успешную работу приложений, использующих пакетные операции, ограничьте количество запросов элементов, которые могут быть включены в один пакет, и разделите большие пакеты на несколько небольших пакетов, чтобы повысить надежность результатов.</span><span class="sxs-lookup"><span data-stu-id="0b73b-318">To ensure that applications that use batch operations run successfully, limit the number of item requests that can be included in a single batch, and divide large batches across multiple smaller batches to increase the reliability of the results.</span></span> <span data-ttu-id="0b73b-319">Действие пакетной операции в определенных пороговых значениях регулирования зависит от типа запроса, размера обрабатываемых элементов (например, в операциях **UploadItems** или **ExportItems** ) и содержимого почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="0b73b-319">The effect that a batch operation has on particular throttling thresholds depends on the type of the request, the size of the items to be processed (for example in **UploadItems** or **ExportItems** operations) and the mailbox content.</span></span> <span data-ttu-id="0b73b-320">Политики регулирования влияют на пакетные операции, вызывая более длительную обработку запроса.</span><span class="sxs-lookup"><span data-stu-id="0b73b-320">Throttling policies affect batch operations by causing the request to take longer to process.</span></span> <span data-ttu-id="0b73b-321">Таким образом, вызывающий абонент должен ждать ответа, и, так как EWS ограничит время выполнения пакетного запроса на одну минуту, время ожидания вызова может истечет.</span><span class="sxs-lookup"><span data-stu-id="0b73b-321">The caller will therefore have to wait longer for the response, and, because EWS limits the execution time of a batch request to one minute, the call could time out.</span></span> 
  
<span data-ttu-id="0b73b-322">Чтобы определить оптимальный размер пакета для приложения, выполните модульное тестирование с использованием различных входных наборов, чтобы приложение не выполняло какие – либо ошибки в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="0b73b-322">To determine the optimum batch size for an application, perform unit testing using various input sets to ensure that the application does not encounter any errors in a production environment.</span></span> 
  
## <a name="throttling-policy-parameters-that-affect-ews-search-operations"></a><span data-ttu-id="0b73b-323">Параметры политики регулирования, которые влияют на поисковые операции EWS</span><span class="sxs-lookup"><span data-stu-id="0b73b-323">Throttling policy parameters that affect EWS search operations</span></span>
<span data-ttu-id="0b73b-324"><a name="bk_ThrottlingSearch"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-324"><a name="bk_ThrottlingSearch"> </a></span></span>

<span data-ttu-id="0b73b-325">[Операции поиска в EWS](search-and-ews-in-exchange.md) могут занимать много времени и ресурсов в зависимости от того, как выполняется поиск и какие сведения запрашиваются.</span><span class="sxs-lookup"><span data-stu-id="0b73b-325">[Search operations in EWS](search-and-ews-in-exchange.md) can require large amounts of time and resources, depending on how the search is run and what information is requested.</span></span> <span data-ttu-id="0b73b-326">Для управления использованием ресурсов во время поиска применяются два параметра политики: **евсфастсеарчтимеаутинсекондс** и **евсфиндкаунтлимит**.</span><span class="sxs-lookup"><span data-stu-id="0b73b-326">To control resource usage during searches, two policy parameters take effect: **EWSFastSearchTimeoutInSeconds** and **EWSFindCountLimit**.</span></span> 
  
<span data-ttu-id="0b73b-327">Параметр политики **евсфастсеарчтимеаутинсекондс** указывает время (в секундах), в течение которого поиск службы EWS (также называется поиском по индексированию содержимого) выполняется до истечения времени ожидания. Быстрый поиск — это поиск, выполненный с помощью строки запроса расширенного синтаксиса запросов (AQS) в [операции FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="0b73b-327">The **EWSFastSearchTimeoutInSeconds** policy parameter specifies the amount of time, in seconds, that EWS fast searches (also known as content indexing search) run before they time out. A fast search is a search made by using an Advanced Query Syntax (AQS) query string in a [FindItem operation](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx).</span></span>
  
<span data-ttu-id="0b73b-328">Вы можете выполнить поиск в папке почтового ящика Exchange двумя способами:</span><span class="sxs-lookup"><span data-stu-id="0b73b-328">You can search an Exchange mailbox folder in two ways:</span></span>
  
- <span data-ttu-id="0b73b-329">С помощью поиска в хранилище Exchange, который выполняет последовательный просмотр всех сообщений в целевой области поиска.</span><span class="sxs-lookup"><span data-stu-id="0b73b-329">By using an Exchange store search, which performs a sequential scan of all messages in the target search scope.</span></span>
    
- <span data-ttu-id="0b73b-330">С помощью службы поиска Exchange (индексирование контента).</span><span class="sxs-lookup"><span data-stu-id="0b73b-330">By using the Exchange Search service (content indexing).</span></span>
    
<span data-ttu-id="0b73b-331">Оба эти типа поиска могут привести к превышению времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="0b73b-331">Both of these types of searches can result in timeouts.</span></span> <span data-ttu-id="0b73b-332">По возможности используйте службу поиска Exchange, так как эти операции поиска часто предназначены для индексов почтовых ящиков и используют запросы AQS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-332">When possible, use the Exchange Search service because these searches are often targeted against mailbox indexes and use AQS queries.</span></span> <span data-ttu-id="0b73b-333">В приведенном ниже примере показано, как выполнить поиск AQS в папке "Входящие" с помощью EWS и службы поиска Exchange.</span><span class="sxs-lookup"><span data-stu-id="0b73b-333">The following example shows how to perform an AQS search of the Inbox by using EWS and the Exchange Search service.</span></span>
  
```cs
ItemView iv = new ItemView(1000);
FindItemsResults<Item> fiitems = service.FindItems(WellKnownFolderName.Inbox, "subject:football", iv);
```

<span data-ttu-id="0b73b-334">Если вы не можете использовать поиск AQS, старайтесь не использовать слишком сложные фильтры поиска.</span><span class="sxs-lookup"><span data-stu-id="0b73b-334">If you can't use an AQS search, avoid using overly complex search filters.</span></span> <span data-ttu-id="0b73b-335">Кроме того, старайтесь не создавать фильтры поиска на основе вычисляемых значений, если запрос включает расширенные свойства MAPI.</span><span class="sxs-lookup"><span data-stu-id="0b73b-335">Also try to avoid creating search filters based on computed values if the query involves extended MAPI properties.</span></span> <span data-ttu-id="0b73b-336">Служба поиска AQS была введена в Exchange 2010.</span><span class="sxs-lookup"><span data-stu-id="0b73b-336">AQS search was introduced in Exchange 2010.</span></span>
  
> [!NOTE]
> <span data-ttu-id="0b73b-337">При первом запуске сложного поискового запроса в хранилище Exchange он выполняется очень медленно и может исполняться. После этого запрос ответит быстрее.</span><span class="sxs-lookup"><span data-stu-id="0b73b-337">The first time you run a complex Exchange store search query, it runs very slowly and may time out. After that, the query will respond more quickly.</span></span> <span data-ttu-id="0b73b-338">Для получения дополнительных сведений о внутренних процессах Exchange Server, происходящих во время поисковых запросов в хранилище Exchange, ознакомьтесь со статьей [о влиянии на производительность при высоком количестве элементов и ограниченных представлениях](http://technet.microsoft.com/en-us/library/cc535025%28EXCHG.80%29.aspx) на сайте TechNet.</span><span class="sxs-lookup"><span data-stu-id="0b73b-338">For more information about the backend Exchange server processes that occur during Exchange store search queries, see [Understanding the Performance Impact of High Item Counts and Restricted Views](http://technet.microsoft.com/en-us/library/cc535025%28EXCHG.80%29.aspx) on TechNet.</span></span> <span data-ttu-id="0b73b-339">С помощью **SearchFilter** создается динамическое ограничение, которое помогает аналогичным запросам в будущем, но так как эти ограничения являются динамическими, они не являются постоянными и не являются надежными и удаляются по истечении максимум в три дня.</span><span class="sxs-lookup"><span data-stu-id="0b73b-339">Using a **SearchFilter** creates a dynamic restriction that helps similar queries in the future, but because these restrictions are dynamic in nature, they are not permanent or reliable, and are deleted after a maximum of three days.</span></span> 
  
<span data-ttu-id="0b73b-340">Параметр политики **евсфиндкаунтлимит** указывает максимальное количество элементов из результатов операции **FindItem** или **FindFolder** , которые могут существовать в памяти на сервере клиентского доступа одновременно для одного пользователя.</span><span class="sxs-lookup"><span data-stu-id="0b73b-340">The **EWSFindCountLimit** policy parameter specifies the maximum number of items from the results of a **FindItem** or **FindFolder** operation that can exist in memory on a Client Access server at the same time for one user.</span></span> <span data-ttu-id="0b73b-341">Каждый элемент или папка, которые EWS обрабатывает в запросе **FindItem** или **FindFolder** , учитываются в бюджете, указанном в элементе **евсфиндкаунтлимит** .</span><span class="sxs-lookup"><span data-stu-id="0b73b-341">Every item or folder that EWS processes in a **FindItem** or **FindFolder** request is counted against the budget specified in the **EWSFindCountLimit** element.</span></span> <span data-ttu-id="0b73b-342">Когда ответ отправляется обратно инициатору запроса, отменяется зарядка по количеству операций поиска для текущего вызова.</span><span class="sxs-lookup"><span data-stu-id="0b73b-342">When the response is sent back to the requester, the find count charge for the current call is released.</span></span> <span data-ttu-id="0b73b-343">Ответ, который сервер возвращает запрашивающему участнику при превышении бюджета, основан на значении элемента **рекуестсерверверсион** и о том, указан ли в запросе постраничный просмотр.</span><span class="sxs-lookup"><span data-stu-id="0b73b-343">The response the server returns to a requester when the budget is exceeded is based on the **RequestServerVersion** element value and whether the requester specified paging.</span></span> <span data-ttu-id="0b73b-344">Когда значение элемента **рекуестсерверверсион** указывает Exchange 2010 или более ранняя версия Exchange, сервер отправляет ответ об ошибке с кодом ошибки **еррорсервербуси**.</span><span class="sxs-lookup"><span data-stu-id="0b73b-344">When the value of the **RequestServerVersion** element indicates Exchange 2010 or an earlier version of Exchange, the server sends a failure response with error code **ErrorServerBusy**.</span></span> <span data-ttu-id="0b73b-345">Если значение элемента **рекуестсерверверсион** указывает версию Exchange, начинающуюся с Exchange 2010 с пакетом обновления 1 (SP1) или Exchange Online, а клиент использует разбиение на страницы, EWS может вернуть частичный результирующий набор вместо ошибки.</span><span class="sxs-lookup"><span data-stu-id="0b73b-345">If the value of the **RequestServerVersion** element indicates a version of Exchange starting with Exchange 2010 SP1 or Exchange Online, and the client is using paging, EWS may return a partial result set instead of an error.</span></span> <span data-ttu-id="0b73b-346">Ваше приложение должно ожидать, что EWS не сможет вернуть все элементы.</span><span class="sxs-lookup"><span data-stu-id="0b73b-346">Your application should expect that EWS might not return all items.</span></span> <span data-ttu-id="0b73b-347">Если для элемента **инклудесластитеминранже** задано значение false, приложение должно выполнить другой запрос **FindItem** или **FindFolder** с новым смещением и продолжить до тех пор, пока элемент **инклудесластитеминранже** не возвратит значение true.</span><span class="sxs-lookup"><span data-stu-id="0b73b-347">If the value of the **IncludesLastItemInRange** element is false, the application should make another **FindItem** or **FindFolder** request with the new offset and continue until the **IncludesLastItemInRange** element returns true.</span></span> 
  
<span data-ttu-id="0b73b-348">При использовании операции **FindItem** или **FindFolder** важно использовать разбиение по страницам.</span><span class="sxs-lookup"><span data-stu-id="0b73b-348">When you use a **FindItem** or **FindFolder** operation, it is important to use paging.</span></span> <span data-ttu-id="0b73b-349">Управляемый API EWS использует разбиение по страницам, но если вы используете другие методы, такие как прокси-объекты EWS или необработанные SOAP, необходимо явно задать разбиение по страницам.</span><span class="sxs-lookup"><span data-stu-id="0b73b-349">The EWS Managed API enforces the use of paging, but if you are using other methods, such as EWS proxy objects or raw SOAP, you need to explicitly set paging.</span></span> <span data-ttu-id="0b73b-350">В приведенном ниже примере показано, как использовать разбиение по страницам в управляемом API EWS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-350">The following example shows how to use paging in the EWS Managed API.</span></span> 
  
```cs
ItemView iv = new ItemView(1000);
FindItemsResults<Item> fiFindItemResults = service.FindItems(WellKnownFolderName.Inbox, iv);
```

> [!NOTE]
> <span data-ttu-id="0b73b-351">Политика по умолчанию в Exchange позволяет ограничить размер страницы 1000 элементами.</span><span class="sxs-lookup"><span data-stu-id="0b73b-351">The default policy in Exchange limits the page size to 1000 items.</span></span> <span data-ttu-id="0b73b-352">Установка для размера страницы значения, которое больше, чем это значение, не оказывает никакого практического действия.</span><span class="sxs-lookup"><span data-stu-id="0b73b-352">Setting the page size to a value that is greater than this number has no practical effect.</span></span> 
  
<span data-ttu-id="0b73b-353">Приложения также должны учитывать факт того, что значение параметра регулирования _евсфиндкаунтлимит_ может привести к возврату частичного набора результатов для приложений, которые выполняют параллельные запросы.</span><span class="sxs-lookup"><span data-stu-id="0b73b-353">Applications should also account for the fact that the  _EWSFindCountLimit_ throttling parameter value may result in a partial result set being returned for applications that make concurrent requests.</span></span> <span data-ttu-id="0b73b-354">В приведенном ниже примере показано, как использовать свойство **мореаваилабле** в УПРАВЛЯЕМОМ API EWS, чтобы убедиться, что все результаты включены в запрос.</span><span class="sxs-lookup"><span data-stu-id="0b73b-354">The following example shows how to use the **MoreAvailable** property in the EWS Managed API to ensure that all results are included in a query.</span></span> 
  
```cs
ItemView iv = new ItemView(1000);
service.TraceEnabled = false;
FindItemsResults<Item> fiResults = null;
Do 
{
    fiResults = service.FindItems(WellKnownFolderName.Inbox, iv);
    PropertySet itItemPropSet = new PropertySet(BasePropertySet.IdOnly) { EmailMessageSchema.Body };
    //Process Items in Result Set
    iv.Offset += fiResults.Items.Count;
}
while (fiResults.MoreAvailable == true);
```

## <a name="throttling-policies-and-concurrency"></a><span data-ttu-id="0b73b-355">Политики регулирования и параллелизм</span><span class="sxs-lookup"><span data-stu-id="0b73b-355">Throttling policies and concurrency</span></span>
<span data-ttu-id="0b73b-356"><a name="bk_ThrottlingConcurrency"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-356"><a name="bk_ThrottlingConcurrency"> </a></span></span>

<span data-ttu-id="0b73b-357">Параллелизм — это количество подключений от определенного пользователя.</span><span class="sxs-lookup"><span data-stu-id="0b73b-357">Concurrency refers to the number of connections from a specific user.</span></span> <span data-ttu-id="0b73b-358">Соединение удерживается с момента получения запроса, пока не будет отправлен ответ инициатору запроса.</span><span class="sxs-lookup"><span data-stu-id="0b73b-358">A connection is held from the moment a request is received until a response is sent to the requester.</span></span> <span data-ttu-id="0b73b-359">Если пользователи пытаются сделать более параллельные запросы, чем разрешено политикой, новая попытка подключения завершается неудачно.</span><span class="sxs-lookup"><span data-stu-id="0b73b-359">If users try to make more concurrent requests than their policy allows, the new connection attempt fails.</span></span> <span data-ttu-id="0b73b-360">Однако существующие соединения остаются действительными.</span><span class="sxs-lookup"><span data-stu-id="0b73b-360">However, the existing connections remain valid.</span></span> <span data-ttu-id="0b73b-361">Политики регулирования могут повлиять на параллелизм несколькими различными способами.</span><span class="sxs-lookup"><span data-stu-id="0b73b-361">Throttling policies can affect concurrency in a number of different ways.</span></span>
  
<span data-ttu-id="0b73b-362">Параметр политики регулирования **евсмаксконкурренци** задает количество одновременных подключений, которые определенный пользователь может использовать на сервере Exchange одновременно.</span><span class="sxs-lookup"><span data-stu-id="0b73b-362">The **EWSMaxConcurrency** throttling policy parameter sets the number of concurrent connections that a specific user can have against an Exchange server at one time.</span></span> <span data-ttu-id="0b73b-363">Чтобы определить максимальное число одновременных подключений, примите во внимание подключения, которые будут использоваться клиентами Outlook.</span><span class="sxs-lookup"><span data-stu-id="0b73b-363">To determine the maximum number of concurrent connections to allow, consider the connections that Outlook clients will use.</span></span> <span data-ttu-id="0b73b-364">Outlook 2007 и Outlook 2010 используют EWS для доступа к сведениям о доступности и отсутствии на работе (отсутствие на работе).</span><span class="sxs-lookup"><span data-stu-id="0b73b-364">Outlook 2007 and Outlook 2010 use EWS to access availability and Out of Office (OOF) information.</span></span> <span data-ttu-id="0b73b-365">В Outlook 2011 для всех функций клиентского доступа используется EWS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-365">Mac Outlook 2011 uses EWS for all client access functionality.</span></span> <span data-ttu-id="0b73b-366">В зависимости от количества клиентов Outlook, которые активно подключаются к почтовому ящику пользователя, число одновременных подключений, доступных пользователю, может быть ограничено.</span><span class="sxs-lookup"><span data-stu-id="0b73b-366">Depending on the number of Outlook clients that are actively connecting to a user's mailbox, the number of concurrent connections available for a user might be limited.</span></span> <span data-ttu-id="0b73b-367">Кроме того, если ваше приложение должно подключаться к нескольким почтовым ящикам одновременно с одним контекстом безопасности, необходимо учитывать значение политики **евсмаксконкурренци** .</span><span class="sxs-lookup"><span data-stu-id="0b73b-367">Also, if your application has to connect to multiple mailboxes simultaneously while using a single security context, it is important to take the value of the **EWSMaxConcurrency** policy into account.</span></span> <span data-ttu-id="0b73b-368">Дополнительные сведения об использовании единого контекста безопасности с одновременными подключениями приведены в статье [регулирование требований для приложений, использующих олицетворение EWS](#bk_ThrottlingConsiderations) ранее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="0b73b-368">For more information about using a single security context with concurrent connections, see [Throttling considerations for applications that use EWS impersonation](#bk_ThrottlingConsiderations) earlier in this article.</span></span> 
  
<span data-ttu-id="0b73b-369">Приложения, которые одновременно подключаются к нескольким почтовым ящикам, должны иметь возможность отслеживать использование ресурсов на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="0b73b-369">Applications that concurrently connect to multiple mailboxes have to be able to track resource usage on the client side.</span></span> <span data-ttu-id="0b73b-370">Так как операции EWS основаны на запросах и ответах, вы можете убедиться, что ваши приложения хорошо работают в пороговом значении **евсмаксконкурренци** , отслеживая число подключений между началом запроса и при получении ответа и обеспечение того, что не более десяти открытых запросов выполняются одновременно.</span><span class="sxs-lookup"><span data-stu-id="0b73b-370">Because EWS operations are request/response-based, you can ensure that your applications function well within the **EWSMaxConcurrency** threshold by tracking the number of connections that occur between the start of a request and when the response is received and ensuring that no more than ten open requests occur concurrently.</span></span> 
  
<span data-ttu-id="0b73b-371">Параметр политики **евсфиндкаунтлимит** указывает максимальный размер результата, который может использовать операция **FindItem** или **FindFolder** для сервера клиентского доступа одновременно для одного пользователя.</span><span class="sxs-lookup"><span data-stu-id="0b73b-371">The **EWSFindCountLimit** policy parameter specifies the maximum result size a **FindItem** or **FindFolder** operation can use on a Client Access server at the same time for one user.</span></span> <span data-ttu-id="0b73b-372">Если приложение (или потенциально несколько приложений) выполняет два одновременных запроса **FindItem** для служб EWS, которые возвращают 100 элементов для определенного пользователя, **евсфиндкаунтлимит** начисление по бюджету конкретного пользователя будет 200.</span><span class="sxs-lookup"><span data-stu-id="0b73b-372">If an application (or potentially multiple applications) makes two concurrent EWS **FindItem** requests that return 100 items each for a specific user, the **EWSFindCountLimit** charge against that specific user's budget will be 200.</span></span> <span data-ttu-id="0b73b-373">Когда первый запрос возвращается, бюджет перепадает до 100 и при возвращении второго запроса бюджет передается в ноль.</span><span class="sxs-lookup"><span data-stu-id="0b73b-373">When the first request returns, the budget drops to 100, and when the second request returns, the budget drops to zero.</span></span> <span data-ttu-id="0b73b-374">Если одно и то же приложение должно выполнить два одновременных запроса для элементов 1000, то значение бюджета будет 2000 элементов, что превышает значение **евсфиндкаунтлимит** .</span><span class="sxs-lookup"><span data-stu-id="0b73b-374">If the same application were to make two simultaneous requests for 1000 items, the budget value would be 2000 items, which exceeds the **EWSFindCountLimit** value.</span></span> <span data-ttu-id="0b73b-375">Если для элементов в бюджете пользователя меньше нуля, следующий запрос приводит к ошибке, пока бюджет пользователя не перейдет в один или несколько.</span><span class="sxs-lookup"><span data-stu-id="0b73b-375">If the user's budget for items drops below zero, the next request results in an error until the user's budget recharges to one or more.</span></span> 

<span data-ttu-id="0b73b-376"><a name="bk_ThrottlingNotifications"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-376"><a name="bk_ThrottlingNotifications"> </a></span></span>
  
## <a name="throttling-considerations-for-ews-notification-applications"></a><span data-ttu-id="0b73b-377">Вопросы регулирования для приложений уведомлений EWS</span><span class="sxs-lookup"><span data-stu-id="0b73b-377">Throttling considerations for EWS notification applications</span></span>


<span data-ttu-id="0b73b-378">Если вы создаете приложения уведомлений EWS, которые используют Уведомления Push, Pull или Streaming, следует учитывать последствия **евсмакссубскриптионс** и политик регулирования **евсмаксконкурренци** и **хангингконнектионлимит**.</span><span class="sxs-lookup"><span data-stu-id="0b73b-378">If you are building EWS notification applications that make use of either push, pull, or streaming notifications, you should consider the implications of the **EWSMaxSubscriptions** and the **EWSMaxConcurrency** throttling policies, and the **HangingConnectionLimit**.</span></span> 
  
<span data-ttu-id="0b73b-379">Параметр политики **евсмакссубскриптионс** указывает максимальное количество активных почтовых подписок, а также почтовых подписок, которые пользователь может иметь на определенном сервере клиентского доступа одновременно.</span><span class="sxs-lookup"><span data-stu-id="0b73b-379">The **EWSMaxSubscriptions** policy parameter specifies the maximum number of active push, pull, and streaming subscriptions that a user can have on a specific Client Access server at the same time.</span></span> <span data-ttu-id="0b73b-380">Для разных версий Exchange для этого параметра заданы разные значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0b73b-380">Different versions of Exchange have different default values for this parameter.</span></span> <span data-ttu-id="0b73b-381">Пользователь может подписаться на все папки в почтовом ящике с помощью свойства **субскрибетоаллфолдерс** , в котором используется одна подписка на бюджете **евсмакссубскриптионс** .</span><span class="sxs-lookup"><span data-stu-id="0b73b-381">A user can subscribe to all folders in a mailbox by using the **SubscribeToAllFolders** property - this uses a single subscription against the **EWSMaxSubscriptions** budget.</span></span> <span data-ttu-id="0b73b-382">Пользователи могут подписываться на отдельные папки, при этом каждая подписка на эту папку подсчитывается в соответствии с бюджетом **евсмакссубскриптионс** , вплоть до предельного значения параметра **евсмакссубскриптионс** (например, пользователи могут подписываться на 20 папок календаря в разных почтовых ящиках, если для **евсмакссубскриптионс** установлено значение 20).</span><span class="sxs-lookup"><span data-stu-id="0b73b-382">Users can subscribe to individual folders, with each folder subscription counting towards the **EWSMaxSubscriptions** budget, up to the limit set by the value of the **EWSMaxSubscriptions** parameter (for example, users can subscribe to 20 calendar folders in different mailboxes if **EWSMaxSubscriptions** is set to 20).</span></span> 
  
<span data-ttu-id="0b73b-383">Сведения об олицетворении и параметре **евсмакссубскриптионс** приведены в статье [регулирование требований для приложений, использующих олицетворение EWS](#bk_ThrottlingConsiderations) ранее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="0b73b-383">For information about impersonation and the **EWSMaxSubscriptions** parameter, see [Throttling considerations for applications that use EWS impersonation](#bk_ThrottlingConsiderations) earlier in this article.</span></span> 
  
<span data-ttu-id="0b73b-384">Параметр политики **евсмаксконкурренци** также может быть вопросом для уведомлений EWS; Например:</span><span class="sxs-lookup"><span data-stu-id="0b73b-384">The **EWSMaxConcurrency** policy parameter can also be an issue for EWS notifications; for example:</span></span> 
  
- <span data-ttu-id="0b73b-385">При увеличении числа подключений для владельца подписки с помощью службы EWS при создании уведомления с помощью принудительной подписки.</span><span class="sxs-lookup"><span data-stu-id="0b73b-385">When EWS increments the connection count for the owner of the subscription while the notification is being generated by a push subscription.</span></span>
    
- <span data-ttu-id="0b73b-386">Если приложение предназначено для прослушивания почтовых ящиков нескольких пользователей, а пользователи получают одновременные уведомления для экземпляра сообщения, отправляемого в список рассылки.</span><span class="sxs-lookup"><span data-stu-id="0b73b-386">When an application is designed to listen to multiple users' mailboxes, and users receive simultaneous notifications for an instance of a message that is sent to a distribution list.</span></span>
    
<span data-ttu-id="0b73b-387">Если приложение уведомлений является многопоточным и создает одновременные запросы на подключение для получения дополнительных сведений о конкретном сообщении, которое было получено учетной записью пользователя, может быть превышено ограничение политики **евсмаксконкурренци** .</span><span class="sxs-lookup"><span data-stu-id="0b73b-387">If the notification application is multithreaded and makes simultaneous connection requests to get more information about a particular message that was received by a user account, the **EWSMaxConcurrency** policy limit can be exceeded.</span></span> <span data-ttu-id="0b73b-388">Для этого следует рассмотреть возможность мониторинга параллельных подключений в приложении, в том числе тех, которые могут использоваться сервером, и реализации очереди запросов на клиенте.</span><span class="sxs-lookup"><span data-stu-id="0b73b-388">To account for this, consider monitoring the concurrent connections in your application, including those that might be used by the server, and implementing request queuing on the client.</span></span> 
  
<span data-ttu-id="0b73b-389">**Хангингконнектионлимит** применяется только к потоковым уведомлениям.</span><span class="sxs-lookup"><span data-stu-id="0b73b-389">The **HangingConnectionLimit** is only applicable to streaming notifications.</span></span> <span data-ttu-id="0b73b-390">Это значение задается в файле Web. config, что означает, что администратор Exchange может задать это значение на локальном сервере Exchange Server, но почтовые ящики Exchange Online должны использовать значение по умолчанию для этого ограничения, равное 3 для Exchange Online и Exchange 2013.</span><span class="sxs-lookup"><span data-stu-id="0b73b-390">This limit is set in the web.config file, which means that an Exchange administrator can set this value on an on-premises Exchange server, but Exchange Online mailboxes must use the default value for this limit, which is 3 for both Exchange Online and Exchange 2013.</span></span> <span data-ttu-id="0b73b-391">Чтобы узнать больше, посмотрите, [какие значения регулирования необходимо учитывать?](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_throttling).</span><span class="sxs-lookup"><span data-stu-id="0b73b-391">To learn more, see [What throttling values do I need to take into consideration?](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_throttling).</span></span>
  
## <a name="throttling-policy-and-application-performance"></a><span data-ttu-id="0b73b-392">Политика регулирования и производительность приложения</span><span class="sxs-lookup"><span data-stu-id="0b73b-392">Throttling policy and application performance</span></span>
<span data-ttu-id="0b73b-393"><a name="bk_PercentTimeIn"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-393"><a name="bk_PercentTimeIn"> </a></span></span>

<span data-ttu-id="0b73b-394">Следующие три параметра политики регулирования **перценттимеин** влияют на время, в течение которого приложение EWS может использовать сервер клиентского доступа.</span><span class="sxs-lookup"><span data-stu-id="0b73b-394">The following three parameters of the **PercentTimeIn** throttling policy affect the amount of time an EWS application can consume on a Client Access server:</span></span> 
  
- <span data-ttu-id="0b73b-395">**евсперценттимеинад**</span><span class="sxs-lookup"><span data-stu-id="0b73b-395">**EWSPercentTimeInAD**</span></span>
    
- <span data-ttu-id="0b73b-396">**EWSPercentTimeInCAS**</span><span class="sxs-lookup"><span data-stu-id="0b73b-396">**EWSPercentTimeInCAS**</span></span>
    
- <span data-ttu-id="0b73b-397">**евсперценттимеинмаилбоксрпк**</span><span class="sxs-lookup"><span data-stu-id="0b73b-397">**EWSPercentTimeInMailboxRPC**</span></span>
    
<span data-ttu-id="0b73b-398">Значения, указанные в параметрах политики **перценттимеин** , указывают время, в течение которого выделяется один поток.</span><span class="sxs-lookup"><span data-stu-id="0b73b-398">The values specified in the **PercentTimeIn** policy parameters indicate the amount of time that one thread making one request is allocated.</span></span> <span data-ttu-id="0b73b-399">Например, при наличии значения **EWSPercentTimeInCAS** 90, если процесс выполняет два параллельных запроса, которые тратят 54 секунд на выполнение кода на сервере клиентского доступа, процесс использует значение 108 секунды в окне 60 second.</span><span class="sxs-lookup"><span data-stu-id="0b73b-399">For example, assuming a **EWSPercentTimeInCAS** value of 90, if a process makes two concurrent requests that spend 54 seconds each running code on the Client Access server, the process uses 108 seconds in a 60 second window.</span></span> <span data-ttu-id="0b73b-400">Представляет значение параметра **EWSPercentTimeInCAS** , равное 180 процентов.</span><span class="sxs-lookup"><span data-stu-id="0b73b-400">This represents an **EWSPercentTimeInCAS** parameter value of 180 percent.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="0b73b-401">Значение параметра **EWSPercentTimeInCAS** является перекрытием надмножеством значений параметров **евсперценттимеинад** и **евсперценттимеинмаилбоксрпк** .</span><span class="sxs-lookup"><span data-stu-id="0b73b-401">The **EWSPercentTimeInCAS** parameter value is an overlapping superset of the **EWSPercentTimeInAD** and **EWSPercentTimeInMailboxRPC** parameter values.</span></span> <span data-ttu-id="0b73b-402">Это означает, что расход времени обработки сервера клиентского доступа всегда будет превышать расходы в **евсперценттимеинад** и **евсперценттимеинмаилбоксрпк**.</span><span class="sxs-lookup"><span data-stu-id="0b73b-402">This means that the expenditure in Client Access server processing time will always be larger than the expenditures in **EWSPercentTimeInAD** and **EWSPercentTimeInMailboxRPC**.</span></span> <span data-ttu-id="0b73b-403">Это связано с тем, что для того, чтобы компонент Exchange выполнял вызов Active Directory или RPC, он должен уже иметь код сервера клиентского доступа.</span><span class="sxs-lookup"><span data-stu-id="0b73b-403">This is because for the Exchange component to make an Active Directory or RPC call, it must already be running Client Access server code.</span></span> <span data-ttu-id="0b73b-404">Кроме того, при выполнении вызовов LDAP или RPC расход времени на обработку для **EWSPercentTimeInCAS** не прекращается.</span><span class="sxs-lookup"><span data-stu-id="0b73b-404">In addition, the expenditure in processing time for **EWSPercentTimeInCAS** doesn't stop while LDAP or RPC calls are being made.</span></span> <span data-ttu-id="0b73b-405">Несмотря на то, что запрос может синхронно ожидать ответа от доменных служб Active Directory (AD DS) или хранилища Exchange, процесс по-прежнему использует поток на сервере, поэтому поток должен по-прежнему платить за это использование.</span><span class="sxs-lookup"><span data-stu-id="0b73b-405">Although the request might be synchronously waiting for a response from Active Directory Domain Services (AD DS) or the Exchange store, the process is still consuming a thread on the server, and therefore the thread should continue to be charged for that usage.</span></span> 
  
<span data-ttu-id="0b73b-406">Время ЦП, которое может пройти приложение в течение 60 секунды, может превышать эти ограничения. Поэтому важно учитывать объем и тип выполняемых запросов.</span><span class="sxs-lookup"><span data-stu-id="0b73b-406">The amount of CPU time an application may take in a 60-second period might exceed these throttling limits; therefore, it is important to consider the volume and type of requests that are being made.</span></span> <span data-ttu-id="0b73b-407">Например, большой пакет операций **ResolveNames** , выполняемых одновременно, может превышать значение параметра политики **евсперценттимеинад** .</span><span class="sxs-lookup"><span data-stu-id="0b73b-407">For example, a large batch of **ResolveNames** operations that are made simultaneously can exceed the **EWSPercentTimeInAD** policy parameter value.</span></span> <span data-ttu-id="0b73b-408">Значения политики, которые входят в политику регулирования по умолчанию, предназначены для того, чтобы большинство приложений EWS работали без выпусков; Однако если многопоточные приложения с большим количеством томов размещают большой объем запросов на одном сервере клиентского доступа, это может создать проблемы.</span><span class="sxs-lookup"><span data-stu-id="0b73b-408">The policy values that are contained in the default throttling policy are designed to allow most EWS applications to function without issue; however, when multithreaded high-volume applications place a large volume of requests on one particular Client Access server, this can create problems.</span></span> <span data-ttu-id="0b73b-409">Чтобы избежать этого, рассмотрите возможность ограничения размера пакетов, которые будут выполняться на сервере.</span><span class="sxs-lookup"><span data-stu-id="0b73b-409">To avoid this, consider limiting the size of batches that are going to execute against the server.</span></span> 
  
## <a name="throttling-policies-and-applications-that-send-a-large-volume-of-email"></a><span data-ttu-id="0b73b-410">Регулирование политик и приложений, отправляющих большой объем электронной почты</span><span class="sxs-lookup"><span data-stu-id="0b73b-410">Throttling policies and applications that send a large volume of email</span></span>
<span data-ttu-id="0b73b-411"><a name="bk_RateLimits"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-411"><a name="bk_RateLimits"> </a></span></span>

<span data-ttu-id="0b73b-412">Политики регулирования по умолчанию включают три параметра политики ограничения скорости, которые могут повлиять на приложения, которые используют EWS для отправки большого объема сообщений или отправки сообщений в больших пакетах в течение короткого периода времени.</span><span class="sxs-lookup"><span data-stu-id="0b73b-412">The default throttling policies include three rate limit policy parameters that can affect applications that use EWS to send a large volume of messages or send messages in large batches in a short period of time.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="0b73b-413">Как правило, не рекомендуется использовать EWS для отправки массовых сообщений электронной почты.</span><span class="sxs-lookup"><span data-stu-id="0b73b-413">In general, we recommend that you do not use EWS to send bulk email.</span></span> <span data-ttu-id="0b73b-414">Используйте узел SMTP, который специализируется на службах массовой почты для отправки часто встречающихся больших сообщений электронной почты.</span><span class="sxs-lookup"><span data-stu-id="0b73b-414">Use an SMTP host that specializes in bulk mail services to submit frequent large bulk email messages.</span></span> 
  
<span data-ttu-id="0b73b-415">Параметр политики **MessageRateLimit** указывает количество сообщений в минуту, которые могут быть отправлены любым клиентом Exchange, в том числе EWS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-415">The **MessageRateLimit** policy parameter specifies the number of messages per minute that can be submitted by any Exchange client, including EWS.</span></span> <span data-ttu-id="0b73b-416">По умолчанию для этой политики задано 30 сообщений в минуту.</span><span class="sxs-lookup"><span data-stu-id="0b73b-416">By default, this policy is set to 30 messages per minute.</span></span> <span data-ttu-id="0b73b-417">Для обычных пользователей это, как правило, достаточно.</span><span class="sxs-lookup"><span data-stu-id="0b73b-417">For ordinary users, this is generally sufficient.</span></span> <span data-ttu-id="0b73b-418">Однако приложения, которые отправляют большие пакеты сообщений электронной почты, например часть программы для выставления счетов, могут выполнять проблемы.</span><span class="sxs-lookup"><span data-stu-id="0b73b-418">However, applications that send large batches of email messages, for example as part of an invoicing program, can run into problems.</span></span> <span data-ttu-id="0b73b-419">При превышении этого ограничения доставка сообщений для почтового ящика задерживается.</span><span class="sxs-lookup"><span data-stu-id="0b73b-419">When this policy limit is exceeded, message delivery for the mailbox is delayed.</span></span> <span data-ttu-id="0b73b-420">В частности, сообщения будут отображаться в папке "Исходящие" или "Черновики" в течение более длительных периодов времени, когда пользователь или приложение отправит большее количество сообщений, чем значение, заданное параметром **MessageRateLimit** .</span><span class="sxs-lookup"><span data-stu-id="0b73b-420">Specifically, messages will appear in the Outbox or Drafts folder for longer periods of time when a user or application submits a larger number of messages than the value specified by the **MessageRateLimit** parameter.</span></span> <span data-ttu-id="0b73b-421">Это необходимо учитывать при разработке системы отслеживания доставки, особенно если ваше приложение использует почтовый ящик, к которому пользователи подключаются с помощью Outlook.</span><span class="sxs-lookup"><span data-stu-id="0b73b-421">Be sure to consider this when you are developing a delivery tracking system, especially if your application uses a mailbox that users connect to via Outlook.</span></span> <span data-ttu-id="0b73b-422">Если отложенные элементы хранятся в папке "Исходящие" или "Черновики", пользователи могут интерпретировать сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="0b73b-422">When deferred items are stored in the Outbox or drafts folder, users might interpret that as an error.</span></span> 
  
<span data-ttu-id="0b73b-423">Параметр политики **RecipientRateLimit** указывает предельное число получателей, которые пользователь может иметь в течение 24 часов.</span><span class="sxs-lookup"><span data-stu-id="0b73b-423">The **RecipientRateLimit** policy parameter specifies the limit on the number of recipients that a user can address in a 24-hour period.</span></span> <span data-ttu-id="0b73b-424">Например, если задано значение 500, это означает, что одна учетная запись почтового ящика Exchange может отправлять сообщения не более чем 500 получателям каждый день.</span><span class="sxs-lookup"><span data-stu-id="0b73b-424">For example, if this value is set to 500, it means that a single Exchange mailbox account can send messages to no more than 500 recipients each day.</span></span> <span data-ttu-id="0b73b-425">Это значение применяется к сообщениям получателям, находящимся внутри организации и за ее пределами.</span><span class="sxs-lookup"><span data-stu-id="0b73b-425">This limit applies to messages to recipients that are inside and outside the organization.</span></span> <span data-ttu-id="0b73b-426">Это значение по умолчанию может вызывать проблемы для некоторых бизнес-приложений, выполняемых в течение конца месяца и требующих отправки сообщений больше, чем это количество получателей.</span><span class="sxs-lookup"><span data-stu-id="0b73b-426">This default limit might cause problems for some line-of-business applications that do end-of-month invoice runs and need to send messages to more than this number of recipients.</span></span> <span data-ttu-id="0b73b-427">Для обхода этого ограничения можно использовать внешние службы, которые обеспечивают пакетную обработку сообщений или отдельные решения для исходящей ретрансляции.</span><span class="sxs-lookup"><span data-stu-id="0b73b-427">You can use external services that enable batch processing of messages or separate on-premises outbound relay solutions to work around this limitation.</span></span> 
  
<span data-ttu-id="0b73b-428">Параметр политики **форвардилимит** указывает максимальное количество получателей, на которые сообщения могут пересылаться или перенаправляться с помощью правил для папки "Входящие".</span><span class="sxs-lookup"><span data-stu-id="0b73b-428">The **ForwardeeLimit** policy parameter specifies the maximum number of recipients that messages can be forwarded or redirected to by means of Inbox rules.</span></span> <span data-ttu-id="0b73b-429">Этот параметр не ограничивает количество сообщений, которые могут быть перенаправлены или перенаправлены получателям.</span><span class="sxs-lookup"><span data-stu-id="0b73b-429">This parameter doesn't limit the number of messages that can be forwarded or redirected to the recipients.</span></span> 
  
## <a name="errors-generated-when-throttling-limits-are-exceeded"></a><span data-ttu-id="0b73b-430">Ошибки, возникающие при превышении ограничений регулирования</span><span class="sxs-lookup"><span data-stu-id="0b73b-430">Errors generated when throttling limits are exceeded</span></span>
<span data-ttu-id="0b73b-431"><a name="bk_ThrottlingErrors"> </a></span><span class="sxs-lookup"><span data-stu-id="0b73b-431"><a name="bk_ThrottlingErrors"> </a></span></span>

<span data-ttu-id="0b73b-432">При превышении политик регулирования, EWS создает одну из ошибок, перечисленных в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="0b73b-432">When throttling polices are exceeded, EWS generates one of the errors listed in the following table.</span></span>
  
<span data-ttu-id="0b73b-433">**Таблица 3: ошибки ограничения регулирования**</span><span class="sxs-lookup"><span data-stu-id="0b73b-433">**Table 3: Throttling limit errors**</span></span>

|<span data-ttu-id="0b73b-434">**Ошибка**</span><span class="sxs-lookup"><span data-stu-id="0b73b-434">**Error**</span></span>|<span data-ttu-id="0b73b-435">**Параметр политики регулирования**</span><span class="sxs-lookup"><span data-stu-id="0b73b-435">**Throttling policy parameter**</span></span>|<span data-ttu-id="0b73b-436">**Описание**</span><span class="sxs-lookup"><span data-stu-id="0b73b-436">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="0b73b-437">еррорексцеедедконнектионкаунт</span><span class="sxs-lookup"><span data-stu-id="0b73b-437">ErrorExceededConnectionCount</span></span>  <br/> |<span data-ttu-id="0b73b-438">**евсмаксконкурренци**</span><span class="sxs-lookup"><span data-stu-id="0b73b-438">**EWSMaxConcurrency**</span></span> <br/> |<span data-ttu-id="0b73b-439">Указывает на то, что существует больше параллельных запросов к серверу, чем разрешено политикой пользователя.</span><span class="sxs-lookup"><span data-stu-id="0b73b-439">Indicates that there are more concurrent requests against the server than are allowed by a user's policy.</span></span>  <br/> |
|<span data-ttu-id="0b73b-440">еррорексцеедедсубскриптионкаунт</span><span class="sxs-lookup"><span data-stu-id="0b73b-440">ErrorExceededSubscriptionCount</span></span>  <br/> |<span data-ttu-id="0b73b-441">**евсмакссубскриптионс**</span><span class="sxs-lookup"><span data-stu-id="0b73b-441">**EWSMaxSubscriptions**</span></span> <br/> |<span data-ttu-id="0b73b-442">Указывает, что превышено максимальное число подписок для политики регулирования пользователя.</span><span class="sxs-lookup"><span data-stu-id="0b73b-442">Indicates that a user's throttling policy maximum subscription count has been exceeded.</span></span>  <br/> |
|<span data-ttu-id="0b73b-443">еррорексцеедедфиндкаунтлимит</span><span class="sxs-lookup"><span data-stu-id="0b73b-443">ErrorExceededFindCountLimit</span></span>  <br/> |<span data-ttu-id="0b73b-444">**евсфиндкаунтлимит**</span><span class="sxs-lookup"><span data-stu-id="0b73b-444">**EWSFindCountLimit**</span></span> <br/> |<span data-ttu-id="0b73b-445">Указывает, что вызов операции поиска превысил общее количество элементов, которые могут быть возвращены.</span><span class="sxs-lookup"><span data-stu-id="0b73b-445">Indicates that a search operation call has exceeded the total number of items that can be returned.</span></span>  <br/> |
|<span data-ttu-id="0b73b-446">еррорсервербуси</span><span class="sxs-lookup"><span data-stu-id="0b73b-446">ErrorServerBusy</span></span>  <br/> |<span data-ttu-id="0b73b-447">**Евсперценттимеинмаилбоксрпк**         **EWSPercentTimeInCAS**         **евсперценттимеинад**</span><span class="sxs-lookup"><span data-stu-id="0b73b-447">**EWSPercentTimeInMailboxRPC**         **EWSPercentTimeInCAS**         **EWSPercentTimeInAD**</span></span> <br/> |<span data-ttu-id="0b73b-448">Происходит, когда сервер занят.</span><span class="sxs-lookup"><span data-stu-id="0b73b-448">Occurs when the server is busy.</span></span> <span data-ttu-id="0b73b-449">Значение Баккоффмиллисекондс, возвращаемое с ошибками Еррорсервербуси, указывает клиенту на время ожидания, пока не будет повторно отправлен запрос, вызвавший ответ, который возвращал этот код ошибки.</span><span class="sxs-lookup"><span data-stu-id="0b73b-449">The BackOffMilliseconds value returned with ErrorServerBusy errors indicates to the client the amount of time it should wait until it should resubmit the request that caused the response that returned this error code.</span></span>  <br/> |
   
<span data-ttu-id="0b73b-450">В следующей таблице перечислены коды состояния HTTP, которые возвращаются ошибками регулирования.</span><span class="sxs-lookup"><span data-stu-id="0b73b-450">The following table lists the HTTP status codes that are returned by throttling errors.</span></span>
  
<span data-ttu-id="0b73b-451">**Таблица 4: коды состояния HTTP, возвращаемые ошибками регулирования**</span><span class="sxs-lookup"><span data-stu-id="0b73b-451">**Table 4: HTTP status codes returned by throttling errors**</span></span>

|<span data-ttu-id="0b73b-452">**Код состояния HTTP**</span><span class="sxs-lookup"><span data-stu-id="0b73b-452">**HTTP status code**</span></span>|<span data-ttu-id="0b73b-453">**Описание**</span><span class="sxs-lookup"><span data-stu-id="0b73b-453">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="0b73b-454">HTTP 503</span><span class="sxs-lookup"><span data-stu-id="0b73b-454">HTTP 503</span></span>  <br/> |<span data-ttu-id="0b73b-455">Указывает, что запросы EWS помещаются в очередь с IIS.</span><span class="sxs-lookup"><span data-stu-id="0b73b-455">Indicates that EWS requests are queuing with IIS.</span></span> <span data-ttu-id="0b73b-456">Клиент должен отложить отправку дополнительных запросов до следующего времени.</span><span class="sxs-lookup"><span data-stu-id="0b73b-456">The client should delay sending additional requests until a later time.</span></span>  <br/> |
|<span data-ttu-id="0b73b-457">HTTP 500</span><span class="sxs-lookup"><span data-stu-id="0b73b-457">HTTP 500</span></span>  <br/> |<span data-ttu-id="0b73b-458">Указывает на внутреннюю ошибку сервера с кодом ошибки Еррорсервербуси.</span><span class="sxs-lookup"><span data-stu-id="0b73b-458">Indicates an internal server error with the ErrorServerBusy error code.</span></span> <span data-ttu-id="0b73b-459">Это указывает на то, что клиент должен отложить отправку дополнительных запросов до следующего времени.</span><span class="sxs-lookup"><span data-stu-id="0b73b-459">This indicates that the client should delay sending additional requests until a later time.</span></span> <span data-ttu-id="0b73b-460">Ответ может содержать подсказку обратной передачи с именем Баккоффмиллисекондс.</span><span class="sxs-lookup"><span data-stu-id="0b73b-460">The response may contain a back off hint called BackOffMilliseconds.</span></span> <span data-ttu-id="0b73b-461">Если этот параметр задан, значение Баккоффмиллисекондс должно использоваться в качестве срока действия до тех пор, пока клиент не повторно выдает запрос.</span><span class="sxs-lookup"><span data-stu-id="0b73b-461">If present, the value of BackOffMilliseconds should be used as the duration until the client resubmits a request.</span></span>  <br/> |
|<span data-ttu-id="0b73b-462">HTTP 200</span><span class="sxs-lookup"><span data-stu-id="0b73b-462">HTTP 200</span></span>  <br/> |<span data-ttu-id="0b73b-463">Содержит ответ на ошибку на основе схемы EWS с кодом ошибки Ерроринтерналсервереррор.</span><span class="sxs-lookup"><span data-stu-id="0b73b-463">Contains an EWS schema-based error response with an ErrorInternalServerError error code.</span></span> <span data-ttu-id="0b73b-464">Может присутствовать внутренний код ошибки Еррорсервербуси.</span><span class="sxs-lookup"><span data-stu-id="0b73b-464">An inner ErrorServerBusy error code may be present.</span></span> <span data-ttu-id="0b73b-465">Это указывает на то, что клиент должен отложить отправку дополнительных запросов до следующего времени.</span><span class="sxs-lookup"><span data-stu-id="0b73b-465">This indicates that the client should delay sending additional requests until a later time.</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="0b73b-466">См. также</span><span class="sxs-lookup"><span data-stu-id="0b73b-466">See also</span></span>

- [<span data-ttu-id="0b73b-467">Управление рабочей нагрузкой Exchange</span><span class="sxs-lookup"><span data-stu-id="0b73b-467">Exchange Workload Management</span></span>](http://technet.microsoft.com/en-us/library/jj150503.aspx)
- [<span data-ttu-id="0b73b-468">Командлет New – ThrottlingPolicy</span><span class="sxs-lookup"><span data-stu-id="0b73b-468">New-ThrottlingPolicy cmdlet</span></span>](http://technet.microsoft.com/en-us/library/dd351045.aspx)
- [<span data-ttu-id="0b73b-469">Общие сведения о политиках регулирования клиентов</span><span class="sxs-lookup"><span data-stu-id="0b73b-469">Understanding Client Throttling Policies</span></span>](http://technet.microsoft.com/en-us/library/dd297964.aspx)
- [<span data-ttu-id="0b73b-470">Класс ThrottlingPolicy</span><span class="sxs-lookup"><span data-stu-id="0b73b-470">ThrottlingPolicy Class</span></span>](http://msdn.microsoft.com/en-us/library/ff342496%28v=EXCHG.140%29.aspx)
- [<span data-ttu-id="0b73b-471">Политики регулирования и Евсфиндкаунтлимит</span><span class="sxs-lookup"><span data-stu-id="0b73b-471">Throttling Policies and the EWSFindCountLimit</span></span>](http://blogs.msdn.com/b/exchangedev/archive/2010/03/12/throttling-policies-and-the-ewsfindcountlimit.aspx)
- [<span data-ttu-id="0b73b-472">Моментальные снимки бюджета в журналах IIS</span><span class="sxs-lookup"><span data-stu-id="0b73b-472">Budget Snapshots in the IIS Logs</span></span>](http://blogs.msdn.com/b/exchangedev/archive/2010/03/10/budget-snapshots-in-the-iis-logs.aspx)
- [<span data-ttu-id="0b73b-473">Влияние регулирования на развертывание в Exchange 2010 с пакетом обновления 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="0b73b-473">Effects of Throttling on Your Deployment in Exchange 2010 SP1</span></span>](http://msexchangeteam.com/archive/2010/08/27/456040.aspx)
- [<span data-ttu-id="0b73b-474">Связи политик регулирования в Exchange 2010 с пакетом обновления 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="0b73b-474">Throttling Policy Associations in Exchange 2010 SP1</span></span>](http://msexchangeteam.com/archive/2010/08/02/455707.aspx)
- [<span data-ttu-id="0b73b-475">Политики регулирования и Кпустартперцент</span><span class="sxs-lookup"><span data-stu-id="0b73b-475">Throttling Policies and CPUStartPercent</span></span>](http://blogs.msdn.com/b/exchangedev/archive/2010/03/11/throttling-policies-and-cpustartpercent.aspx)
- [<span data-ttu-id="0b73b-476">Олицетворение и EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="0b73b-476">Impersonation and EWS in Exchange</span></span>](impersonation-and-ews-in-exchange.md)
    

