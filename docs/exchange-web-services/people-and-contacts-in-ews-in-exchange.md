---
title: Пользователи и контакты в EWS для Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
ms.assetid: 043c33be-a0d1-4bad-a840-85715eda4813
description: Сведения о фиктивных пользователях, едином хранилище контактов и работе с контактами с помощью EWS в Exchange или управляемого API для EWS.
localization_priority: Priority
ms.openlocfilehash: f0590a0d8a99b8320cc1b316829177e05e443de6
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2020
ms.locfileid: "44457678"
---
# <a name="people-and-contacts-in-ews-in-exchange"></a><span data-ttu-id="69890-103">Пользователи и контакты в EWS для Exchange</span><span class="sxs-lookup"><span data-stu-id="69890-103">People and contacts in EWS in Exchange</span></span>

<span data-ttu-id="69890-104">Сведения о фиктивных пользователях, едином хранилище контактов и работе с контактами с помощью EWS в Exchange или управляемого API для EWS.</span><span class="sxs-lookup"><span data-stu-id="69890-104">Learn about personas, the Unified Contact Store, and how to work with contacts by using the EWS Managed API or EWS in Exchange.</span></span> 
  
<span data-ttu-id="69890-p101">Контакты — это элементы в Exchange, в которых хранится информация об отдельных людях, группах или организациях. Контакты могут включать имена, электронные адреса и другие данные, в том числе адреса для IM, физические адреса, информацию о семье и днях рождения, фотографию или изображение.</span><span class="sxs-lookup"><span data-stu-id="69890-p101">Contacts are items in Exchange that store information about an individual, group, or organization. Contacts can include names and email addresses, and other information, including IM addresses, physical addresses, birthdays, family information, and a photo or image that represents the contact.</span></span>
  
<span data-ttu-id="69890-107">Контактные данные хранятся в одном из двух расположений:</span><span class="sxs-lookup"><span data-stu-id="69890-107">Contact information is stored in one of two places:</span></span>
  
- <span data-ttu-id="69890-108">в доменных службах Active Directory (AD DS), если контакт находится в организации;</span><span class="sxs-lookup"><span data-stu-id="69890-108">Active Directory Domain Services (AD DS), if the contact is within the organization.</span></span>
    
- <span data-ttu-id="69890-109">в папке "Контакты" или другой папке почтового ящика пользователя, если контакт находится вне организации.</span><span class="sxs-lookup"><span data-stu-id="69890-109">The Contacts folder or another folder in a user's mailbox, if the contact is outside the organization.</span></span>
    
<span data-ttu-id="69890-110">Одного человека могут представлять несколько элементов контакта.</span><span class="sxs-lookup"><span data-stu-id="69890-110">Multiple contact items can represent a single individual.</span></span> <span data-ttu-id="69890-111">С помощью фиктивных пользователей в Exchange можно объединить эти различные элементы контакта.</span><span class="sxs-lookup"><span data-stu-id="69890-111">Exchange uses personas to help bring these different contact items together.</span></span> <span data-ttu-id="69890-112">*Фиктивный пользователь* сочетает в себе контактные данные из разных источников, относящиеся к одному человеку.</span><span class="sxs-lookup"><span data-stu-id="69890-112">A  *persona*  is an aggregation of contact information for the same individual from different sources.</span></span> <span data-ttu-id="69890-113">Кроме контактных данных из Exchange, фиктивные пользователи также могут содержать данные кэша получателей для почтового ящика, данные скрытой папки QuickContacts для контактов IM, а также данные сторонних источников.</span><span class="sxs-lookup"><span data-stu-id="69890-113">In addition to contact information in Exchange, personas can also be aggregated from information in the recipient cache for the mailbox, a hidden folder for IM contacts called QuickContacts, and from third-party data sources.</span></span> <span data-ttu-id="69890-114">Единое хранилище контактов в Exchange позволяет клиентам службы обмена мгновенными сообщениями использовать эти сводные данные, но только без информации из AD DS, как показано на рисунке 1.</span><span class="sxs-lookup"><span data-stu-id="69890-114">The Unified Contact Store in Exchange enables IM clients to use this aggregation; the only difference is that the Unified Contact Store does not aggregate information from AD DS, as shown in Figure 1.</span></span> 
  
<span data-ttu-id="69890-115">**Рис. 1. Источники контактных данных для фиктивных пользователей и единого хранилища контактов**</span><span class="sxs-lookup"><span data-stu-id="69890-115">**Figure 1. Contact information sources for personas and for the Unified Contact Store**</span></span>

![Изображение с источниками, объединенными в пользователей, и источниками, включенными в единое хранилище контактов. Единое хранилище контактов не объединяет контактные данные из службы каталогов.](media/EX15_PersonaOverview.png)
  
<span data-ttu-id="69890-118">**Таблица 1. Методы управляемого API EWS и операции EWS для работы с контактами**</span><span class="sxs-lookup"><span data-stu-id="69890-118">**Table 1. EWS Managed API methods and EWS operations for working with contacts**</span></span>

|<span data-ttu-id="69890-119">**Задача**</span><span class="sxs-lookup"><span data-stu-id="69890-119">**If you want to…**</span></span>|<span data-ttu-id="69890-120">**Используйте этот метод управляемого API EWS**</span><span class="sxs-lookup"><span data-stu-id="69890-120">**Use this EWS Managed API method**</span></span>|<span data-ttu-id="69890-121">**Используйте эту операцию EWS**</span><span class="sxs-lookup"><span data-stu-id="69890-121">**Use this EWS operation**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="69890-122">Создать контакт</span><span class="sxs-lookup"><span data-stu-id="69890-122">Create a new contact</span></span>  <br/> |<span data-ttu-id="69890-123">Создать новый экземпляр объекта [Contact](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact%28v=exchg.80%29.aspx) и использовать свойство [Contact.Save](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="69890-123">Instantiate a new [Contact](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact%28v=exchg.80%29.aspx) object, and use [Contact.Save](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx)</span></span> <br/> |[<span data-ttu-id="69890-124">CreateItem</span><span class="sxs-lookup"><span data-stu-id="69890-124">CreateItem</span></span>](https://msdn.microsoft.com/library/417e994b-0a17-4c24-9527-04796b80b029%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="69890-125">Копировать контакт</span><span class="sxs-lookup"><span data-stu-id="69890-125">Copy a contact</span></span>  <br/> |[<span data-ttu-id="69890-126">Contact.Copy</span><span class="sxs-lookup"><span data-stu-id="69890-126">Contact.Copy</span></span>](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.copy%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="69890-127">CopyItem</span><span class="sxs-lookup"><span data-stu-id="69890-127">CopyItem</span></span>](https://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="69890-128">Переместить контакт</span><span class="sxs-lookup"><span data-stu-id="69890-128">Move a contact</span></span>  <br/> |[<span data-ttu-id="69890-129">Contact.Move</span><span class="sxs-lookup"><span data-stu-id="69890-129">Contact.Move</span></span>](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.move%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="69890-130">MoveItem</span><span class="sxs-lookup"><span data-stu-id="69890-130">MoveItem</span></span>](https://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="69890-131">Обновить существующий контакт</span><span class="sxs-lookup"><span data-stu-id="69890-131">Update an existing contact</span></span>  <br/> |<span data-ttu-id="69890-132">[Contact.Bind](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) и [Contact.Update](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.update%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="69890-132">[Contact.Bind](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) and [Contact.Update](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.update%28v=exchg.80%29.aspx)</span></span> <br/> |[<span data-ttu-id="69890-133">UpdateItem</span><span class="sxs-lookup"><span data-stu-id="69890-133">UpdateItem</span></span>](https://msdn.microsoft.com/library/298fdd71-a83d-4407-9728-4f0a8e2d857c%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="69890-134">Удалить контакт</span><span class="sxs-lookup"><span data-stu-id="69890-134">Delete a contact</span></span>  <br/> |<span data-ttu-id="69890-135">[Contact.Bind](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) и [Contact.Delete](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.delete%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="69890-135">[Contact.Bind](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) and [Contact.Delete](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.delete%28v=exchg.80%29.aspx)</span></span> <br/> |[<span data-ttu-id="69890-136">DeleteItem</span><span class="sxs-lookup"><span data-stu-id="69890-136">DeleteItem</span></span>](../web-service-reference/deleteitem-operation.md) <br/> |
|<span data-ttu-id="69890-137">Найти контакт</span><span class="sxs-lookup"><span data-stu-id="69890-137">Search for a contact</span></span>  <br/> |[<span data-ttu-id="69890-138">ExchangeService.FindItems</span><span class="sxs-lookup"><span data-stu-id="69890-138">ExchangeService.FindItems</span></span>](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="69890-139">FindItem</span><span class="sxs-lookup"><span data-stu-id="69890-139">FindItem</span></span>](https://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="69890-140">Найти пользователей</span><span class="sxs-lookup"><span data-stu-id="69890-140">Search for people</span></span>  <br/> |<span data-ttu-id="69890-141">Н/Д</span><span class="sxs-lookup"><span data-stu-id="69890-141">N/A</span></span>  <br/> |[<span data-ttu-id="69890-142">FindPeople</span><span class="sxs-lookup"><span data-stu-id="69890-142">FindPeople</span></span>](https://msdn.microsoft.com/library/446106b7-ff2d-4107-90c1-29f4d38ba128%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="69890-143">Развернуть группу рассылки</span><span class="sxs-lookup"><span data-stu-id="69890-143">Expand a distribution group</span></span>  <br/> |[<span data-ttu-id="69890-144">ExchangeService.ExpandGroup</span><span class="sxs-lookup"><span data-stu-id="69890-144">ExchangeService.ExpandGroup</span></span>](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.exchangeservice.expandgroup%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="69890-145">ExpandDL</span><span class="sxs-lookup"><span data-stu-id="69890-145">ExpandDL</span></span>](https://msdn.microsoft.com/library/1f7837e7-9eff-4e10-9577-c40f7ed6af94%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="69890-146">Устранить неоднозначность имени</span><span class="sxs-lookup"><span data-stu-id="69890-146">Resolve an ambiguous name</span></span>  <br/> |[<span data-ttu-id="69890-147">ExchangeService.ResolveName</span><span class="sxs-lookup"><span data-stu-id="69890-147">ExchangeService.ResolveName</span></span>](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.exchangeservice.resolvename%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="69890-148">ResolveNames</span><span class="sxs-lookup"><span data-stu-id="69890-148">ResolveNames</span></span>](https://msdn.microsoft.com/library/6b4eb4b3-9ad6-4804-a09f-7e20cfea4dbb%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="69890-149">Получить фиктивного пользователя</span><span class="sxs-lookup"><span data-stu-id="69890-149">Get a persona</span></span>  <br/> |<span data-ttu-id="69890-150">Н/Д</span><span class="sxs-lookup"><span data-stu-id="69890-150">N/A</span></span>  <br/> |[<span data-ttu-id="69890-151">GetPersona</span><span class="sxs-lookup"><span data-stu-id="69890-151">GetPersona</span></span>](https://msdn.microsoft.com/library/e2146df0-53d0-4caf-9758-b600bbc14b6a%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="69890-152">Обработать фотографии контакта</span><span class="sxs-lookup"><span data-stu-id="69890-152">Work with contact photos</span></span>  <br/> |<span data-ttu-id="69890-153">[Contact.SetContactPicture](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.setcontactpicture%28v=exchg.80%29.aspx), [Contact.GetContactPictureAttachment](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.getcontactpictureattachment%28v=exchg.80%29.aspx) или [Contact.RemoveContactPicture](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.setcontactpicture%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="69890-153">[Contact.SetContactPicture](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.setcontactpicture%28v=exchg.80%29.aspx), [Contact.GetContactPictureAttachment](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.getcontactpictureattachment%28v=exchg.80%29.aspx), or [Contact.RemoveContactPicture](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.contact.setcontactpicture%28v=exchg.80%29.aspx)</span></span> <br/> |<span data-ttu-id="69890-154">[GetUserPhoto](https://msdn.microsoft.com/library/f6e8143d-4235-428e-8f9c-ab6e9b1cfa6e%28Office.15%29.aspx) или [GetAttachment](https://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="69890-154">[GetUserPhoto](https://msdn.microsoft.com/library/f6e8143d-4235-428e-8f9c-ab6e9b1cfa6e%28Office.15%29.aspx) or [GetAttachment](https://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx)</span></span> <br/> |
   
## <a name="personas"></a><span data-ttu-id="69890-155">Фиктивные пользователи</span><span class="sxs-lookup"><span data-stu-id="69890-155">Personas</span></span>
<span data-ttu-id="69890-156"><a name="PEOPLESEARCH"> </a></span><span class="sxs-lookup"><span data-stu-id="69890-156"><a name="PEOPLESEARCH"> </a></span></span>

<span data-ttu-id="69890-p104">До недавних пор контакты обычно сохранялись централизованно (как правило, в почтовом клиенте). Сейчас контакты все чаще сохраняются в различных расположениях (например, на телефоне, сайте социальной сети, в папке "Контакты" почтового ящика Exchange или службе каталогов организации). Из-за размещения контактных данных в различных расположениях несколько контактов, представляющих одного и того же человека, могут включать неодинаковые сведения. Например, один контакт может содержать рабочий номер телефона, а другой — личный. Имя контакта, сохраненного в папке "Контакты", может также отличаться от имени контакта, сохраненного на телефоне.</span><span class="sxs-lookup"><span data-stu-id="69890-p104">Until recently, contacts were commonly stored in a single location — typically, on an email client. Today, it is becoming more common to store contacts in many different locations, such as on a phone, on a social networking site, in a Contacts folder in an Exchange mailbox, or in an organization's directory service. With the proliferation of contact information, it's possible that multiple contacts that represent the same person contain different information; for example, one contact might include a business phone number and another a personal phone number, or a contact stored in a Contacts folder might have a different name than the contact for the same person that is stored on your phone.</span></span>
  
<span data-ttu-id="69890-160">В Exchange Online (как автономной службе, так и службе в составе Office 365) и локальных версиях Exchange, начиная с Exchange 2013, контакты из разных источников, представляющие одного и того же человека, сопоставлены друг с другом подобно электронным сообщениям, объединенным в беседы, с помощью общих идентификаторов связи.</span><span class="sxs-lookup"><span data-stu-id="69890-160">In Exchange Online, Exchange Online as part of Office 365, and on-premises versions of Exchange starting with Exchange 2013, contacts from different sources that represent the same person are associated with one another, similar to the way that email messages are aggregated into conversations, by means of a common link ID.</span></span> <span data-ttu-id="69890-161">Когда сервер Exchange Server возвращает объединенные контактные данные, они включают набор атрибутов для каждого контакта, таких как исходная папка, отображаемое имя, идентификатор источника и другой идентификатор.</span><span class="sxs-lookup"><span data-stu-id="69890-161">When aggregated contact information is returned by an Exchange server, it includes a set of attributes for each contact, such as a source folder, a display name, an ID, and a source ID.</span></span> <span data-ttu-id="69890-162">Все возвращенные свойства и атрибуты в целом — это фиктивный пользователь, а набор возвращенных свойств — [форма фиктивного пользователя](https://msdn.microsoft.com/library/61d87cd5-3270-40d1-bab7-d0d5bf938607%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="69890-162">The sum of the properties and attributes returned is known as a persona, and the set of properties returned is referred to as the [persona's shape](https://msdn.microsoft.com/library/61d87cd5-3270-40d1-bab7-d0d5bf938607%28Office.15%29.aspx).</span></span>
  
<span data-ttu-id="69890-p106">Так как данные, составляющие фиктивного пользователя, не хранятся централизованно и их можно изменить в любое время, фиктивный пользователь создается, только если вы отправляете запрос серверу Exchange Server. Чтобы отправить запрос на поиск фиктивного пользователя, используйте операцию [FindPeople](https://msdn.microsoft.com/library/446106b7-ff2d-4107-90c1-29f4d38ba128%28Office.15%29.aspx) EWS. Этот запрос может предусматривать применение фильтрования по строке запроса и порядка сортировки к результатам, чтобы облегчить поиск нужного пользователя. Например, вы можете извлечь отображаемое имя и набор всех электронных адресов, сопоставленных с определенным контактом, из папки "Контакты", учетной записи Hotmail или LinkedIn, а также службы каталогов компании. Можно также извлечь набор всех фиктивных пользователей, у которых есть адреса для IM. Связывание контактов для создания фиктивных пользователей происходит автоматически. При этом используется алгоритм, распознающий отношения между контактами, которые сохранены на различных устройствах. </span><span class="sxs-lookup"><span data-stu-id="69890-p106">Because the information that makes up a persona is not stored in a single location, and because that information can change at any time, a persona is created only when you make a request to an Exchange server. You use the [FindPeople](https://msdn.microsoft.com/library/446106b7-ff2d-4107-90c1-29f4d38ba128%28Office.15%29.aspx) EWS operation to make a persona search request. Your request can include a sort order, and can be filtered according to a query string to help you find the correct persona by ordering and filtering the results. For example, you can retrieve the display name and a set of all email addresses that are associated with a specific contact from the Contacts folder, a Hotmail account, a LinkedIn account, and a company's directory service, or you can retrieve a set of all personas that have IM addresses. The linking of contacts into personas is automatic based on an algorithm that recognizes a relationship between contacts stored on various devices.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="69890-168">Управляемый API EWS не реализует эту функцию.</span><span class="sxs-lookup"><span data-stu-id="69890-168">The EWS Managed API does not implement this functionality.</span></span> 
  
<span data-ttu-id="69890-169">**Таблица 2. Операции EWS для работы с фиктивными пользователями**</span><span class="sxs-lookup"><span data-stu-id="69890-169">**Table 2. EWS operations for working with personas**</span></span>

|<span data-ttu-id="69890-170">**Имя операции**</span><span class="sxs-lookup"><span data-stu-id="69890-170">**Operation name**</span></span>|<span data-ttu-id="69890-171">**Описание**</span><span class="sxs-lookup"><span data-stu-id="69890-171">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="69890-172">FindPeople</span><span class="sxs-lookup"><span data-stu-id="69890-172">FindPeople</span></span>](https://msdn.microsoft.com/library/446106b7-ff2d-4107-90c1-29f4d38ba128%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-173">Возвращает всех доступных фиктивных пользователей из указанной папки контактов или извлекает контакты, которые соответствуют заданной строке запроса.</span><span class="sxs-lookup"><span data-stu-id="69890-173">Returns all available personas from a specified contacts folder or retrieves contacts that match a specified query string.</span></span>  <br/> |
|[<span data-ttu-id="69890-174">GetPersona</span><span class="sxs-lookup"><span data-stu-id="69890-174">GetPersona</span></span>](https://msdn.microsoft.com/library/e2146df0-53d0-4caf-9758-b600bbc14b6a%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-175">Возвращает набор свойств, сопоставленных с определенным фиктивным пользователем, таких как все адреса для IM или отображаемые имена, по указанному идентификатору фиктивного пользователя.</span><span class="sxs-lookup"><span data-stu-id="69890-175">Returns a set of properties associated with a specific persona, such as all the IM addresses or display names for a specified persona ID.</span></span>  <br/> |
   
<span data-ttu-id="69890-p107">Вы можете использовать операции **GetPersona** и **FindPeople** для эффективного извлечения контактных данных из нескольких источников. Так как все элементы, которые относятся к фиктивному пользователю, сопоставлены с идентификатором связи, эти операции можно применять ко множеству приложений, использующих контактные данные. Вот несколько примеров:</span><span class="sxs-lookup"><span data-stu-id="69890-p107">You can use the **GetPersona** and **FindPeople** operations to efficiently retrieve contact information from multiple sources. Because all items related to a persona are associated with a link ID, you can use these operations in a wide variety of applications that use contact data. The following are some examples:</span></span> 
  
- <span data-ttu-id="69890-179">Приложение на мобильном телефоне, которое использует операцию **GetPersona**, когда пользователь звонит контакту, после чего предлагает дополнительные номера телефонов, если никто не отвечает.</span><span class="sxs-lookup"><span data-stu-id="69890-179">A mobile phone app that uses the **GetPersona** operation when a user calls a contact, and then offers additional phone numbers to call if no one answers.</span></span> 
    
- <span data-ttu-id="69890-p108">Приложение, с помощью операции **FindPeople** проверяющее, есть ли в электронных адресах сообщений из папки "Входящие" такие, которые включены в существующего фиктивного пользователя. Адреса, уже не сопоставленные с фиктивным пользователем, можно использовать для оформления потенциальных клиентов или создания списка всех недавних бесед с человеком, который представлен этим пользователем.</span><span class="sxs-lookup"><span data-stu-id="69890-p108">An application that uses the **FindPeople** operation to scan Inbox messages for email addresses to determine whether they are found in an existing persona. Addresses that are not already associated with a persona can be used to create sales leads or list all recent communications with the person represented by that persona.</span></span> 
    
- <span data-ttu-id="69890-p109">[Почтовое приложение для Outlook](mail-apps-for-outlook-and-ews-in-exchange.md), в котором доступны различные варианты приветствия в зависимости от того, формальна переписка или нет. Формальные приветствия предоставляются с учетом отображаемых имен из службы каталогов, а неформальные — с учетом отображаемых имен из социальной сети.</span><span class="sxs-lookup"><span data-stu-id="69890-p109">[A mail app for Outlook](mail-apps-for-outlook-and-ews-in-exchange.md) that offers different salutations based on whether correspondence is formal or informal. Formal salutations are supplied by the display names from the directory service and informal salutations come from the display name that originates in social network contacts.</span></span> 
    
## <a name="unified-contact-store"></a><span data-ttu-id="69890-184">Единое хранилище контактов</span><span class="sxs-lookup"><span data-stu-id="69890-184">Unified Contact Store</span></span>
<span data-ttu-id="69890-185"><a name="PEOPLESEARCH"> </a></span><span class="sxs-lookup"><span data-stu-id="69890-185"><a name="PEOPLESEARCH"> </a></span></span>

<span data-ttu-id="69890-p110">Фиктивные пользователи доступны не только в почтовом клиенте. Если вы разрабатываете клиент для обмена мгновенными сообщениями, задайте себе такие вопросы (можно все):</span><span class="sxs-lookup"><span data-stu-id="69890-p110">Personas aren't just limited to an email client. If you're developing an IM client, you might ask yourself any or all of the following:</span></span>
  
- <span data-ttu-id="69890-188">Как обеспечить клиентские приложения Lync стандартным набором элементов контакта для IM?</span><span class="sxs-lookup"><span data-stu-id="69890-188">How can I provision Lync client applications with a default set of IM contact items?</span></span>
    
- <span data-ttu-id="69890-189">Как управлять списками групп и контактов для IM?</span><span class="sxs-lookup"><span data-stu-id="69890-189">How do I manage IM contact and group lists?</span></span>
    
- <span data-ttu-id="69890-190">Как управлять специальным клиентским доступом Lync к контактам и группам для IM?</span><span class="sxs-lookup"><span data-stu-id="69890-190">How do I manage custom Lync client access to IM contacts and IM groups?</span></span>
    
<span data-ttu-id="69890-p111">Единое хранилище контактов незаметно работает в Exchange, объединяя контактные данные из Exchange и других источников в единую сущность (создавая фиктивного пользователя). Хотя операции EWS, которые вы используете для доступа к единому хранилищу контактов, касаются только контактов для IM, с помощью этого хранилища в Exchange можно работать с фиктивными пользователями в приложениях всех типов. Помните, что у единого хранилища контактов нет доступа к контактным данным AD DS.</span><span class="sxs-lookup"><span data-stu-id="69890-p111">The Unified Contact Store works behind the scenes in Exchange to aggregate contact data from Exchange and other sources into a single entity, or persona. Although the EWS operations that you use to access the Unified Contact Store are specific to IM contacts, You can use the Unified Contact Store in Exchange to work with personas in all types of applications. Keep in mind that the Unified Contact Store cannot access contact data AD DS.</span></span>
  
<span data-ttu-id="69890-p112">Контакты для IM хранятся в скрытой папке QuickContacts. С помощью операций **AddNewImContactToGroup** и **AddImContactToGroup** можно добавить контакты в группы, которые хранятся в этой скрытой папке. Так как с помощью единого хранилища контактов можно группировать контакты для IM, стало проще обновлять группы контактов и получать к ним доступ.</span><span class="sxs-lookup"><span data-stu-id="69890-p112">IM contacts are stored in a hidden folder called QuickContacts. You can use the **AddNewImContactToGroup** and **AddImContactToGroup** operations to add contacts to groups that are stored in this hidden folder. And because you can use the Unified Contact Store to group IM contacts, you can access and update groups of contacts more easily.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="69890-197">Управляемый API EWS не реализует эту функцию.</span><span class="sxs-lookup"><span data-stu-id="69890-197">The EWS Managed API does not implement this functionality.</span></span> 
  
<span data-ttu-id="69890-198">**Таблица 3. Операции EWS для доступа к единому хранилищу контактов**</span><span class="sxs-lookup"><span data-stu-id="69890-198">**Table 3. EWS operations for accessing the Unified Contact Store**</span></span>

|<span data-ttu-id="69890-199">**Имя операции**</span><span class="sxs-lookup"><span data-stu-id="69890-199">**Operation name**</span></span>|<span data-ttu-id="69890-200">**Описание**</span><span class="sxs-lookup"><span data-stu-id="69890-200">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="69890-201">AddNewImContactToGroup</span><span class="sxs-lookup"><span data-stu-id="69890-201">AddNewImContactToGroup</span></span>](https://msdn.microsoft.com/library/0cb5525f-faa3-48f1-9551-df55ffc26f46%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-202">Добавляет новый контакт для IM в группу для IM (количество контактов не должно превышать 1000).</span><span class="sxs-lookup"><span data-stu-id="69890-202">Adds a new IM contact to an IM group, up to a maximum of 1000 contacts.</span></span>  <br/> |
|[<span data-ttu-id="69890-203">AddImContactToGroup</span><span class="sxs-lookup"><span data-stu-id="69890-203">AddImContactToGroup</span></span>](https://msdn.microsoft.com/library/376acc42-2684-4596-aca1-82a4a10865c9%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-204">Добавляет существующий контакт для IM в группу для IM (количество контактов не должно превышать 1000).</span><span class="sxs-lookup"><span data-stu-id="69890-204">Adds an existing IM contact to an IM group, up to a maximum of 1000 contacts.</span></span>  <br/> |
|[<span data-ttu-id="69890-205">AddImGroup</span><span class="sxs-lookup"><span data-stu-id="69890-205">AddImGroup</span></span>](https://msdn.microsoft.com/library/6df6e504-b7c8-4773-b10f-ffa5defac229%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-206">Добавляет новую группу для IM (максимальное количество групп — 64).</span><span class="sxs-lookup"><span data-stu-id="69890-206">Adds a new IM group, up to a maximum of 64 groups.</span></span>  <br/> |
|[<span data-ttu-id="69890-207">AddDistributionGroupToImList</span><span class="sxs-lookup"><span data-stu-id="69890-207">AddDistributionGroupToImList</span></span>](https://msdn.microsoft.com/library/5aa9bec8-71cf-4a6e-8ec8-b4965b40fd4a%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-208">Добавляет новую группу рассылки в группу для IM (максимальное количество групп — 64).</span><span class="sxs-lookup"><span data-stu-id="69890-208">Adds a new distribution group to an IM group, up to a maximum of 64 groups.</span></span>  <br/> |
|[<span data-ttu-id="69890-209">GetImItemList</span><span class="sxs-lookup"><span data-stu-id="69890-209">GetImItemList</span></span>](https://msdn.microsoft.com/library/e31d14e1-0c1f-4b69-98b7-157d59c13698%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-210">Получает список групп для IM и фиктивных пользователей, включающих контакты для IM.</span><span class="sxs-lookup"><span data-stu-id="69890-210">Retrieves a list of IM groups and IM contact personas.</span></span>  <br/> |
|[<span data-ttu-id="69890-211">GetImItems</span><span class="sxs-lookup"><span data-stu-id="69890-211">GetImItems</span></span>](https://msdn.microsoft.com/library/51186691-46d2-4d5c-b8bc-4ee2bb20fbe7%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-212">Получает сведения о конкретных группах для IM и фиктивных пользователях, включающих контакты для IM.</span><span class="sxs-lookup"><span data-stu-id="69890-212">Retrieves information about specific IM groups and IM contact personas.</span></span>  <br/> |
|[<span data-ttu-id="69890-213">RemoveContactFromImList</span><span class="sxs-lookup"><span data-stu-id="69890-213">RemoveContactFromImList</span></span>](https://msdn.microsoft.com/library/28ec96c3-45af-48ff-9f17-718a527dc0ad%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-214">Удаляет контакт из группы для IM.</span><span class="sxs-lookup"><span data-stu-id="69890-214">Removes a contact from an IM group.</span></span>  <br/> |
|[<span data-ttu-id="69890-215">RemoveImContactFromGroup</span><span class="sxs-lookup"><span data-stu-id="69890-215">RemoveImContactFromGroup</span></span>](https://msdn.microsoft.com/library/a190bbec-c71b-4e6a-880b-55854c724d8c%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-216">Удаляет контакт для IM из группы для IM.</span><span class="sxs-lookup"><span data-stu-id="69890-216">Removes an IM contact from an IM group.</span></span>  <br/> |
|[<span data-ttu-id="69890-217">RemoveDistributionGroupFromImList</span><span class="sxs-lookup"><span data-stu-id="69890-217">RemoveDistributionGroupFromImList</span></span>](https://msdn.microsoft.com/library/252bddf2-98b6-4824-b548-2fba2bda5384%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-218">Удаляет группу рассылки из группы для IM.</span><span class="sxs-lookup"><span data-stu-id="69890-218">Removes a distribution group from an IM group.</span></span>  <br/> |
|[<span data-ttu-id="69890-219">RemoveImGroup</span><span class="sxs-lookup"><span data-stu-id="69890-219">RemoveImGroup</span></span>](https://msdn.microsoft.com/library/5e788016-68e0-4a3f-9243-03f6b6c6b389%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-220">Удаляет группу для IM.</span><span class="sxs-lookup"><span data-stu-id="69890-220">Removes an IM group.</span></span>  <br/> |
|[<span data-ttu-id="69890-221">SetImGroup</span><span class="sxs-lookup"><span data-stu-id="69890-221">SetImGroup</span></span>](https://msdn.microsoft.com/library/2d48aa07-8152-4c3d-a519-061253e80174%28Office.15%29.aspx) <br/> |<span data-ttu-id="69890-222">Изменяет отображаемое имя группы для IM.</span><span class="sxs-lookup"><span data-stu-id="69890-222">Changes the display name of an IM group.</span></span>  <br/> |
   
## <a name="in-this-section"></a><span data-ttu-id="69890-223">В этой статье</span><span class="sxs-lookup"><span data-stu-id="69890-223">In this section</span></span>
<span data-ttu-id="69890-224"><a name="PEOPLESEARCH"> </a></span><span class="sxs-lookup"><span data-stu-id="69890-224"><a name="PEOPLESEARCH"> </a></span></span>

- [<span data-ttu-id="69890-225">Пакетная обработка контактов с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="69890-225">Process contacts in batches by using EWS in Exchange</span></span>](how-to-process-contacts-in-batches-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="69890-226">Устранение неоднозначности имен с помощью EWS в Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="69890-226">Resolve ambiguous names by using EWS in Exchange 2013</span></span>](how-to-resolve-ambiguous-names-by-using-ews-in-exchange-2013.md)
    
- [<span data-ttu-id="69890-227">Получение фотографий пользователей с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="69890-227">Get user photos by using EWS in Exchange</span></span>](how-to-get-user-photos-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="69890-228">См. также</span><span class="sxs-lookup"><span data-stu-id="69890-228">See also</span></span>
<span data-ttu-id="69890-229"><a name="PEOPLESEARCH"> </a></span><span class="sxs-lookup"><span data-stu-id="69890-229"><a name="PEOPLESEARCH"> </a></span></span>

- [<span data-ttu-id="69890-230">Разработка клиентов веб-служб для Exchange</span><span class="sxs-lookup"><span data-stu-id="69890-230">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="69890-231">Начало работы с веб-службами Exchange</span><span class="sxs-lookup"><span data-stu-id="69890-231">Start using web services in Exchange</span></span>](start-using-web-services-in-exchange.md)
    
- [<span data-ttu-id="69890-232">Общие сведения о разработке клиента EWS для Exchange</span><span class="sxs-lookup"><span data-stu-id="69890-232">EWS client design overview for Exchange</span></span>](ews-client-design-overview-for-exchange.md)
    

