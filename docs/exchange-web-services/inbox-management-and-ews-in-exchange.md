---
title: Управление папкой "Входящие" и веб-службы Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 3dfa0fc9-64bb-4d18-bff7-bf6b3bed4a0d
description: Узнайте, как управлять папкой "Входящие" в приложении, использующем управляемый API EWS или веб-службы Exchange, с помощью правил для папки "Входящие" и списка заблокированных отправителей.
ms.openlocfilehash: fe06c5ee87e2679506ca7247c5fc2c96912dee86
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "19761135"
---
# <a name="inbox-management-and-ews-in-exchange"></a>Управление папкой "Входящие" и веб-службы Exchange

Узнайте, как управлять папкой "Входящие" в приложении, использующем управляемый API EWS или веб-службы Exchange, с помощью правил для папки "Входящие" и списка заблокированных отправителей.
  
Почтовые ящики Exchange оснащены функциями, помогающими пользователям автоматически упорядочивать входящую почту. Все эти функции работают на сервере без участия пользователя, но предназначены для разных целей. Управляемый API EWS и веб-службы Exchange предоставляют доступ к этим функциям, позволяя вашим пользователям управлять своими папками "Входящие".
  
**В таблице 1. Функции управления папки "Входящие"**

|**Если вы хотите...**|**Используйте...**|
|:-----|:-----|
|Выполнение действий с входящими сообщениями (например, перенос в другую папку или удаление) на основе определенных условий (например, имени отправителя, темы или вложений)  <br/> |Правила для папки "Входящие"  <br/> |
|Удаление всех входящих сообщений от определенного отправителя  <br/> |Список заблокированных отправителей  <br/> |
   
## <a name="inbox-rules"></a>Правила для папки "Входящие"
<a name="bk_InboxRules"> </a>

Надо признать, не все электронные сообщения одинаково полезны. На каждое сообщение от начальника приходится по одному обновлению списка рассылки, от которого вы постоянно забываете отписаться. Хотя такие письма и интересны, списки рассылки используют огромное количество трафика, а важные сообщения запросто могут затеряться среди них в папке "Входящие". Чтобы сократить количество подобных сообщений, многие пользователи применяют правила для папки "Входящие". В результате папка приобретает намного более аккуратный вид. Приложение может применять такие правила с помощью веб-служб Exchange (EWS).
  
Управляемый API веб-служб Exchange предоставляет методы [ExchangeService.GetInboxRules](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.getinboxrules%28v=exchg.80%29.aspx) и [ExchangeService.UpdateInboxRules](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.updateinboxrules%28v=exchg.80%29.aspx) для работы с правилами. Веб-служб Exchange предоставляет операции [GetInboxRules](http://msdn.microsoft.com/library/b4b2701a-4a23-4acc-8c75-19f7955ad7ae%28Office.15%29.aspx) и [UpdateInboxRules](http://msdn.microsoft.com/library/f982a237-471e-45c5-a2b5-468cfc53150b%28Office.15%29.aspx) для работы с правилами. Тем не менее Обратите внимание на то, что управляемый API EWS и веб-служб Exchange, обладают следующими ограничениями при работе с помощью правил папки "Входящие": 
  
- Веб-службы Exchange не могут использовать и создавать правила "только для клиентов" или правила, настроенные в Outlook для работы только на текущем компьютере.
    
- Чтобы изменить текущий набор правил с помощью веб-служб Exchange, необходимо удалить большой двоичный объект правил Outlook (если он существует). Это означает, что при изменении правил с помощью веб-служб Exchange удаляются все правила, отключенные ранее с помощью Outlook.  
    
### <a name="how-do-rules-work"></a>Как работают правила?
<a name="bk_HowRulesWork"> </a>

Обработчик правил действует как Привратник для почтового ящика пользователя. При получении сообщения в почтовом ящике пользователя, но до появления сообщения в папке "Входящие", это сообщение сравнивается упорядоченный список правил. Обратите внимание на то, что это происходит только во время поступления и только в папке "Входящие". Эти правила состоят из трех частей: [условия](#bk_Conditions), [действия](#bk_Actions)и [исключения](#bk_Exceptions).
  
Начиная с правила в начале списка, обработчик правил выполняет указанные ниже действия, пока не будет достигнут конец списка.
  
1. Проверка соответствия сообщения всем условиям, указанным в правиле.
    
1. Если сообщение соответствует всем условиям, обработчик правил переходит к этапу 2.
    
2. Если же сообщение соответствует не всем условиям, обработчик правил загружает следующее правило в списке и повторяет этап 1.
    
2. Проверка соответствия сообщения каким-либо из условий, указанных в правиле.
    
1. Если сообщение соответствует какому-либо из исключений, обработчик правил загружает следующее правило в списке и повторяет этап 1.
    
2. Если же сообщение не соответствует ни одному из исключений, обработчик переходит к этапу 3.
    
3. Выполнение с сообщением действий, указанных в правиле.
    
1. Если указано действие "Остановить обработку других правил", обработчик правил выполняет с сообщением все остальные действия, а затем завершает работу, не сопоставляя сообщение с другими правилами.
    
2. Если действие "Остановить обработку других правил" не указано, обработчик правил загружает следующее правило из списка и заново начинает работу с этапа 1.
    
На приведенном ниже рисунке показан процесс работы обработчика правил.
  
**На рисунке 1: Общие сведения о правилах модуля**

![Диаграмма, на которой показаны шаги, используемые модулем правил, начиная с оценки правила, проверки выполнения критериев и выполнения действия или перехода к следующему правило до завершения процесса.](media/Ex15_Rules_EngineOverview.png)
  
### <a name="putting-the-pieces-together---parts-of-a-rule"></a>Объединения компоненты - частей правила
<a name="bk_Pieces"> </a>

Одним из способов для визуализации части правило — Предположим, что вы предоставляете инструкции для человека, который получает задачу Упорядочение параметров входящей электронной почты. Можно сказать для этого пользователя: «при поступлении сообщения \<Вставьте здесь условий\>, выполните \<Вставьте здесь действия\>, если сообщение \<Вставьте здесь исключения\>. Давайте рассмотрим более подробно каждая часть.
  
#### <a name="conditions"></a>Условия
<a name="bk_Conditions"> </a>

[Условия](http://msdn.microsoft.com/library/f049a48c-9585-43f7-8549-0b8cb19a5eea%28Office.15%29.aspx) описывается, когда требуется применить правило. Можно опустить условиям правила (приведет к правило, которое применяется к каждому сообщению получено), он гораздо более общие для правил, чтобы иметь условия, которые применяются к подмножеству входящих сообщений. Примеры: «при использовании сообщение из Sadie» или «когда сообщение отправлено в список рассылки «Кошка Lovers видео»». Правила могут иметь несколько условий. Если правила имеют более одного условия, чтобы обработчик правил указанного действия должны быть выполнены все условия. 
  
#### <a name="actions"></a>Действия
<a name="bk_Actions"> </a>

[Действия](http://msdn.microsoft.com/library/c5aa96b1-2d8b-422f-8c2f-f118572ab23f%28Office.15%29.aspx) описывают, что происходит, когда применяется правило. Примерами являются «переместить сообщение в папку «Кошки»» или «пометить сообщение с «Низкий» важность». Правила могут иметь несколько действий. При указании нескольких действий для правила выполнены все действия, когда правило будет применяться. 
  
#### <a name="exceptions"></a>Исключения
<a name="bk_Exceptions"> </a>

[Исключения](http://msdn.microsoft.com/library/7cd63ac2-3441-4ed4-915b-6f90af4b28fc%28Office.15%29.aspx) описаны при правило не применяется, даже при выполнении условий, указанных в условиях. Примеры: «за исключением, если сообщение отправляется только для меня» или «за исключением Если сообщение получено от Mom». Правило может иметь несколько исключений. Если правила имеют более одного исключение, и выполняются какие-либо исключения, правило не применяется. 
  
### <a name="example-herding-those-cats"></a>Пример. "Кошки не пройдут"
<a name="bk_Example"> </a>

Посмотрим, как с помощью правил пользователи могут избежать проблем с трафиком, создаваемых списком рассылки с видео про кошек. Сделаем следующие предположения:
  
- Эти сообщения отправляются в список рассылки под названием "Любители кошек".
    
- Пользователям необходимо прочитать эти сообщения в конечном счете, просто не требуется их переполнения папки входящих сообщений. Они будут вместо хранить их в папку с именем «Кошки».
    
- Но пользователи хотят сразу читать сообщения, отправленные в этот список рассылки их мамами, ведь мама всегда находит самые забавные видео.
    
Обработчику правил задается следующая установка: "Когда приходит сообщение, отправленное в список рассылки «Любители кошек», переместить его в папку «Кошки», если это сообщение не от мамы".  
  
**В таблице 2. Определение правила**

|**Часть "правила"**|**Значение**|
|:-----|:-----|
|Условия  <br/> |Отправлено в список рассылки "Любители кошек"  <br/> |
|Действия  <br/> |Переместить сообщение в папку "Кошки"  <br/> И остановить обработку других правил  <br/> |
|Исключения  <br/> |Отправитель сообщения — "Мама"  <br/> |
   
> [!NOTE]
> Обратите внимание, что полученное в итоге правило содержит действие "Остановить обработку других правил". Как правило, рекомендуется добавлять это действие, чтобы избежать путаницы с правилами, применяемыми к тому или иному сообщению. Тем не менее, пропустив это действие и правильно упорядочив правила, можно добиться более точной обработки входящей почты. В данном случае можно с уверенностью сказать, что для видео с кошками не требуется тщательной обработки. 
  
Вскоре после создания этого правила поступает новое сообщение. Ваша коллега, Лилия, отправляет сообщение в список рассылки. Мысленно выполнив работу обработчика правил, мы увидим, что сообщение отвечает всем условиям (оно отправлено в список рассылки "Любители кошек") и не попадает ни под одно из исключений (оно не отправлено мамой), поэтому правило применяется, а сообщение перемещается в папку "Кошки".
  
На приведенном ниже рисунке показано, как правило применяется к входящему сообщению.
  
**На рисунке 2. Входящее сообщение обрабатывается правилом**

![Рисунок, на котором показано новое сообщение, отправляемое в список рассылки коллегой. Это сообщение удовлетворяет всем условиям, в правиле не задано ни одно исключение. Сообщение перемещается в папку Cats.](media/Ex15_Rules_RuleEvaluationSample.png)
  
## <a name="blocking-senders"></a>Блокировка отправителей
<a name="bk_Blocking"> </a>

Несмотря на то, что можно создать правило, которое будет переместить все почтовые сообщения от определенного отправителя в папку нежелательной почты, можно сделать это с помощью список заблокированных отправителей в параметры нежелательной почты. Поскольку существует ограничение на количество правил, пользователь может иметь, имеет смысл использовать список заблокированных отправителей. С помощью метода управляемый API EWS [ExchangeService.MarkAsJunk](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.markasjunk%28v=exchg.80%29.aspx) или операции EWS [MarkAsJunk](http://msdn.microsoft.com/library/1f71f04d-56a9-4fee-a4e7-d1034438329e%28Office.15%29.aspx) можно [Добавить или удалить адреса определенных электронной почты в списке заблокированных отправителей](how-to-add-and-remove-email-addresses-from-blocked-senders-list-by-using-ews.md) . Обратите внимание на то, что для веб-служб Exchange для доступа к списку заблокированных отправителей, почтовый ящик пользователя должен содержать сообщение электронной почты с адреса электронной почты, который нужно добавить или удалить. 
  
## <a name="in-this-section"></a>В этом разделе
<a name="bk_InThisSection"> </a>

- [Управление правилами папки "Входящие" с помощью веб-служб Exchange в Exchange](how-to-manage-inbox-rules-by-using-ews-in-exchange.md)
    
- [Добавление и удаление адреса электронной почты в списке заблокированных отправителей с помощью веб-служб Exchange в Exchange](how-to-add-and-remove-email-addresses-from-blocked-senders-list-by-using-ews.md)
    
## <a name="see-also"></a>См. также


- [Разработка клиентов веб-служб для Exchange](develop-web-service-clients-for-exchange.md)
    
- [Операция GetInboxRules](http://msdn.microsoft.com/library/b4b2701a-4a23-4acc-8c75-19f7955ad7ae%28Office.15%29.aspx)
    
- [Операция UpdateInboxRules](http://msdn.microsoft.com/library/f982a237-471e-45c5-a2b5-468cfc53150b%28Office.15%29.aspx)
    
- [MarkAsJunk Operation](http://msdn.microsoft.com/library/1f71f04d-56a9-4fee-a4e7-d1034438329e%28Office.15%29.aspx)
    

