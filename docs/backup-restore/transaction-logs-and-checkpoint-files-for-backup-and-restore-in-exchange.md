---
title: Журналы транзакций и файлы контрольных точек для резервного копирования и восстановления в Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 80e04b9f-87c7-4acf-89b1-aa66ffaf7e53
description: Сведения о журналах транзакций и файлах контрольных точек, а также о том, как они используются для резервного копирования и восстановления данных Exchange 2013.
ms.openlocfilehash: 5b01fc6924f82e76943795df877ae84b1fde087b
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2020
ms.locfileid: "44456390"
---
# <a name="transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange"></a><span data-ttu-id="87f6f-103">Журналы транзакций и файлы контрольных точек для резервного копирования и восстановления в Exchange</span><span class="sxs-lookup"><span data-stu-id="87f6f-103">Transaction logs and checkpoint files for backup and restore in Exchange</span></span>

<span data-ttu-id="87f6f-104">Сведения о журналах транзакций и файлах контрольных точек, а также о том, как они используются для резервного копирования и восстановления данных Exchange 2013.</span><span class="sxs-lookup"><span data-stu-id="87f6f-104">Find information about transaction logs and checkpoint files and how they are used to back up and restore Exchange 2013 data.</span></span>
  
<span data-ttu-id="87f6f-105">**Применимо к:** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="87f6f-105">**Applies to:** Exchange Server 2013</span></span> 
  
<span data-ttu-id="87f6f-106">В этой статье описывается, как Exchange Server 2013 использует журналы транзакций и файлы контрольных точек для предотвращения потери данных.</span><span class="sxs-lookup"><span data-stu-id="87f6f-106">This article describes how Exchange Server 2013 uses transaction logs and checkpoint files to help prevent data loss.</span></span> <span data-ttu-id="87f6f-107">При разработке приложений для резервного копирования и восстановления, использующих службу теневого копирования томов (VSS), в версиях Windows Server, начиная с Windows Server 2008, важно знать об этих сведениях.</span><span class="sxs-lookup"><span data-stu-id="87f6f-107">It is important to be aware of this information when you develop backup and restore applications that use the Volume Shadow Copy Service (VSS) in versions of Windows Server starting with Windows Server 2008.</span></span>
  
## <a name="transaction-logs-in-exchange-2013"></a><span data-ttu-id="87f6f-108">Журналы транзакций в Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="87f6f-108">Transaction logs in Exchange 2013</span></span>

<span data-ttu-id="87f6f-109">Exchange 2013 поддерживает единый набор файлов журналов транзакций для каждой базы данных.</span><span class="sxs-lookup"><span data-stu-id="87f6f-109">Exchange 2013 maintains a single set of transaction log files for each database.</span></span> <span data-ttu-id="87f6f-110">Транзакция определяется как любая операция, которая изменяет состояние или содержимое базы данных.</span><span class="sxs-lookup"><span data-stu-id="87f6f-110">A transaction is defined as any operation that changes the state or contents of the database.</span></span> <span data-ttu-id="87f6f-111">Файлы журнала транзакций для отдельной базы данных записывают все транзакции, выполняемые в базе данных.</span><span class="sxs-lookup"><span data-stu-id="87f6f-111">The transaction log files for an individual database record all the transactions performed on the database.</span></span> <span data-ttu-id="87f6f-112">Записи транзакций записываются в журналы транзакций до их внесения в саму базу данных, чтобы гарантировать, что все зафиксированные транзакции могут быть восстановлены в случае сбоя базы данных.</span><span class="sxs-lookup"><span data-stu-id="87f6f-112">Records of the transactions are written to the transaction logs before they are made in the database itself, to ensure that all committed transactions can be recovered in the event of a database failure.</span></span> <span data-ttu-id="87f6f-113">Журналы транзакций базы данных Exchange 2013 хранятся на диске до того, как транзакции будут зафиксированы в файле базы данных.</span><span class="sxs-lookup"><span data-stu-id="87f6f-113">Exchange 2013 database transaction logs are stored on disk before the transactions are committed to the database file.</span></span> 
  
<span data-ttu-id="87f6f-114">Запись транзакций перед обновлением базы данных называется ведением журнала с упреждающей записью.</span><span class="sxs-lookup"><span data-stu-id="87f6f-114">The recording of the transactions before the database is updated is called write-ahead logging.</span></span> <span data-ttu-id="87f6f-115">Чтобы убедиться, что база данных правильно возвращена в соответствующее состояние, Exchange 2013 записывает данные в файлы базы данных с помощью операций записи и контрольных точек на основе страниц.</span><span class="sxs-lookup"><span data-stu-id="87f6f-115">To help ensure that the database is correctly brought back to the proper state, Exchange 2013 writes data into the database files by using page-based writes and checkpoints.</span></span> <span data-ttu-id="87f6f-116">В ходе обычных операций хранилище Exchange сначала записывает изменения базы данных в журналы транзакций, а затем вносит изменения в копию базы данных, находящиеся в памяти.</span><span class="sxs-lookup"><span data-stu-id="87f6f-116">During regular operations, the Exchange store first records database changes in the transaction logs, and then makes those changes on an in-memory copy of the database.</span></span> <span data-ttu-id="87f6f-117">В журналах транзакций записываются начало и конец каждой транзакции.</span><span class="sxs-lookup"><span data-stu-id="87f6f-117">The transaction logs record the beginning and end of each transaction.</span></span> <span data-ttu-id="87f6f-118">Это гарантирует, что в базе данных будет доступно достаточно информации для последующего отмены или отката операций в базе данных.</span><span class="sxs-lookup"><span data-stu-id="87f6f-118">This ensures that sufficient information is available to later undo or roll back operations in the database.</span></span>
  
<span data-ttu-id="87f6f-119">При восстановлении после ошибок, когда файл базы данных на диске поврежден, но журналы транзакций не повреждены, приложение восстановления должно сначала восстановить известную работоспособную копию файла базы данных.</span><span class="sxs-lookup"><span data-stu-id="87f6f-119">When recovering from errors in which the database file on disk is damaged, but the transaction logs are intact, your restore application must first restore a known good copy of the database file.</span></span>
  
<span data-ttu-id="87f6f-120">Хранилище Exchange воспроизводит транзакции из архивных журналов транзакций, а затем воспроизводит все оставшиеся транзакции из файлов журнала транзакций на диске.</span><span class="sxs-lookup"><span data-stu-id="87f6f-120">The Exchange store replays the transactions from the previously backed up transaction logs, and then replays any remaining transactions from the on-disk transaction log files.</span></span> <span data-ttu-id="87f6f-121">Обратите внимание, что иногда транзакции могут быть потеряны в случае сбоя системы между моментом записи транзакций в журналы транзакций и при их фактическом написании в файлах базы данных.</span><span class="sxs-lookup"><span data-stu-id="87f6f-121">Note that sometimes transactions can be lost if the system fails between when the transactions are recorded in the transaction logs, and when they are actually written to the database files.</span></span> 
  
<span data-ttu-id="87f6f-122">Периодически хранилище Exchange проверяет изображение базы данных в памяти, а затем определяет, какие страницы изменились.</span><span class="sxs-lookup"><span data-stu-id="87f6f-122">Periodically, the Exchange store checks the in-memory database image, and then determines which pages have changed.</span></span> <span data-ttu-id="87f6f-123">Хранилище Exchange объединяет ожидающие изменения, а затем записывает эти страницы в файл базы данных на диске.</span><span class="sxs-lookup"><span data-stu-id="87f6f-123">The Exchange store combines the pending changes, and then writes those pages to the database file on disk.</span></span>
  
## <a name="checkpoint-files-in-exchange-2013"></a><span data-ttu-id="87f6f-124">Файлы контрольных точек в Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="87f6f-124">Checkpoint files in Exchange 2013</span></span>

<span data-ttu-id="87f6f-125">Файл контрольной точки записывает записанные транзакции в файлы базы данных на диске.</span><span class="sxs-lookup"><span data-stu-id="87f6f-125">A checkpoint file records which logged transactions have been written to the on-disk database files.</span></span> <span data-ttu-id="87f6f-126">Контрольная точка является расширенной, когда все страницы базы данных, которые были изменены записями в журналах транзакций, успешно записаны на диск.</span><span class="sxs-lookup"><span data-stu-id="87f6f-126">The checkpoint is advanced when all the database pages that have been modified by entries in the transaction logs are successfully written to disk.</span></span> <span data-ttu-id="87f6f-127">Так как файл контрольной точки записывает, какие транзакции уже находятся в образе базы данных на диске, хранилище Exchange должно выполнять только транзакции, произошедшие после создания контрольной точки.</span><span class="sxs-lookup"><span data-stu-id="87f6f-127">Because the checkpoint file records which transactions are already in the on-disk database image, the Exchange store only needs to replay transactions that occurred after the checkpoint.</span></span> <span data-ttu-id="87f6f-128">В зависимости от периода времени между резервными копиями это может значительно уменьшить количество транзакций, которые необходимо преобразовать в базу данных в случае сбоя системы.</span><span class="sxs-lookup"><span data-stu-id="87f6f-128">Depending on the time period between backups, this can greatly decrease the number of transactions that must be replayed into the database if a system failure occurs.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="87f6f-129">См. также</span><span class="sxs-lookup"><span data-stu-id="87f6f-129">See also</span></span>

- [<span data-ttu-id="87f6f-130">Основные понятия резервного копирования и восстановления для Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="87f6f-130">Backup and restore concepts for Exchange 2013</span></span>](backup-and-restore-concepts-for-exchange-2013.md)
- [<span data-ttu-id="87f6f-131">Типы операций резервного копирования для Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="87f6f-131">Types of backup operations for Exchange 2013</span></span>](types-of-backup-operations-for-exchange-2013.md)
- [<span data-ttu-id="87f6f-132">Восстановление баз данных Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="87f6f-132">Restoring Exchange 2013 databases</span></span>](restoring-exchange-2013-databases.md)
    

