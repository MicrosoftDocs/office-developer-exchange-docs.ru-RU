---
title: Типы операций резервного копирования для Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 70510902-9583-4177-be3d-afbf757a1ec0
description: Сведения о различных типах резервных копий, которые можно выполнять в базах данных хранилища Exchange 2013, в том числе полных, копиях, добавочных и разностных резервных копий.
ms.openlocfilehash: dd07226acb3a3bb055e98f861a5c01375ee50dda
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2020
ms.locfileid: "44456292"
---
# <a name="types-of-backup-operations-for-exchange-2013"></a>Типы операций резервного копирования для Exchange 2013

Сведения о различных типах резервных копий, которые можно выполнять в базах данных хранилища Exchange 2013, в том числе полных, копиях, добавочных и разностных резервных копий.
  
**Применимо к:** Exchange Server 2013 
  
В этой статье приводятся сведения о различных типах резервных копий, которые можно выполнять в базах данных Exchange Server 2013, а также о том, как эти резервные копии влияют на файлы базы данных. 
  
Приложения для резервного копирования и восстановления, использующие службу теневого копирования томов (VSS), и средство записи Exchange Writer могут выполнять типы резервных копий, перечисленные в следующей таблице.
  
**Таблица 1. Типы операций резервного копирования**

|**Тип резервного копирования**|**Описание**|
|:-----|:-----|
|[Полные резервные копии](types-of-backup-operations-for-exchange-2013.md#bk_FullBackups) <br/> |Создает резервную копию баз данных ( \* EDB), журналов транзакций ( \* log), файлов контрольных точек ( \* chk), а затем усекает журналы транзакций для определенной базы данных.  <br/> |
|[Копирование резервных копий](types-of-backup-operations-for-exchange-2013.md#bk_CopyBackups) <br/> |Выполняет резервное копирование базы данных, журналов транзакций и файлов контрольных точек. Копирование резервных копий не усекает журналы транзакций для базы данных.  <br/> |
|[Добавочное резервное копирование](types-of-backup-operations-for-exchange-2013.md#bk_IncrementalBackups) <br/> |Создает резервные копии журналов транзакций для записи изменений с момента последнего полного или добавочного резервного копирования, а затем усекает журналы транзакций.  <br/> |
|[Разностные резервные копии](types-of-backup-operations-for-exchange-2013.md#bk_DifferentialBackups) <br/> |Создает резервные копии журналов транзакций, чтобы записать изменения с момента последнего полного или добавочного резервного копирования, и не усекает журналы транзакций.  <br/> |
   
Компоненты, или файлы баз данных, определяемые средством записи Exchange, представляют файлы баз данных и журналы транзакций в базах данных Exchange 2013. Это позволяет приложению резервного копирования и восстановления отображать имена компонентов в базе данных Exchange 2013 во время операций резервного копирования. Приложение резервного копирования не может выполнять резервное копирование отдельных компонентов базы данных, однако; она может выполнять резервное копирование только целых баз данных. 
  
Модуль записи Exchange стандартизации логических путей компонента базы данных, указанных в метаданных модуля записи Exchange. При необходимости средство записи Exchange Writer возвращает логические пути к приложению резервного копирования и восстановления.
  
Средство записи Exchange предоставляет логические пути в виде: 
  
 `logicalPath = "Exchange Server\Microsoft Information Store\<Server name>"`
  
Компоненты сервера и базы данных являются компонентами группы файлов, но у них нет связанных файлов. У них есть подкомпоненты, указывающие отдельные файлы. База данных содержит только один компонент журнала, именуемый журналами. Имена компонентов отдельных компонентов базы данных представляют собой идентификаторы GUID баз данных, отображаемые в виде строк. 
  
Модуль записи Exchange содержит только те базы данных, для которых можно выполнять резервное копирование, на основе рекомендаций по платформе VSS. Базы данных, подключаемые к базе данных восстановления Exchange 2013, а также базы данных, которые не подключены, не могут быть резервными копиями и поэтому не указаны в метаданных средства записи Exchange.
  
На следующем рисунке показан процесс резервного копирования Exchange Writer. 
  
**Рис. 1. Последовательность событий для процесса резервного копирования**

![Диаграмма, показывающая последовательность событий для процесса резервного копирования. Последовательность начинается с запуска хранилищ Exchange, после чего службой записи Exchange, VSS и клиентским приложением выполняется ряд действий.](media/VSS_StoreWriterBackup.gif)
  
## <a name="full-backups"></a>Полные резервные копии
<a name="bk_FullBackups"> </a>

Полное резервное копирование базы данных Exchange включает в себя создание и сохранение копии файла базы данных, журналов транзакций и файлов контрольных точек. База данных Exchange 2013 содержит один набор выделенных файлов журнала транзакций.
  
После создания резервной копии базы данных файлы журнала транзакций на диске усекаются, поэтому только изменения базы данных, произошедшие после выполнения резервного копирования, останутся. Во время этого процесса средство записи Exchange удаляет все записи журнала вплоть до контрольной точки, исходя из предположения, что резервное копирование баз данных теперь было выполнено в согласованном состоянии, которое содержит все изменения до последней контрольной точки. 
  
Если резервная копия базы данных отключена во время операции резервного копирования, Exchange 2013 не усекает журналы транзакций, а результат будет эквивалентен операции копирования резервного копирования, а не полного резервного копирования. 
  
После завершения полного резервного копирования заголовки активной подключенной базы данных обновляются с использованием текущих сведений о резервном копировании. В реплицированных развертываниях эти сведения заносятся в файл журнала транзакций и реплицируются на другие копии базы данных DAG. Заголовки копий базы данных обновляются при воспроизведении файла журнала транзакций в копии базы данных.
  
Для запуска добавочной и разностной резервной копии требуется резервное копирование полной теневой копии. Полное резервное копирование можно выполнить из любой копии, если она является резервной копией теневой копии.
  
Полные резервные копии используются в следующих сценариях:
  
- База данных повреждена или потеряна, но файлы журнала транзакций на диске не повреждены. В этом сценарии затронутые файлы базы данных можно восстановить из полной резервной копии, а затем восстановить, переполнив журналы транзакций, которые все еще находятся на диске. 
    
- Файлы журнала транзакций, а также файл базы данных на диске теряются. В этом сценарии файлы журнала транзакций, которые были скопированы во время полного резервного копирования, восстанавливаются вместе с базой данных.
    
В Exchange 2013 журналы можно восстановить без необходимости восстановления соответствующей базы данных из полного набора резервных копий. Этот параметр позволяет восстановить предыдущую полную резервную копию и в сочетании с файлами журнала транзакций из последнего полного резервного копирования, чтобы выполнить накат.
  
Если для перечисления [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) в VSS задано значение **VSS_BT_FULL** при выполнении резервного копирования с помощью средства записи Exchange, в резервную копию включаются следующие компоненты: 
  
- База данных с логическим путем Exchange Сервер\микрософт Information Store \\<Server Name \> \\<GUID базы данных\> 
    
- Файл журнала с логическим путем Exchange Сервер\микрософт Information Store \\<Server Name \> \\<GUID базы данных\> 
    
## <a name="copy-backups"></a>Копирование резервных копий
<a name="bk_CopyBackups"> </a>

Резервная копия базы данных Exchange включает в себя создание и сохранение элементов, включенных в полную резервную копию. Однако в отличие от полного резервного копирования, файлы журнала транзакций на диске не усекаются при завершении резервного копирования. Копирование резервных копий не предназначено для целей восстановления данных. Копирование резервных копий предоставляет изображение данных для использования при тестировании, диагностике проблем или инициализации реплики.
  
Например, администратор Exchange 2013, испытывающий проблемы с хранилищем Exchange, может создать резервную копию для использования в тестовой среде, не затрагивая производственную систему. Копирование резервных копий не влияет на регулярные расписания резервного копирования; Однако так как резервное копирование также помещает хранилище Exchange в состояние, выполняемое при резервном копировании, оно блокирует выполнение других запланированных резервных копий, пока резервное копирование не будет завершено или прервано. 
  
Если для перечисления [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) в VSS задано значение **VSS_BT_COPY**, в резервную копию будут включены следующие компоненты: 
  
- База данных с логическим путем Exchange Сервер\микрософт Information Store \\<Server Name \> \\<GUID базы данных\> 
    
- Компонент файла журнала с логическим путем Exchange Сервер\микрософт Information Store \\<Server Name \> \\<GUID базы данных\>
    
## <a name="incremental-backups"></a>Добавочное резервное копирование
<a name="bk_IncrementalBackups"> </a>

Добавочная резервная копия базы данных Exchange 2013 сохраняет изменения в базе данных, произошедшие с момента последнего полного или добавочного резервного копирования. После восстановления всех файлов базы данных и файлов журнала в системе они могут быть восстановлены до состояния, в котором они были на момент последнего добавочного резервного копирования. Данные, хранящиеся в добавочной резервной копии, содержат только файлы журнала транзакций вплоть до текущего времени. 
  
По завершении резервного копирования сервер Exchange усекает файлы журнала и помечает время резервного копирования в заголовках баз данных. Для восстановления базы данных с помощью добавочной резервной копии необходимо восстановить по крайней мере два набора данных: последнюю полную резервную копию, а затем каждую добавочную резервную копию, созданную после последнего полного резервного копирования. Преимущество использования добавочных резервных копий заключается в том, что отдельные резервные копии гораздо меньше, чем полные резервные копии, а индивидуальные разностные резервные копии часто меньше разностных резервных копий. 
  
Недостаток использования добавочных резервных копий состоит в том, что если между полным резервным копированием выполнялось большое количество добавочных копий, восстановление хранилища Exchange может привести к восстановлению большого количества добавочных резервных копий. В Exchange не разрешается выполнение добавочного резервного копирования, если не существует предыдущего полного резервного копирования, чтобы установить начальную точку для добавочных изменений. 
  
За полной резервной копией, полученной из расположения копии группы обеспечения доступности баз данных, можно выполнить добавочное резервное копирование из активного расположения и наоборот. Необходимо помнить, что Последнее состояние резервного копирования сохраняется в заголовке активной базы данных, а изменения заголовка базы данных записываются в журналы транзакций, реплицируются и воспроизводится в папке копирования базы данных так же, как и все остальные журналы транзакций в развертываниях группы DAG. Так как резервное копирование и восстановление взаимодействия, приложения резервного копирования могут выполнять резервное копирование только для определенного узла группы обеспечения доступности баз данных, независимо от того, является ли узел активным или пассивным, а также для выполнения резервного копирования исключительно с пассивного узла или только с активного узла.
  
Если для перечисления [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) в VSS задано значение **VSS_BT_INCREMENTAL**, для добавочной резервной копии включены следующие компоненты: 
  
- База данных с логическим путем Exchange Сервер\микрософт Information Store \\<Server Name \> \\<GUID базы данных\> 
    
- Файл журнала с логическим путем Exchange Сервер\микрософт Information Store \\<Server Name \> \\<GUID базы данных\>
    
## <a name="differential-backups"></a>Разностные резервные копии
<a name="bk_DifferentialBackups"> </a>

Разностное резервное копирование базы данных Exchange 2013 сохраняет изменения в базе данных, произошедшие с момента последнего полного или добавочного резервного копирования. Когда файлы базы данных и файлы журналов восстанавливаются системой, они могут быть восстановлены до состояния, в котором они были в последней разностной резервной копии. 
  
Данные, хранящиеся в разностной резервной копии, включают в себя только файлы журнала транзакций вплоть до текущей контрольной точки. Разностные резервные копии не удаляют и не изменяют файлы журналов, а также не изменяют заголовки баз данных. Чтобы восстановить базу данных с помощью разностной резервной копии, достаточно восстановить только два набора данных: последнюю полную резервную копию, а затем самую последнюю разностную резервную копию. 
  
Недостаток использования разностных резервных копий состоит в том, что разностные резервные копии дублируют резервные копии данных в каждой резервной копии до выполнения полного резервного копирования. Если между полным резервным копированием выполняется много разностных резервных копий, необходимое дисковое пространство может превышать количество добавочных резервных копий. Exchange не позволяет выполнить разностное резервное копирование, если резервное копирование не выполнялось в результате полного или добавочного резервного копирования, чтобы установить отправную точку для разностных резервных копий.
  
За полной резервной копией, полученной из расположения копирования, может следовать разностное резервное копирование из активного расположения и наоборот. Необходимо помнить, что Последнее состояние резервного копирования сохраняется в заголовке активной базы данных, а изменения заголовка базы данных записываются в журналы транзакций, реплицируются и воспроизводится в папке копирования базы данных так же, как и все остальные журналы транзакций в развертываниях группы DAG. Так как резервное копирование и восстановление взаимодействия, приложения резервного копирования предоставляют функциональные возможности для выполнения всех операций резервного копирования только для определенного узла группы обеспечения доступности баз данных, независимо от того, является ли узел активным или пассивным, а также для выполнения резервного копирования исключительно с пассивного узла или только с активного узла.
  
Если для перечисления [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) в VSS задано значение **VSS_BT_DIFFERENTIAL**, в разностную резервную копию включаются следующие компоненты: 
  
- База данных с логическим путем Exchange Сервер\микрософт Information Store \\<Server Name \> \\<GUID базы данных\> 
    
- Файл журнала с логическим путем Exchange Сервер\микрософт Information Store \\<Server Name \> \\<GUID базы данных\>
    
## <a name="see-also"></a>См. также
<a name="bk_AdditionalResources"> </a>

- [Создание приложений резервного копирования и восстановления для Exchange 2013](build-backup-and-restore-applications-for-exchange-2013.md)
    
- [Основные понятия резервного копирования и восстановления для Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md)
    
- [Восстановление баз данных Exchange 2013](restoring-exchange-2013-databases.md)
    
- [Проверка целостности резервной копии с помощью API ЧКСГФИЛЕС в Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
    
- [Проверка целостности резервной копии с помощью средства Eseutil в Exchange 2013](how-to-validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013.md)
    

