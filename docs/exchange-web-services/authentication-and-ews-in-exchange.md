---
title: Проверка подлинности и EWS в Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
ms.assetid: 9a83df96-aca0-42b3-b8f5-2b414f0363f1
description: Сведения о том, как правильно выбрать стандарт проверки подлинности приложения веб-служб Exchange, предназначенного для Exchange.
localization_priority: Priority
ms.openlocfilehash: 0b35921f33b935f9a5a490e15d4e76d1a3e3c9dc
ms.sourcegitcommit: 843a2e030a94b12aec70c553ca4e06e39ac02d82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/09/2020
ms.locfileid: "49603836"
---
# <a name="authentication-and-ews-in-exchange"></a><span data-ttu-id="ab7f3-103">Проверка подлинности и EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="ab7f3-103">Authentication and EWS in Exchange</span></span>

<span data-ttu-id="ab7f3-104">Сведения о том, как правильно выбрать стандарт проверки подлинности приложения веб-служб Exchange, предназначенного для Exchange.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-104">Find information to help you choose the right authentication standard for your EWS application that targets Exchange.</span></span>
  
<span data-ttu-id="ab7f3-p101">Проверка подлинности — это ключевая составляющая приложения веб-служб Exchange. Exchange Online, Exchange Online в составе Office 365, а также локальные версии Exchange, начиная с Exchange Server 2013, поддерживают стандартные протоколы проверки подлинности в Интернете для защиты обмена данными между вашим приложением и сервером Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p101">Authentication is a key part of your Exchange Web Services (EWS) application. Exchange Online, Exchange Online as part of Office 365, and on-premises versions of Exchange starting with Exchange Server 2013 support standard web authentication protocols to help secure the communication between your application and the Exchange server.</span></span>
  
<span data-ttu-id="ab7f3-p102">В случае с Exchange Online нужно выбрать способ проверки подлинности, при котором используется протокол HTTPS для шифрования запросов и откликов, которые отправляет ваше приложение. Хотя использование протокола HTTP для локальных серверов Exchange допустимо, рекомендуем применять протокол HTTPS в отношении всех запросов, которые ваше приложение отправляет в конечную точку веб-служб Exchange. Это обеспечит защиту обмена данными между вашим приложением и сервером Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p102">If you're targeting Exchange Online, the authentication method that you choose must use HTTPS to encrypt the requests and responses that your application sends. Although you can use HTTP with Exchange on-premises servers, we recommend that you use HTTPS for any request that your application sends to an EWS endpoint to help secure communication between your application and an Exchange server.</span></span>
  
<span data-ttu-id="ab7f3-109">В Exchange можно выбрать следующие варианты проверки подлинности:</span><span class="sxs-lookup"><span data-stu-id="ab7f3-109">Exchange provides the following authentication options for you to choose from:</span></span> 
  
- <span data-ttu-id="ab7f3-110">OAuth 2.0 (только для Exchange Online);</span><span class="sxs-lookup"><span data-stu-id="ab7f3-110">OAuth 2.0 (Exchange Online only)</span></span>
    
- <span data-ttu-id="ab7f3-111">NTLM (только для локальных версий Exchange);</span><span class="sxs-lookup"><span data-stu-id="ab7f3-111">NTLM (Exchange on-premises only)</span></span>
    
- <span data-ttu-id="ab7f3-112">обычная проверка (больше не рекомендуется).</span><span class="sxs-lookup"><span data-stu-id="ab7f3-112">Basic (no longer recommended)</span></span>
    
<span data-ttu-id="ab7f3-p103">Выбор метода проверки подлинности зависит от требований вашей организации к обеспечению защиты, от того, используете ли вы Exchange Online или локальные версии Exchange, а также от того, есть ли у вас доступ к стороннему поставщику, который может выдавать маркеры OAuth. Эта статья поможет вам выбрать подходящий стандарт проверки подлинности для вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p103">The authentication method that you choose depends on the security requirements of your organization, whether you are using Exchange Online or Exchange on-premises, and whether you have access to a third-party provider that can issue OAuth tokens. This article provides information that will help you select the authentication standard that's right for your application.</span></span>
  
## <a name="oauth-authentication"></a><span data-ttu-id="ab7f3-115">Проверка подлинности OAuth</span><span class="sxs-lookup"><span data-stu-id="ab7f3-115">OAuth authentication</span></span>

<span data-ttu-id="ab7f3-p104">Рекомендуем использовать стандарт OAuth для подключения к службам Exchange Online во всех новых приложениях. Более высокий уровень защиты по сравнению с тем, который обеспечивает обычная проверка подлинности, оправдывает дополнительные усилия по реализации стандарта OAuth в вашем приложении. Но у этого стандарта есть и некоторые недостатки, которые следует учитывать.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p104">We recommend that all new applications use the OAuth standard to connect to Exchange Online services. The advantage in security over basic authentication is worth the additional work required to implement OAuth in your application. For the record, however, there are also some disadvantages that you should be aware of.</span></span>
  
<span data-ttu-id="ab7f3-119">**Таблица 1. Преимущества и недостатки использования стандарта OAuth**</span><span class="sxs-lookup"><span data-stu-id="ab7f3-119">**Table 1. Advantages and disadvantages of using OAuth**</span></span>

|<span data-ttu-id="ab7f3-120">**Преимущества**</span><span class="sxs-lookup"><span data-stu-id="ab7f3-120">**Advantages**</span></span>|<span data-ttu-id="ab7f3-121">**Недостатки**</span><span class="sxs-lookup"><span data-stu-id="ab7f3-121">**Disadvantages**</span></span>|
|:-----|:-----|
| <span data-ttu-id="ab7f3-122">OAuth — это протокол проверки подлинности, соответствующий отраслевым стандартам.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-122">OAuth is an industry-standard authentication protocol.</span></span><br/><br/><span data-ttu-id="ab7f3-p105">Проверку подлинности выполняет сторонний поставщик. Ваше приложение не должно собирать и хранить учетные данные Exchange.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p105">Authentication is managed by a third-party provider. Your application does not have to collect and store the Exchange credentials.</span></span><br/><br/><span data-ttu-id="ab7f3-125">Это облегчает вам задачу, так как ваше приложение получает только скрытый маркер от поставщика проверки подлинности. Это значит, что в случае бреши в системе безопасности вашего приложения откроется доступ только к данным маркера, а не учетным данным Exchange пользователя.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-125">Fewer worries for you, because your application only receives an opaque token from the authentication provider; therefore, a security breach in your application can only expose the token, not the user's Exchange credentials.</span></span>  <br/> | <span data-ttu-id="ab7f3-p106">OAuth требует использования стороннего поставщика проверки подлинности, поэтому возможны дополнительные расходы для вашей организации или клиентов.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p106">OAuth relies on a third-party authentication provider. This can impose additional costs on your organization or your customers.</span></span><br/><br/><span data-ttu-id="ab7f3-128">Стандарт OAuth сложнее реализовать, чем обычную проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-128">The OAuth standard is more difficult to implement than basic authentication.</span></span><br/><br/><span data-ttu-id="ab7f3-129">Для его реализации необходимо интегрировать приложение с поставщиком проверки подлинности и сервером Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-129">To implement OAuth, you need to integrate your application with both the authentication provider and the Exchange server.</span></span>  <br/> |
   
<span data-ttu-id="ab7f3-p107">Чтобы свести к минимуму неудобства, воспользуйтесь [библиотекой проверки подлинности Microsoft Azure AD](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries) (ADAL) для аутентификации пользователей в доменных службах Active Directory (AD DS) в облаке или локальной среде, а затем получите маркеры доступа для защиты вызовов сервера Exchange Server. Для Exchange Online требуются маркеры, выданные службой Azure Active Directory, которая поддерживается библиотекой ADAL. Но можно воспользоваться любой сторонней библиотекой.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p107">To help minimize the disadvantages, you can use the [Microsoft Azure AD Authentication Library](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries) (ADAL) to authenticate users to Active Directory Domain Services (AD DS) in the cloud or on-premises and then obtain access tokens for securing calls to an Exchange server. Exchange Online requires tokens issued by the Azure Active Directory service, which is supported by the ADAL; however, you can use any third-party library.</span></span> 
  
<span data-ttu-id="ab7f3-132">Дополнительные ресурсы, касающиеся использования стандарта проверки подлинности OAuth в приложении EWS:</span><span class="sxs-lookup"><span data-stu-id="ab7f3-132">To learn more about using OAuth authentication in your EWS application, see the following resources:</span></span>
  
- <span data-ttu-id="ab7f3-133">[пробная версия Office 365](https://docs.microsoft.com/office/developer-program/office-365-developer-program), позволяющая настроить сервер Exchange Server для тестирования клиентского приложения;</span><span class="sxs-lookup"><span data-stu-id="ab7f3-133">[Office 365 trial](https://docs.microsoft.com/office/developer-program/office-365-developer-program), to set up an Exchange server to use to test your client application.</span></span>
    
- <span data-ttu-id="ab7f3-134">[библиотека проверки подлинности Azure AD для .NET](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries);</span><span class="sxs-lookup"><span data-stu-id="ab7f3-134">[Azure AD Authentication Library for .NET](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries)</span></span>
    
- <span data-ttu-id="ab7f3-135">[сведения о настройке Azure Active Directory](https://msdn.microsoft.com/library/055e1155-2d4d-4c85-b44e-d406872ba595%28Office.15%29.aspx), позволяющей приложению использовать маркеры OAuth для проверки подлинности;</span><span class="sxs-lookup"><span data-stu-id="ab7f3-135">[Configure Azure Active Directory](https://msdn.microsoft.com/library/055e1155-2d4d-4c85-b44e-d406872ba595%28Office.15%29.aspx), to enable your application to use OAuth tokens for authentication.</span></span>
    
- <span data-ttu-id="ab7f3-136">пример кода, доступный в статье [How to: Authenticate an EWS application by using OAuth](how-to-authenticate-an-ews-application-by-using-oauth.md).</span><span class="sxs-lookup"><span data-stu-id="ab7f3-136">Review the sample code in [Authenticate an EWS application by using OAuth](how-to-authenticate-an-ews-application-by-using-oauth.md) for example code that you can study.</span></span> 
    
## <a name="ntlm-authentication"></a><span data-ttu-id="ab7f3-137">Проверка подлинности NTLM</span><span class="sxs-lookup"><span data-stu-id="ab7f3-137">NTLM authentication</span></span>

<span data-ttu-id="ab7f3-p108">Проверка подлинности NTLM доступна только для локальных серверов Exchange. В случае приложений, запущенных в сети корпоративного брандмауэра, интеграция проверки подлинности NTLM и .NET Framework обеспечивает использование встроенных средств для проверки подлинности вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p108">NTLM authentication is only available for Exchange on-premises servers. For applications that run inside the corporate firewall, integration between NTLM authentication and the .NET Framework provides a built-in means to authenticate your application.</span></span> 
  
<span data-ttu-id="ab7f3-140">**Таблица 2. Преимущества и недостатки использования протокола NTLM**</span><span class="sxs-lookup"><span data-stu-id="ab7f3-140">**Table 2. Advantages and disadvantages of using NTLM authentication**</span></span>

|<span data-ttu-id="ab7f3-141">**Преимущества**</span><span class="sxs-lookup"><span data-stu-id="ab7f3-141">**Advantages**</span></span>|<span data-ttu-id="ab7f3-142">**Недостатки**</span><span class="sxs-lookup"><span data-stu-id="ab7f3-142">**Disadvantages**</span></span>|
|:-----|:-----|
| <span data-ttu-id="ab7f3-p109">Проверка подлинности для сервера Exchange Server выполняется сразу: дополнительные манипуляции не нужны. Доступ к службам Exchange Server можно настроить с помощью [командлета командной консоли Exchange](how-to-control-access-to-ews-in-exchange.md).  </span><span class="sxs-lookup"><span data-stu-id="ab7f3-p109">Works "out of the box" with your Exchange server. You can configure access to Exchange services by using an [Exchange Management Shell cmdlet](how-to-control-access-to-ews-in-exchange.md).</span></span><br/><br/><span data-ttu-id="ab7f3-145">Используется объект [CredentialCache](https://msdn2.microsoft.com/library/615e0wsd) .NET Framework для автоматического получения учетных данных пользователя.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-145">Uses the .NET Framework [CredentialCache](https://msdn2.microsoft.com/library/615e0wsd) object to automatically get the user's credentials.</span></span><br/><br/><span data-ttu-id="ab7f3-146">[Доступны примеры кода](https://code.msdn.microsoft.com/office/Exchange-2013-101-Code-3c38582c), обеспечивающие использование учетных данных вошедшего в систему пользователя для проверки подлинности на локальном сервере Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-146">[Code samples are available](https://code.msdn.microsoft.com/office/Exchange-2013-101-Code-3c38582c) that use the logged on user's credentials for authentication to an on-premises Exchange server.</span></span>  <br/> | <span data-ttu-id="ab7f3-147">Чтобы можно было использовать проверку подлинности на основе NTLM, пользователям нужно войти в домен.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-147">Users must be logged on to a domain to use NTLM authentication.</span></span><br/><br/><span data-ttu-id="ab7f3-148">Могут возникнуть трудности с получением доступа к учетным записям электронной почты, которые не связаны с учетной записью домена пользователя.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-148">It can be difficult to access email accounts that are not associated with the user's domain account.</span></span><br/><br/><span data-ttu-id="ab7f3-149">Для использования протокола NTLM у приложений служб должна быть учетная запись домена.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-149">Service applications must have a domain account to take advantage of NTLM authentication.</span></span>  <br/> |

   
## <a name="basic-authentication"></a><span data-ttu-id="ab7f3-150">Обычная проверка подлинности</span><span class="sxs-lookup"><span data-stu-id="ab7f3-150">Basic authentication</span></span>

<span data-ttu-id="ab7f3-p110">Такая проверка обеспечивает базовый уровень защиты для клиентского приложения. Мы рекомендуем, чтобы все новые приложения использовали протоколы NTLM или OAuth для проверки подлинности. Но в некоторых случаях для вашего приложения подойдет именно обычная проверка подлинности.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p110">Basic authentication provides a, well, basic level of security for your client application. We do recommend that all new applications use either NTLM or the OAuth protocol for authentication; however, basic authentication can be the correct choice for your application in some circumstances.</span></span>
  
<span data-ttu-id="ab7f3-153">**Таблица 3. Преимущества и недостатки использования обычной проверки подлинности**</span><span class="sxs-lookup"><span data-stu-id="ab7f3-153">**Table 3. Advantages and disadvantages of using basic authentication**</span></span>

|<span data-ttu-id="ab7f3-154">**Преимущества**</span><span class="sxs-lookup"><span data-stu-id="ab7f3-154">**Advantages**</span></span>|<span data-ttu-id="ab7f3-155">**Недостатки**</span><span class="sxs-lookup"><span data-stu-id="ab7f3-155">**Disadvantages**</span></span>|
|:-----|:-----|
| <span data-ttu-id="ab7f3-p111">Проверка подлинности для сервера Exchange Server выполняется сразу: дополнительные манипуляции не нужны. Доступ к службам Exchange Server можно настроить с помощью [командлета командной консоли Exchange](how-to-control-access-to-ews-in-exchange.md).  </span><span class="sxs-lookup"><span data-stu-id="ab7f3-p111">Works "out of the box" with your Exchange server. You can configure access to Exchange services by using an [Exchange Management Shell cmdlet](how-to-control-access-to-ews-in-exchange.md).</span></span><br/><br/><span data-ttu-id="ab7f3-158">Приложения для Windows могут использовать учетные данные по умолчанию вошедшего в систему пользователя.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-158">Windows applications can use the logged on user's default credentials.</span></span><br/><br/><span data-ttu-id="ab7f3-159">С помощью многих [доступных примеров кода](https://code.msdn.microsoft.com/office/Exchange-2013-101-Code-3c38582c) можно понять, как обеспечить вызовы EWS с использованием обычной проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-159">Many [code samples are available](https://code.msdn.microsoft.com/office/Exchange-2013-101-Code-3c38582c) that show you how to call EWS using basic authentication.</span></span>  <br/> | <span data-ttu-id="ab7f3-160">Требуется, чтобы ваше приложение собирало и хранило учетные данные пользователей.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-160">Requires your application to collect and store the user's credentials.</span></span><br/><br/><span data-ttu-id="ab7f3-161">Необходимо отключить проверку подлинности на основе NTLM для всех пользователей, если вы хотите использовать обычную проверку подлинности для всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-161">You have to turn off NTLM authentication if you want to force all users to use basic authentication.</span></span><br/><br/><span data-ttu-id="ab7f3-162">Если возникнет брешь системы безопасности приложения, злоумышленник может получить доступ к адресу и паролю электронной почты пользователя.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-162">If a security breach occurs in your application, it can expose the user's email address and password to the attacker.</span></span>  <br/> |
   
<span data-ttu-id="ab7f3-p112">Необходимо убедиться в том, что обычная проверка подлинности соответствует требованиям вашей организации и клиентов к обеспечению защиты. Такая проверка подойдет, если вы хотите избежать выполнения многочисленных задач по настройке (например, в простых тестовых или демонстрационных приложениях).</span><span class="sxs-lookup"><span data-stu-id="ab7f3-p112">You need to decide if basic authentication meets the security requirements of your organization and customers. Basic authentication can be the right choice if you want to avoid extensive setup tasks, for example for simple test or demonstration applications.</span></span>

> [!NOTE]
> <span data-ttu-id="ab7f3-165">Для подключения EWS к Exchange Online больше не поддерживается обычная проверка подлинности.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-165">Basic authentication is no longer supported for EWS to connect to Exchange Online.</span></span> <span data-ttu-id="ab7f3-166">Используйте проверку подлинности OAuth во всех новых или существующих приложениях EWS для подключения к Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-166">Use OAuth authentication in all your new or existing EWS applications to connect to Exchange Online.</span></span> <span data-ttu-id="ab7f3-167">Проверка подлинности OAuth для EWS доступна в Exchange Online только в составе Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-167">OAuth authentication for EWS is only available in Exchange Online as part of Microsoft 365.</span></span> <span data-ttu-id="ab7f3-168">Приложения EWS, использующие OAuth, необходимо сначала зарегистрировать в Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ab7f3-168">EWS applications that use OAuth must be registered with Azure Active Directory first.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="ab7f3-169">См. также</span><span class="sxs-lookup"><span data-stu-id="ab7f3-169">See also</span></span>
- [<span data-ttu-id="ab7f3-170">Проверка подлинности приложения EWS с помощью OAuth</span><span class="sxs-lookup"><span data-stu-id="ab7f3-170">Authenticate an EWS application by using OAuth</span></span>](how-to-authenticate-an-ews-application-by-using-oauth.md)
- [<span data-ttu-id="ab7f3-171">Начать работу с использованием веб-служб Exchange</span><span class="sxs-lookup"><span data-stu-id="ab7f3-171">Start using web services in Exchange</span></span>](start-using-web-services-in-exchange.md)   
- [<span data-ttu-id="ab7f3-172">Добавление адреса входа в веб-приложение с помощью Microsoft Azure AD</span><span class="sxs-lookup"><span data-stu-id="ab7f3-172">Adding Sign-On to Your Web Application Using Microsoft Azure AD</span></span>](https://msdn.microsoft.com/library/055e1155-2d4d-4c85-b44e-d406872ba595%28Office.15%29.aspx)    
- [<span data-ttu-id="ab7f3-173">Контроль доступа к EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="ab7f3-173">Control access to EWS in Exchange</span></span>](how-to-control-access-to-ews-in-exchange.md)    
- [<span data-ttu-id="ab7f3-174">Управление доступом клиентских приложений к EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="ab7f3-174">Controlling client application access to EWS in Exchange</span></span>](controlling-client-application-access-to-ews-in-exchange.md)   
- [<span data-ttu-id="ab7f3-175">Поддерживаемые маркеры и типы утверждений</span><span class="sxs-lookup"><span data-stu-id="ab7f3-175">Supported token and claim types</span></span>](https://msdn.microsoft.com/library/9d35e4bc-7b72-49d1-b723-5464eee6be2c%28Office.15%29.aspx)
 
