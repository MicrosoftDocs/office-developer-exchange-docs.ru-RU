---
title: Идентификаторы веб-служб Exchange в Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 39b6b20b-e081-4347-9e15-9b8cf829fdf0
description: Узнайте об идентификаторах в Exchange и как их использовать управляемый API EWS и приложения веб-служб Exchange.
ms.openlocfilehash: fbf6d7756f73b1c5d345f3b34deeb7ea8a347986
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2018
ms.locfileid: "21353975"
---
# <a name="ews-identifiers-in-exchange"></a>Идентификаторы веб-служб Exchange в Exchange

Узнайте об идентификаторах в Exchange и как их использовать управляемый API EWS и приложения веб-служб Exchange.
  
Каждый объект в хранилище Exchange имеет уникальный идентификатор. Идентификатор объекта можно использовать для ссылки на объект и отличить от других объектов. Два наиболее распространенных идентификаторы, которые могут работать с — папка и идентификаторы элементов. 
  
Для понимания идентификаторов и как они являются важными для приложения, необходимо понимать связи между объектами в Exchange. Когда управляемый API EWS или веб-служб Exchange приложение взаимодействует с сервером Exchange, работа с иерархии объектов, которая включает в себя почтовых ящиков, папок и объекты элементов. Хранилище может быть любой из этих типов объектов. Чаще всего это почтовый ящик на сервере Exchange, но также может быть общедоступных папок на сервере Exchange. (Следует помнить, что в Exchange Online, Exchange Online как часть Office 365 и версии Exchange, начиная с Exchange 2013, общие папки любой другой тип почтового ящика и не различных типа магазинов.) Хранилище содержит папки и папки содержат элементы и каждый из этих папок и элементов имеет идентификатор, как показано на следующем рисунке. 
  
**На рисунке 1. Почтовых ящиков, папок и элементов иерархии**

![Иллюстрация, показывающая иерархию объектов почтового ящика. Почтовый ящик находится на верхнем уровне, а папка "Входящие" — на уровень ниже. На диаграмме показана папка, содержащая сообщения. Идентификаторы и ключи изменения для каждого объекта перечислены в сокращенном виде.](media/Ex15_Identifier_diagram.png)
  
## <a name="ews-identifiers"></a>Идентификаторы веб-служб Exchange
<a name="bk_CommonIdentifiers"> </a>

Идентификаторы, которые использует веб-служб Exchange для папок и элементов, называются идентификаторами веб-служб Exchange или EwsIds. EwsIds можно найти в различных объектах веб-служб Exchange, но вызываются что-то другой для различных объектов. Так как эти объекты можно использовать в приложении, необходимо понять, как идентификаторы для этих объектов, которые относятся к EwsId. 
  
Идентификаторы в веб-служб Exchange могут быть применены управляемый API EWS также. В управляемый API веб-служб Exchange идентификаторы, свойства объектов и внутри управляемой сопоставлять с элементами веб-служб Exchange.
  
**В таблице 1. Идентификаторы объектов в веб-служб Exchange**

|**Объект**|**Идентификатор**|**Как она связана с EwsId?**|
|:-----|:-----|:-----|
|[CalendarItem](http://msdn.microsoft.com/library/b0c1fd27-b6da-46e5-88b8-88f00c71ba80%28Office.15%29.aspx) <br/> |Дочерний элемент [ItemId](http://msdn.microsoft.com/library/3350b597-57a0-4961-8f44-8624946719b4%28Office.15%29.aspx) содержит уникальный идентификатор элемента календаря.  <br/> |Дочерний элемент [ItemId](http://msdn.microsoft.com/library/3350b597-57a0-4961-8f44-8624946719b4%28Office.15%29.aspx) совпадает с EwsId для этого элемента.  <br/> |
|[ConversationId](http://msdn.microsoft.com/library/d5f1ddb3-9af3-4677-a6ba-111b304a951e%28Office.15%29.aspx) <br/> |В атрибуте **Id** содержит идентификатор для беседы, этот элемент является частью.  <br/> |В атрибуте **Id** совпадает с EwsId для этого элемента.  <br/> |
|[AttachmentId](http://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) <br/> |Содержит уникальный идентификатор вложения. Атрибут [RootItemId](http://msdn.microsoft.com/library/f613c705-17ce-48ce-aa64-4dc2cea25e31%28Office.15%29.aspx) содержит уникальный идентификатор корневого элемента хранилища, к которому подключен вложение.  <br/> |Вложения могут быть других элементов в хранилище Exchange, в котором case [идентификатора вложения AttachmentId](http://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) совпадает с EwsId. Во всех случаях [RootItemId](http://msdn.microsoft.com/library/f613c705-17ce-48ce-aa64-4dc2cea25e31%28Office.15%29.aspx) является EwsId, поскольку он ссылается на элемент в хранилище.  <br/> |
|[PersonaId](http://msdn.microsoft.com/library/eec3a468-afd5-4d72-a61e-cd1964fb686c%28Office.15%29.aspx) <br/> |В атрибуте **Id** возвращает строку, содержащую идентификатор пользователя.  <br/> |В атрибуте **Id** совпадает с EwsId для пользователя.  <br/> |
|[ContactId](http://msdn.microsoft.com/library/86f66275-1e39-48ed-bd89-ac3bffc465a7%28Office.15%29.aspx) <br/> |В атрибуте **Id** возвращает строку, содержащую идентификатор контакта.  <br/> |В атрибуте **Id** совпадает с EwsId для этого контакта.  <br/> |
|[GroupId](http://msdn.microsoft.com/library/656d9b9a-8a65-4a75-8466-5b0d96512dab%28Office.15%29.aspx) <br/> |В атрибуте **Id** возвращает строку, содержащую идентификатор группы.  <br/> |В атрибуте **Id** совпадает с EwsId для группы.  <br/> |
|[AssociatedCalendarItemId](http://msdn.microsoft.com/library/5b29898c-ea59-4e6a-914c-c011ec754032%28Office.15%29.aspx) <br/> |Атрибут **Id** идентифицирует элемент календаря, связанного с [MeetingMessage](http://msdn.microsoft.com/library/c95956a8-7505-44b4-bea4-11d1f5182796%28Office.15%29.aspx), [MeetingRequest](http://msdn.microsoft.com/library/c44f8804-a355-473d-a837-48cc91617251%28Office.15%29.aspx), [MeetingResponse](http://msdn.microsoft.com/library/9f798e79-dafd-4d4d-9967-95fd8e5c0502%28Office.15%29.aspx)или [MeetingCancellation](http://msdn.microsoft.com/library/a9c61f7f-2ecd-4b21-9dce-24d9f61aeeea%28Office.15%29.aspx).  <br/> |В атрибуте **Id** совпадает с EwsId для элемента календаря.  <br/> |
|[UserConfigurationProperties](http://msdn.microsoft.com/library/c143a6ec-62ad-4d48-b844-b1ad88054bc1%28Office.15%29.aspx) <br/> |Значение **идентификатора** для этого элемента указывает свойство идентификатора.  <br/> |Этот идентификатор не соответствует непосредственно EwsId с момента его свойство идентификатора и не элемента.  <br/> |
|[OccurrenceItemId](http://msdn.microsoft.com/library/4a15bbc3-5b93-4193-b9ec-da32f0a9a552%28Office.15%29.aspx) <br/> |Атрибут **RecurringMasterId** определяет основной повторяющегося элемента.  <br/> |Значение **OccurrenceItemId** не соответствует непосредственно EwsId, но **RecurringMasterId** поступает, потому что она ссылается на объект верхнего уровня повторяющегося элемента.  <br/> |
|[StoreEntryId](http://msdn.microsoft.com/library/f536e264-8c4d-4cc5-bab8-22a4fa38de39%28Office.15%29.aspx) <br/> |Содержит идентификатор элемента хранилища Exchange.  <br/> |Значение **StoreEntryId** не соответствует EwsId, но он предоставить идентификатор хранилища, где хранятся элементы.  <br/> |
   
## <a name="working-with-identifiers"></a>Работа с идентификаторами
<a name="bk_WorkingWithIdentifiers"> </a>

Exchange server обрабатывает идентификаторов для большого числа различными способами. При разработке управляемый API EWS или приложение веб-служб Exchange, учитывайте следующее.
  
- Значение элемента **ItemID** для папок и элементов с учетом регистра. Если вы откроете идентификатор элемента для папку или элемент, который возвращается [операции FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) (или методом управляемый API EWS [FindItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) ), может показаться, что он совпадает с другой идентификатор элемента; Тем не менее один или несколько знаков в идентификаторов элементов для двух элементов будут иметь разные дела. 
    
- Необходимо хранить идентификатор элемента в базе данных для получения более поздней версии, мы рекомендуем использовать, что размер поля 512 байт, таким образом, достаточное для хранения GUID.
    
- Не предполагается, что ваш ID всегда будет действительным, если вам нужно извлечь элемент в дальнейшем. Если сообщение перемещено в хранилище, из-за того, который обрабатывается перемещения можно изменить идентификатор. Элемент фактически копируется и создается новый идентификатор и затем [исходный элемент удаляется](deleting-items-by-using-ews-in-exchange.md).
    
- Идентификаторы в Exchange — непрозрачный. Например EwsId будет создан из нескольких частей сведения, которые не являются важными для вас как разработчик, но важны для Exchange.
    
- При работе с элементами в Exchange, другим значением следует помнить о является атрибутом **ChangeKey** . Это значение, в дополнение к идентификатор элемента используется для отслеживания состояния элемента. При каждом изменении элемента создается новый ключ изменения. При выполнении [операции UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx), к примеру, можно использовать атрибут **ChangeKey** сообщите сервера знать, что обновление применяется к последней версии элемента. Если другое приложение внесены изменения элемента, для обновления, могут не соответствовать ключей изменения, и вы не сможете выполнять обновление. 
    
## <a name="distinguished-folder-ids"></a>Именованной папки идентификаторы
<a name="bk_DistinguishedFolderIds"> </a>

Exchange включает в себя ряд папки предварительно определенных почтовых ящиков, каждая из которых присваивается идентификатор, известных как с идентификатором именованной папки. Они определены перечисление управляемый API EWS [WellKnownFolderName](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.wellknownfoldername%28v=exchg.80%29.aspx) и элемент [DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) веб-служб Exchange. Можно использовать следующие идентификаторы именованной папки проще ссылка одного из стандартных папок. Например для папки "Входящие", можно просто использовать «входящие» для идентификатора, а не определение идентификатор папки. 
  
Другие папки, создаваемые для организации элементов электронной почты также иметь код, который является уникальным для этой папки. Этот идентификатор ID не изменяется даже в том случае, если изменения других свойств в общей папке.
  
Идентификаторы именованной папки можно использовать как точки входа для доступа делегата. При запуске делегированный доступ, вы поиск элементов и папок и предоставление ИД именованной папки, чтобы указать, где для поиска. Если делегат пользователь получает доступ к серверу, явным образом укажите почтовый ящик для делегат для доступа к используется элемент [почтового ящика](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) , который является дочерним по отношению к элементу **DistinguishedFolderId** . 
  
## <a name="handling-errors"></a>Обработка ошибок
<a name="bk_DealingWithErrors"> </a>

Каждая программа привязан к и сообщение об ошибке, и приложений на основе веб-служб Exchange не являются исключением (совместной предназначен). Вы можете получить некоторые ошибки, связанные с идентификатор в элементе [ResponseCode](http://msdn.microsoft.com/library/4b84d670-74c9-4d6d-84e7-f0a9f76f0d93%28Office.15%29.aspx) веб-служб Exchange, а также как часть перечисления [ServiceError](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.serviceerror%28v=exchg.80%29.aspx) управляемый API веб-служб Exchange. 
  
Управляемый API EWS или приложение веб-служб Exchange могут возникать следующие ошибки. При работе с приложением управляемый API EWS ошибки, которые обычно проблемы, связанные с значения свойств; для приложений веб-служб Exchange ошибки связаны с XML-элемент значения или операции.
  
**В таблице 2. Ошибки, связанные с идентификатором**

|**Error**|**Происходит, когда...**|**Описание**|
|:-----|:-----|:-----|
|ErrorCalendarCannotUseIdForOccurrenceId  <br/> |Значение **OccurenceID** не соответствует допустимый повторяющегося элемента календаря.  <br/> |Значение **OccurenceId** , который был указан в запросе могут стать недействительными в структуре, но запрос может быть не соответствует существующей повторяющейся образец. Повторяющегося элемента может быть удалена из календаря. Убедитесь, что элемент по-прежнему существует и что используется правильный идентификатор.  <br/> |
|ErrorCalendarCannotUseIdForRecurringMasterId  <br/> |Атрибут **RecurringMasterId** не соответствует допустимый вхождения элемента **OccurrenceId** .  <br/> |Значение **RecurringMasterId** , который был указан в запросе могут стать недействительными в структуре, но запрос может быть не соответствует существующий экземпляр элемента. Вхождения элемента может быть удалена из календаря. Убедитесь, что элемент по-прежнему существует и что используется правильный идентификатор.  <br/> |
|ErrorCannotUseFolderIdForItemId  <br/> |**Идентификатор** , который был передан представляет папку вместо элемента.  <br/> |Идентификатор может быть допустимый формат, но не то, что сервер ожидал для операции. Убедитесь в том, что вы ссылаетесь правильный идентификатор для операции.  <br/> |
|ErrorCannotUseItemIdForFolderId  <br/> |**Идентификатор** , который был передан представляет элемент вместо папки.  <br/> |Идентификатор может быть допустимый формат, но не то, что сервер ожидал для операции. Убедитесь, что вы ссылаетесь правильный **идентификатор** для операции.  <br/> |
|ErrorChangeKeyRequiredForWriteOperations  <br/> |При выполнении определенных операций обновления необходимо предоставить допустимый ключ изменения.  <br/> |Либо значение **ChangeKey** опущен при запросе обновления или неправильный ключ изменения. Убедитесь, что у вас есть правильные изменить ключ при выполнении операций обновления.  <br/> |
|ErrorInvalidAttachmentId  <br/> |Вложение не найдено в коллекции вложений для элемента.  <br/> |Вы можете получить данный код ответа, если у вас есть **идентификатор** вложения и удаляется вложение и попробуйте позвонить [операции GetAttachment](http://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx) идентификатор вложения. Убедитесь, что вложение существует в коллекции вложений.  <br/> |
|ErrorInvalidChangeKey  <br/> |Был передан недопустимый ключ изменения.  <br/> |Обратите внимание, что много операций и методы не требуется изменить ключ для передачи. Тем не менее если изменить ключ, он должен быть допустимым, несмотря на то, что она не обязательно соответствовать действительности.  <br/> |
|ErrorInvalidFolderId  <br/> |**Идентификатор** папки поврежден.  <br/> |Убедитесь, что у вас есть правильно отформатирован и допустимый идентификатор.  <br/> |
|ErrorInvalidId  <br/> |Структура **идентификатора** и/или изменить ключ несогласованные во внутренней сети.  <br/> |Exchange произошла ошибка с **Идентификатором** после его разбора. Может произошла ошибка при преобразовании. Это может произойти, к примеру, если у вас есть **IdFormatType.HexEntryId** для элемента в Outlook, но преобразования его EwsId мысли было формате **IdFormatType.EntryId** . Убедитесь, что используется правильный преобразования типа.  <br/> |
|ErrorInvalidIdEmpty  <br/> |Приложения указан **идентификатор** , который является пустым.  <br/> |Приложения, переданных в пустую строку для идентификатора. Убедитесь, что у вас есть правильно отформатирован и допустимый идентификатор.  <br/> |
|ErrorInvalidIdMalformed  <br/> |Структура **идентификатора** несогласованные во внутренней сети.  <br/> |Exchange произошла ошибка с **Идентификатором** после его разбора. Идентификатор может не были преобразованы правильно. Убедитесь, что используется правильный преобразования типа.  <br/> |
|ErrorInvalidIdMalformedEwsLegacyIdFormat  <br/> |Папки или элемента **ID** , в формате Exchange 2007 был задан для запроса с версией Exchange 2007 с пакетом обновления 1 или более поздней версии.  <br/> |Нельзя использовать идентификаторы Exchange 2007 в Exchange 2007 с пакетом обновления 1 или более поздней версии запросы. Для преобразования их сначала необходимо использовать операции EWS [ConvertId](http://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx) или метод [ConvertId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.convertid%28v=exchg.80%29.aspx) управляемый API веб-служб Exchange.  <br/> |
|ErrorInvalidIdNotAnItemAttachmentId  <br/> |Свойство **идентификатора вложения AttachmentId** не относится к вложение элемента.  <br/> |Идентификатор может быть допустимый формат, но не то, что сервер ожидал для операции. Убедитесь в том, что вы ссылаетесь правильный идентификатор для операции.  <br/> |
|ErrorInvalidIdReturnedByResolveNames  <br/> |Контакт в почтовом ящике поврежден.  <br/> |Операция EWS [ResolveNames](http://msdn.microsoft.com/library/6b4eb4b3-9ad6-4804-a09f-7e20cfea4dbb%28Office.15%29.aspx) и метод управляемый API EWS [ResolveName](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.resolvename%28v=exchg.80%29.aspx) возвращается один или несколько идентификаторов, но они недоступны. Необходимо повторно создать контакт.  <br/> |
|ErrorInvalidIdStoreObjectIdTooLong  <br/> |Структура **идентификатора** несогласованные во внутренней сети.  <br/> |Exchange произошла ошибка с **Идентификатором** после его разбора. **Код** может не были преобразованы правильно. Убедитесь, что используется правильный преобразования типа.  <br/> |
|ErrorInvalidIdTooManyAttachmentLevels  <br/> |Иерархии вложений превышено максимально допустимое количество 255 уровней.  <br/> |Значение свойства **идентификатора вложения AttachmentId** , который был указан в запросе могут стать недействительными в структуре, но запрошенный вложения слишком большая в иерархии. Код мог попытаться вложить элемент за пределы 255 уровней.  <br/> |
|ErrorInvalidImContactId  <br/> |Эта ошибка могут быть возвращены, если не удается найти контакт в группе мгновенные сообщения, при использовании [RemoveImContactFromGroup операции](http://msdn.microsoft.com/library/a190bbec-c71b-4e6a-880b-55854c724d8c%28Office.15%29.aspx). Эта ошибка применяется к клиентам, предназначенных для Exchange Online и версии Exchange, начиная с Exchange 2013.  <br/> |Значение свойства **ContactId** , который был указан в запросе могут стать недействительными в структуре, но нет контактов в почтовом ящике match эту структуру. Контакт был удален уже.  <br/> |
|ErrorInvalidImGroupId  <br/> |Эта ошибка могут быть возвращены, если не удается найти группу в почтовом ящике, при использовании [RemoveImGroup операции](http://msdn.microsoft.com/library/5e788016-68e0-4a3f-9243-03f6b6c6b389%28Office.15%29.aspx). Эта ошибка применяется к клиентам, предназначенных для Exchange Online и версии Exchange, начиная с Exchange 2013.  <br/> |Значение свойства **GroupId** , который был указан в запросе могут стать недействительными в структуре, но не группы в почтовом ящике match эту структуру. Группа удалена уже.  <br/> |
|ErrorInvalidReferenceItem  <br/> |Идентификатор указанного элемента не **MessageType** или **ExchangeWebServices.CalendarItemTypeType**или один из своих потомков. Идентификатор элемента ссылки для объекта **CalendarItemType** и организатора пытается Reply или ReplyAll.  <br/> |Идентификатор может быть допустимый формат, но не то, что сервер ожидал для операции. Убедитесь в том, что вы ссылаетесь правильный идентификатор для операции.  <br/> |
|ErrorMissingManagedFolderId  <br/> |Свойство идентификаторов политики тег свойства 0x6732 для папки отсутствует.  <br/> |Папка повреждена. Рекомендуется повторно создать его.  <br/> |
   
## <a name="converting-identifiers"></a>Преобразование идентификаторов
<a name="bk_ConvertingIdentifiers"> </a>

Может потребоваться преобразовать идентификатор из одного формата в другой. Например необходимо преобразовать идентификатор из внешней EWS, такие как идентификатор, поступающие из подключения MAPI, в формат, который может использовать приложения. Для этого можно использовать операцию [ConvertId](http://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx) веб-служб Exchange, либо метод [ConvertId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.convertid%28v=exchg.80%29.aspx) управляемый API веб-служб Exchange. 
  
Например идентификатор записи — это уникальный идентификатор, созданный хранилище сообщений MAPI, назначенный магазином при сохранении элемента. Чтобы использовать EntryID в приложении, необходимо сначала преобразовать его для EwsId. 
  
Outlook Web App использует свою собственную версию идентификаторам, OwaId, в URL-адреса для доступа к папкам и элементам. Если приложению для доступа к элементам в Outlook Web App, необходимо преобразовать OwaId в EwsId.
  
Операция **ConvertId** или метод можно использовать для преобразования несколько форматов другой идентификатор. 
  
**В таблице 3. Конвертируемая идентификатор форматов в Exchange**

|**Формат**|**Описание**|
|:-----|:-----|
|EwsLegacyId  <br/> |EwsId, которое применяется к Exchange 2007.  <br/> |
|EwsId  <br/> |EwsId, которое применяется к Exchange Online и версии Exchange, начиная с Exchange 2007 с пакетом обновления 1.  <br/> |
|StoreId  <br/> |Идентификатор хранилища Exchange, где хранятся папок и элементов.  <br/> |
|OwaId  <br/> |Идентификатор Outlook Web App, используемый с Outlook Web App в Exchange 2007 и Exchange 2010. <br/><br/>**Примечание**: Exchange Online и версии Exchange, начиная с Exchange 2013 использование EwsId для Outlook Web App.           |
|Идентификатор записи  <br/> |Идентификатор MAPI, известен как свойство **PR_ENTRYID** сообщения MAPI.  <br/> |
|HexEntryId  <br/> |Представление шестнадцатеричном формате свойство **PR_ENTRYID** , используемый для идентификатора события календаря доступности. Это формат идентификатора, используемый Outlook.  <br/> |
   
## <a name="see-also"></a>См. также

- [Разработка клиентов веб-служб для Exchange](develop-web-service-clients-for-exchange.md)  
- [Операция ConvertId](http://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx)  
- [Перечисление ServiceError](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.serviceerror%28v=exchg.80%29.aspx) 
- [Удаление элементов с помощью веб-служб Exchange в Exchange](deleting-items-by-using-ews-in-exchange.md)
    

