---
title: Вложения и веб-службах Exchange
manager: sethgros
ms.date: 7/11/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 8e4289a4-ec9d-4502-9854-c593c95d5f98
description: Сведения о вложениях и как управляемый API EWS или веб-служб Exchange в Exchange client представляет их.
ms.openlocfilehash: e4a97873798b8252e6fc14003519ce8a0eab7ec8
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19760937"
---
# <a name="attachments-and-ews-in-exchange"></a><span data-ttu-id="3a047-103">Вложения и веб-службах Exchange</span><span class="sxs-lookup"><span data-stu-id="3a047-103">Attachments and EWS in Exchange</span></span>

<span data-ttu-id="3a047-104">Сведения о вложениях и как управляемый API EWS или веб-служб Exchange в Exchange client представляет их.</span><span class="sxs-lookup"><span data-stu-id="3a047-104">Learn about attachments and how your EWS Managed API or EWS in Exchange client represents them.</span></span>
  
<span data-ttu-id="3a047-105">Как правило, вложения, связанные с электронной почты элементов, но в действительности все элементы веб-служб Exchange — по электронной почте сообщения, элементы календаря, контакты, задачи, может содержать вложения.</span><span class="sxs-lookup"><span data-stu-id="3a047-105">Usually, attachments are associated with email items, but in fact, all EWS items — email messages, calendar items, contacts, tasks — can include attachments.</span></span>
  
## <a name="types-of-attachments"></a><span data-ttu-id="3a047-106">Типы для вложений</span><span class="sxs-lookup"><span data-stu-id="3a047-106">Types of attachments</span></span>

<span data-ttu-id="3a047-107">Веб-служб Exchange разделяет на категории вложений на две группы: файла вложения и вложений элемента.</span><span class="sxs-lookup"><span data-stu-id="3a047-107">EWS categorizes attachments into two groups: file attachments and item attachments.</span></span>
  
- <span data-ttu-id="3a047-108">**Item вложения:** Строго типизированные [элементы веб-служб Exchange](folders-and-items-in-ews-in-exchange.md), таких как сообщения электронной почты и элементы календаря, подключенные к другим элементом строго типизированных веб-служб Exchange.</span><span class="sxs-lookup"><span data-stu-id="3a047-108">**Item attachments:** Strongly-typed [EWS items](folders-and-items-in-ews-in-exchange.md), such as email messages and calendar items, that are attached to another strongly-typed EWS item.</span></span> <span data-ttu-id="3a047-109">Любой элемент строго типизированные, которое может создаваться с помощью управляемого интерфейса API веб-служб Exchange или веб-служб Exchange можно использовать в качестве вложения элемента.</span><span class="sxs-lookup"><span data-stu-id="3a047-109">Any strongly-typed item that can be created by using the EWS Managed API or EWS can be used as an item attachment.</span></span> <span data-ttu-id="3a047-110">Содержимое вложения элемента — это элемент строго типизированные, который предоставляет доступ ко всем его свойствам.</span><span class="sxs-lookup"><span data-stu-id="3a047-110">The content of an item attachment is the strongly-typed item, which provides easy access to all its properties.</span></span> <span data-ttu-id="3a047-111">Вложений элемента может иметь свои собственные вложений элемента, поэтому иерархия вложений элемента (или вложенных и вложения) — это возможно.</span><span class="sxs-lookup"><span data-stu-id="3a047-111">Item attachments can have their own item attachments, so a hierarchy of item attachments (or nesting of attachments) is possible.</span></span>
    
- <span data-ttu-id="3a047-112">**Вложений:** Всех файлов, например .txt, .jpg, .zip, PDF-файл, или даже MSG-файл.</span><span class="sxs-lookup"><span data-stu-id="3a047-112">**File attachments:** Any file, such as a .txt, .jpg, .zip, .pdf, or even a .msg file.</span></span> <span data-ttu-id="3a047-113">Вложенный файл имеет только несколько свойств, одним из них является base 64 закодированное содержимое файла.</span><span class="sxs-lookup"><span data-stu-id="3a047-113">A file attachment only has a few properties, one of which is the base-64 encoded content of the file.</span></span> 
    
- <span data-ttu-id="3a047-114">**Ссылки вложения:** Любое вложение, на который ссылается файл поставщика, например в файле, расположенном в облаке.</span><span class="sxs-lookup"><span data-stu-id="3a047-114">**Reference attachments:** Any attachment that is referenced by a file provider, such as a file located in the cloud.</span></span> <span data-ttu-id="3a047-115">Вложение можно из нескольких поставщиков.</span><span class="sxs-lookup"><span data-stu-id="3a047-115">An attachment can be from multiple providers.</span></span> 
    
<span data-ttu-id="3a047-116">При добавлении или получения вложений из элемента, он будет выполняться по-разному в зависимости от того, будет ли это вложенный файл или элемент вложения.</span><span class="sxs-lookup"><span data-stu-id="3a047-116">When you add or retrieve attachments from an item, you'll do it differently depending on whether it's a file attachment or an item attachment.</span></span> <span data-ttu-id="3a047-117">Например чтобы добавить подключение файла к элементу, достаточно передавать в расположение файла.</span><span class="sxs-lookup"><span data-stu-id="3a047-117">For example, to add a file attachment to an item, you can just pass in the location of the file.</span></span> <span data-ttu-id="3a047-118">Чтобы добавить существующий элемент как вложение элемента, нужно скопировать свойства или содержимого MIME существующий элемент вложение элемента; только что не удается выполнить привязку к существующий элемент.</span><span class="sxs-lookup"><span data-stu-id="3a047-118">To add an existing item as an item attachment, you actually have to copy the properties or the MIME content of the existing item to a new item attachment; you can't just bind to the existing item.</span></span> <span data-ttu-id="3a047-119">Важно, так что различения двух типов вложений.</span><span class="sxs-lookup"><span data-stu-id="3a047-119">So distinguishing between the two types of attachments is important.</span></span> <span data-ttu-id="3a047-120">В статьи [в этом разделе](#bk_inthissection)рассматриваются дополнительные сведения о различиях между вложений элемента и вложенных файлов.</span><span class="sxs-lookup"><span data-stu-id="3a047-120">More details about the differences between item attachments and file attachments are discussed in the articles [In this section](#bk_inthissection).</span></span>
  
## <a name="how-are-attachments-represented-programmatically"></a><span data-ttu-id="3a047-121">Как вложения представлены программным способом?</span><span class="sxs-lookup"><span data-stu-id="3a047-121">How are attachments represented programmatically?</span></span>

<span data-ttu-id="3a047-122">Вложения хранятся в коллекции для элемента веб-служб Exchange.</span><span class="sxs-lookup"><span data-stu-id="3a047-122">Attachments are stored in a collection on the EWS item.</span></span> <span data-ttu-id="3a047-123">Коллекция вложений состоит из файлов вложений и/или вложений элемента.</span><span class="sxs-lookup"><span data-stu-id="3a047-123">The attachments collection is made up of file attachments and/or item attachments.</span></span> <span data-ttu-id="3a047-124">Метаданные о коллекции вложений доступен, если вы получаете элемента с помощью метода управляемый API EWS [Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) или операции EWS [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) , но необходимые дополнительные вызовы для извлечения содержимого вложения.</span><span class="sxs-lookup"><span data-stu-id="3a047-124">Metadata about the attachment collection is available when you get an item by using the EWS Managed API [Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method or the EWS [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operation, but additional calls are required to actually retrieve the contents of the attachments.</span></span> 
  
<span data-ttu-id="3a047-125">**В таблице 1. Метаданные о вложениях**</span><span class="sxs-lookup"><span data-stu-id="3a047-125">**Table 1. Item metadata about attachments**</span></span>

|<span data-ttu-id="3a047-126">**Объект метаданных**</span><span class="sxs-lookup"><span data-stu-id="3a047-126">**Metadata entity**</span></span>|<span data-ttu-id="3a047-127">**Свойство управляемый API EWS**</span><span class="sxs-lookup"><span data-stu-id="3a047-127">**EWS Managed API property**</span></span>|<span data-ttu-id="3a047-128">**Элемент веб-служб Exchange**</span><span class="sxs-lookup"><span data-stu-id="3a047-128">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="3a047-129">Значок вложения (не помечает встроенные вложения)</span><span class="sxs-lookup"><span data-stu-id="3a047-129">Attachment indicator (does not flag inline attachments)</span></span>  <br/> |[<span data-ttu-id="3a047-130">Item.HasAttachments</span><span class="sxs-lookup"><span data-stu-id="3a047-130">Item.HasAttachments</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="3a047-131">HasAttachments</span><span class="sxs-lookup"><span data-stu-id="3a047-131">HasAttachments</span></span>](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="3a047-132">Коллекция вложений</span><span class="sxs-lookup"><span data-stu-id="3a047-132">Attachment collection</span></span>  <br/> |[<span data-ttu-id="3a047-133">Item.Attachments</span><span class="sxs-lookup"><span data-stu-id="3a047-133">Item.Attachments</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.attachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="3a047-134">Вложения</span><span class="sxs-lookup"><span data-stu-id="3a047-134">Attachments</span></span>](http://msdn.microsoft.com/library/b470e614-34bb-44f0-8790-7ddbdcbbd29d%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="3a047-135">Идентификатор вложения</span><span class="sxs-lookup"><span data-stu-id="3a047-135">Attachment ID</span></span>  <br/> |[<span data-ttu-id="3a047-136">Attachment.Id</span><span class="sxs-lookup"><span data-stu-id="3a047-136">Attachment.Id</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.id%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="3a047-137">Идентификатора вложения AttachmentId</span><span class="sxs-lookup"><span data-stu-id="3a047-137">AttachmentId</span></span>](http://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) <br/> |
   
<span data-ttu-id="3a047-138">**В таблице 2. Сущности вложения**</span><span class="sxs-lookup"><span data-stu-id="3a047-138">**Table 2. Attachment entities**</span></span>

|<span data-ttu-id="3a047-139">**Тип вложения**</span><span class="sxs-lookup"><span data-stu-id="3a047-139">**Attachment type**</span></span>|<span data-ttu-id="3a047-140">**Управляемый API EWS класс**</span><span class="sxs-lookup"><span data-stu-id="3a047-140">**EWS Managed API class**</span></span>|<span data-ttu-id="3a047-141">**Элемент веб-служб Exchange**</span><span class="sxs-lookup"><span data-stu-id="3a047-141">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="3a047-142">Вложенный файл</span><span class="sxs-lookup"><span data-stu-id="3a047-142">File attachment</span></span>  <br/> |[<span data-ttu-id="3a047-143">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="3a047-143">FileAttachment</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.fileattachment%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="3a047-144">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="3a047-144">FileAttachment</span></span>](http://msdn.microsoft.com/library/3ecea174-73d1-47fd-8917-6065cef1d565%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="3a047-145">Вложение элемента</span><span class="sxs-lookup"><span data-stu-id="3a047-145">Item attachment</span></span>  <br/> |[<span data-ttu-id="3a047-146">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="3a047-146">ItemAttachment</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.itemattachment%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="3a047-147">ItemAttachment\<TItem\></span><span class="sxs-lookup"><span data-stu-id="3a047-147">ItemAttachment\<TItem\></span></span>](http://msdn.microsoft.com/en-us/library/dd635165%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="3a047-148">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="3a047-148">ItemAttachment</span></span>](http://msdn.microsoft.com/library/089ee599-f45e-46f5-a18a-5cfb3d2851ff%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="3a047-149">Вложение в виде ссылки</span><span class="sxs-lookup"><span data-stu-id="3a047-149">Reference attachment</span></span>  <br/> |[<span data-ttu-id="3a047-150">ReferenceAttachmentType complexType (EWS)</span><span class="sxs-lookup"><span data-stu-id="3a047-150">ReferenceAttachmentType complexType (EWS)</span></span>](http://msdn.microsoft.com/library/18bfa012-e903-d7f3-528a-31ccceb65463%28Office.15%29.aspx) <br/> |[<span data-ttu-id="3a047-151">ReferenceAttachment</span><span class="sxs-lookup"><span data-stu-id="3a047-151">ReferenceAttachment</span></span>](http://msdn.microsoft.com/library/b9bde862-6b75-4a81-8033-00a47be4dc2f%28Office.15%29.aspx) <br/> |
   
## <a name="inline-attachments"></a><span data-ttu-id="3a047-152">Встроенные вложения</span><span class="sxs-lookup"><span data-stu-id="3a047-152">Inline attachments</span></span>

<span data-ttu-id="3a047-153">Встроенные вложения — это специальные поколения вложения.</span><span class="sxs-lookup"><span data-stu-id="3a047-153">Inline attachments are a special breed of attachment.</span></span> <span data-ttu-id="3a047-154">Оба файла вложения и вложений элемента может быть встроенные вложения.</span><span class="sxs-lookup"><span data-stu-id="3a047-154">Both file attachments and item attachments can be inline attachments.</span></span> <span data-ttu-id="3a047-155">Встроенным появится как часть содержимое текста запроса и сохраняет его положение относительно остального содержимого в элементе.</span><span class="sxs-lookup"><span data-stu-id="3a047-155">An inline attachment appears as part of the body content and retains its position relative to the rest of the content in the item.</span></span> 
  
<span data-ttu-id="3a047-156">Вложение является встроенным, если свойство управляемый API EWS [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) или элемент веб-служб Exchange [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) задано значение true.</span><span class="sxs-lookup"><span data-stu-id="3a047-156">An attachment is an inline attachment if the EWS Managed API [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element is set to true.</span></span> <span data-ttu-id="3a047-157">Встроенные вложения используются следующие дополнительные свойства и элементы для определения местоположения встроенным:</span><span class="sxs-lookup"><span data-stu-id="3a047-157">Inline attachments use the following optional properties and elements to identify the location of an inline attachment:</span></span> 
  
- <span data-ttu-id="3a047-158">Управляемый API EWS — [ContentId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) или [ContentLocation](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) свойств.</span><span class="sxs-lookup"><span data-stu-id="3a047-158">EWS Managed API — [ContentId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) or [ContentLocation](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) properties.</span></span> 
    
- <span data-ttu-id="3a047-159">Веб-служб Exchange — Элемент [ContentId](http://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) или [ContentLocation](http://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3a047-159">EWS — [ContentId](http://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) or [ContentLocation](http://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) element.</span></span> 
    
<span data-ttu-id="3a047-160">Обратите внимание, что свойство управляемый API EWS [HasAttachments](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) и веб-служб Exchange [HasAttachments](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) элемент не отражают существование встроенные вложения, и почему также называются встроенные вложения скрыты вложения.</span><span class="sxs-lookup"><span data-stu-id="3a047-160">Note that the EWS Managed API [HasAttachments](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) property and the EWS [HasAttachments](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) element do not reflect the existence of inline attachments, and that's why inline attachments are also called hidden attachments.</span></span> <span data-ttu-id="3a047-161">Поэтому если задать свойство управляемый API EWS [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) или элемент веб-служб Exchange [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) имеет значение true, а у элемента есть не другие вложения, **HasAttachments** будет иметь значение false.</span><span class="sxs-lookup"><span data-stu-id="3a047-161">So if you set the EWS Managed API [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element to true, and the item has no other attachments, **HasAttachments** will be set to false.</span></span> <span data-ttu-id="3a047-162">Если ваш клиент использует **HasAttachments** для заполнения значок вложения или значок на сообщения электронной почты, обратите внимание, что значок будет отображаться для сообщений электронной почты с вложениями встроенного.</span><span class="sxs-lookup"><span data-stu-id="3a047-162">If your client uses **HasAttachments** to populate an attachment indicator or icon on an email, be aware that the icon will not appear for emails with inline attachments.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="3a047-163">В этом разделе</span><span class="sxs-lookup"><span data-stu-id="3a047-163">In this section</span></span>
<span data-ttu-id="3a047-164"><a name="bk_inthissection"> </a></span><span class="sxs-lookup"><span data-stu-id="3a047-164"></span></span>

- [<span data-ttu-id="3a047-165">Добавление вложения с помощью веб-служб Exchange в Exchange</span><span class="sxs-lookup"><span data-stu-id="3a047-165">Add attachments by using EWS in Exchange</span></span>](how-to-add-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="3a047-166">Получение вложений с помощью веб-служб Exchange в Exchange</span><span class="sxs-lookup"><span data-stu-id="3a047-166">Get attachments by using EWS in Exchange</span></span>](how-to-get-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="3a047-167">Удаление вложений с помощью веб-служб Exchange в Exchange</span><span class="sxs-lookup"><span data-stu-id="3a047-167">Delete attachments by using EWS in Exchange</span></span>](how-to-delete-attachments-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="3a047-168">См. также</span><span class="sxs-lookup"><span data-stu-id="3a047-168">See also</span></span>
<span data-ttu-id="3a047-169"><a name="bk_additionalresources"> </a></span><span class="sxs-lookup"><span data-stu-id="3a047-169"></span></span>

- [<span data-ttu-id="3a047-170">Разработка клиентов веб-служб для Exchange</span><span class="sxs-lookup"><span data-stu-id="3a047-170">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="3a047-171">Папки и элементы в веб-службах Exchange</span><span class="sxs-lookup"><span data-stu-id="3a047-171">Folders and items in EWS in Exchange</span></span>](folders-and-items-in-ews-in-exchange.md)
    
- [<span data-ttu-id="3a047-172">Электронная почта и веб-службах Exchange</span><span class="sxs-lookup"><span data-stu-id="3a047-172">Email and EWS in Exchange</span></span>](email-and-ews-in-exchange.md)
    

