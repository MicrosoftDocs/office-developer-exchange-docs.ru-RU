---
title: Проверка целостности резервного копирования с помощью средства Eseutil в Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: b0d325ba-4482-4ca2-9a69-c890f985b206
description: Узнайте, как использовать средство командной строки Eseutil для проверки резервного копирования хранилище Exchange.
ms.openlocfilehash: e8f1a46e2d94729ae5586861317312e277216d63
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2020
ms.locfileid: "44452799"
---
#  <a name="validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013"></a>Проверка целостности резервного копирования с помощью средства Eseutil в Exchange 2013

Узнайте, как использовать средство командной строки Eseutil для проверки резервного копирования хранилище Exchange. 
  
**Применимо к:** Exchange Server 2013 
  
Так как служба теневого копирования томов (VSS) может создавать резервные копии, пока Exchange продолжает записывать в базу данных, сервер не будет касаться всех страниц и выполнять необходимые проверки согласованности. По этой причине любое приложение резервного копирования и восстановления, использующее VSS, должно проверить согласованность моментальных снимков. Exchange Server 2013 поддерживает следующие два метода проверки согласованности моментальных снимков: 
  
- The CHKSGFILES API
    
- Средство командной строки Eseutil
    
Рекомендуется использовать API CHKSGFILES, так как приложению резервного копирования проще обнаруживать, диагностировать и сообщать об ошибках, обнаруженных во время проверки согласованности CHKSGFILES. Сведения об использовании API CHKSGFILES см. в подразделе "Проверка целостности резервного копирования с помощью [API CHKSGFILES в Exchange 2013".](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
  
## <a name="running-the-eseutil-tool"></a>Запуск средства Eseutil

Чтобы проверить согласованность моментальных снимков, запустите команду eseutil для базы данных и файлов журналов, которые определены в следующей таблице. 
  
**Таблица 1. Eseutil.exe для каждого типа резервного копирования**

|**Тип файла или тип резервного копирования**|**Полное резервное копирование**|**Копирование резервной копии**|**Добавоичное резервное копирование**|**Разнонаправленное резервное копирование**|
|:-----|:-----|:-----|:-----|:-----|
|EDB  <br/> |"eseutil /k /i"  <br/> |"eseutil /k /i"  <br/> |Неприменимо  <br/> |Неприменимо  <br/> |
|.log  <br/> |"eseutil /k" (1)  <br/> |"eseutil /k" (1)  <br/> |"eseutil /k" (2)  <br/> |"eseutil /k" (2)  <br/> |
   
> [!NOTE]
> Нет необходимости запускать команду eseutil для файлов STM и CHK. 
  
Все файлы журнала с номером создания файла журнала, равным или больше номера создания файла журнала контрольных точек, необходимы для восстановления базы данных моментальных снимков. Если он существует, для восстановления базы данных также требуется текущий файл журнала (Enn.log). Если какой-либо из необходимых файлов журнала не пройти проверку согласованности, запрашивающие должны убедиться, что для компонента резервного копирования установлено состояние FALSE, прежде чем он вызывает метод [BackupComplete.](https://msdn.microsoft.com/library/windows/desktop/aa382651%28v=vs.85%29.aspx) Чтобы определить файл журнала контрольной точки, запустите Eseutil.exe для файла контрольной точки моментального снимка и пройдите разчет выходных данных для "Контрольная точка:". В следующем примере показано, как выполнить Eseutil.exe файла контрольной точки. 
  
```cpp
c:\eseutil.exe /mk E01.chk
Checkpoint: (0x20, 9D, 187)
```

Вторая строка в примере — возвращаемое значение, где 0x20 — это номер генерации журнала для файла журнала контрольной точки. В этом примере файлы журналов, включая E010000020.log и более другие, не должны быть повреждены для восстановления базы данных моментальных снимков, даже если сама база данных уже прошла проверку физической согласованности.
  
Все файлы журналов в добавоичном или разнонаправленном резервном наборе необходимы для восстановления базы данных. Вы можете проверить согласованность последовательности журнала, Eseutil.exe с префиксом файла журнала. В следующем примере показано, как выполнить проверки согласованности для всех файлов формы E01xx.log на заданном пути.
  
```cpp
c:\eseutil /k E01
```

## <a name="checking-the-eseutilexe-output"></a>Проверка выходных Eseutil.exe данных

Запрашивающее средство должно убедиться, что все возвращаемые значения ошибки ERRORLEVEL не являются ненегрегативными. Сведения о значениях ERRORLEVEL см. в справке по распространенным ошибкам [Eseutil.](https://technet.microsoft.com/library/aa996759%28v=exchg.80%29.aspx) Чтобы увидеть ERRORLEVEL в командной строке, введите "echo %errorlevel%" Eseutil.exe завершения работы. Отрицательный ERRORLEVEL указывает на то, что один или несколько файлов повреждены.
  
Прежде чем запрашиватель вызывает метод **BackupComplete,** он должен убедиться, что состояние компонента резервного копирования отражает результат проверки согласованности. Если обнаружено любое повреждения, состояние будет иметь состояние FALSE; Если повреждения не найдены, состояние будет иметь состояние TRUE. 
  
## <a name="see-also"></a>См. также

- [Проверка целостности резервного копирования с помощью API CHKSGFILES в Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
- [Создание приложений резервного копирования и восстановления для Exchange 2013](build-backup-and-restore-applications-for-exchange-2013.md)
- [Справочник по классу CChkSGFiles](cchksgfiles-class-reference.md)
- [Концепции резервного копирования и восстановления для Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md)
    

