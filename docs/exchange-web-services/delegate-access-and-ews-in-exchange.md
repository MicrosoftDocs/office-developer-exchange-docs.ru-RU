---
title: Передача прав доступа и EWS в Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 240d1776-7adc-46cd-9099-88ffeba0a8aa
description: Узнайте, как использовать управляемый API EWS и EWS в Exchange для предоставления представителю доступа к почтовым ящикам пользователей.
ms.openlocfilehash: 344255d86a51e13b21f1eda5113d292395d7cb8f
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2018
ms.locfileid: "21354052"
---
# <a name="delegate-access-and-ews-in-exchange"></a><span data-ttu-id="c82fb-103">Передача прав доступа и EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="c82fb-103">Delegate access and EWS in Exchange</span></span>

<span data-ttu-id="c82fb-104">Узнайте, как использовать управляемый API EWS и EWS в Exchange для предоставления представителю доступа к почтовым ящикам пользователей.</span><span class="sxs-lookup"><span data-stu-id="c82fb-104">Find out how to use the EWS Managed API and EWS in Exchange to provide delegate access to users' mailboxes.</span></span>
  
<span data-ttu-id="c82fb-105">Вы можете разрешить пользователям доступ к почтовым ящикам других пользователей одним из трех способов:</span><span class="sxs-lookup"><span data-stu-id="c82fb-105">You can enable users to access other users' mailboxes in one of three ways:</span></span> 
  
- <span data-ttu-id="c82fb-106">Путем добавления делегатов и указания разрешений для каждого делегата.</span><span class="sxs-lookup"><span data-stu-id="c82fb-106">By adding delegates and specifying permissions for each delegate.</span></span>
    
- <span data-ttu-id="c82fb-107">Путем непосредственного изменения разрешений на доступ к папке.</span><span class="sxs-lookup"><span data-stu-id="c82fb-107">By modifying folder permissions directly.</span></span>
    
- <span data-ttu-id="c82fb-108">С помощью олицетворения.</span><span class="sxs-lookup"><span data-stu-id="c82fb-108">By using impersonation.</span></span>
    
<span data-ttu-id="c82fb-109">Разрешения на делегирование и папки лучше всего предоставить доступ только нескольким пользователям, так как необходимо добавлять разрешения по отдельности для каждого почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-109">Delegation and folder permissions are best when you're only granting access to a few users, because you have to add permissions individually to each mailbox.</span></span> <span data-ttu-id="c82fb-110">Олицетворение является лучшим выбором при работе с количествами почтовых ящиков, так как для доступа к каждому почтовому ящику в базе данных можно легко включить одну учетную запись службы.</span><span class="sxs-lookup"><span data-stu-id="c82fb-110">Impersonation is the best choice when you're dealing with quantities of mailboxes, because you can easily enable one service account to access every mailbox in a database.</span></span> <span data-ttu-id="c82fb-111">На рисунке 1 показаны некоторые различия между типами доступа.</span><span class="sxs-lookup"><span data-stu-id="c82fb-111">Figure 1 shows some of the differences between each type of access.</span></span>
  
<span data-ttu-id="c82fb-112">**Рис. 1. Способы доступа к почтовым ящикам других пользователей**</span><span class="sxs-lookup"><span data-stu-id="c82fb-112">**Figure 1. Ways to access other users' mailboxes**</span></span>

![Схема, на которой показаны типы доступа к почтовому ящику, связь между владельцами почтовых ящиков и делегатом для каждого типа, а также тип разрешения. Отправка от лица разрешений для делегирования и разрешений папок. Отправка как разрешений для олицетворения.](media/Ex15_Delegate_Overview.png)
  
<span data-ttu-id="c82fb-116">При отправке сообщений или планировании собраний делегатам могут быть предоставлены разрешения "Отправить от имени", поэтому получатель электронной почты или приглашения на собрание, отправленные представителем, увидят сообщение " *делегат* от имени *владельца почтового ящика* " при получении им доступа к электронной почте или приглашению на собрание в Outlook.</span><span class="sxs-lookup"><span data-stu-id="c82fb-116">When it comes to sending mail or scheduling meetings, delegates can be given "send on behalf of" permissions, so the recipient of an email or a meeting request that was sent by a delegate will see " *delegate*  on behalf of  *mailbox owner*  " when they receive the email or meeting request in Outlook.</span></span> <span data-ttu-id="c82fb-117">Включение текста "Отправить от имени" является подробным описанием реализации клиента и может создаваться с использованием значений "от" и "sender".</span><span class="sxs-lookup"><span data-stu-id="c82fb-117">Including the "send on behalf of" text is a client implementation detail - and can be created by using the "from" and "sender" values.</span></span> <span data-ttu-id="c82fb-118">Значение "от" указывает владельца почтового ящика, а значение "sender" указывает представителя, который отправил почту.</span><span class="sxs-lookup"><span data-stu-id="c82fb-118">The "from" value indicates the mailbox owner, and the "sender" value indicates the delegate that sent the mail.</span></span> <span data-ttu-id="c82fb-119">Если учетная запись службы, с помощью которой выполняется олицетворение пользователя отправляет сообщение электронной почты или планирует собрание для владельца почтового ящика, сообщение "отправляется как" владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-119">If a service account impersonating a user sends an email or schedules a meeting for the mailbox owner, the message is "sent as" the mailbox owner.</span></span> <span data-ttu-id="c82fb-120">У получателя нет способа узнать, что почта была отправлена учетной записью службы.</span><span class="sxs-lookup"><span data-stu-id="c82fb-120">There is no way for the recipient to know the mail was sent by the service account.</span></span> <span data-ttu-id="c82fb-121">Пользователи, которым предоставлены разрешения на доступ к папкам, а не представителю, не могут "Отправить как" или "Отправить от имени" владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-121">Users who are granted folder permissions and not delegate access are not able to "send as" or "send on behalf of" of a mailbox owner.</span></span> <span data-ttu-id="c82fb-122">У них есть доступ к папкам почтового ящика, и они могут создавать элементы в папках, но не могут отправлять элементы.</span><span class="sxs-lookup"><span data-stu-id="c82fb-122">They have access to the mailbox folders, and might be able to create items in the folders, but they cannot send the items.</span></span> 
  
<span data-ttu-id="c82fb-123">Когда нужно изменять разрешения для папки напрямую?</span><span class="sxs-lookup"><span data-stu-id="c82fb-123">When is it appropriate to modify folder permissions directly?</span></span> <span data-ttu-id="c82fb-124">Как правило, если вы хотите предоставить пользователю доступ к папке, но не хотите предоставлять пользователю разрешения "Отправить от имени", если требования к разрешениям не соответствуют значениям перечисления [делегатефолдерпермиссионлевел](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) EWS Managed API или значениям элементов [пермиссионлевел](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) EWS, или если вы хотите предоставить пользователю доступ к одной пользовательской папке.</span><span class="sxs-lookup"><span data-stu-id="c82fb-124">Generally, when you want to provide a user access to a folder, but do not want to grant the user "send on behalf of" permissions, when your permissions requirements do not map to the [DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) EWS Managed API enumeration values or the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) EWS element values, or when you want to provide a user access to a single custom folder.</span></span> 
  
<span data-ttu-id="c82fb-125">Если вам нужно изменить разрешения для папки, чтобы ее можно было использовать, и не нужно добавлять делегата (то есть вам не требуется разрешение "Отправить от имени"), ознакомьтесь с [разрешениями Set Folders for другого пользователя с помощью EWS в Exchange](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="c82fb-125">If you only need to modify folder permissions to achieve your goal, and do not need to add a delegate (that is, you don't need "send on behalf of" permissions), see [Set folder permissions for another user by using EWS in Exchange](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md).</span></span> 
  
<span data-ttu-id="c82fb-126">Обратите внимание, что вы также можете настроить доступ представителя с помощью [Outlook](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx) или [PowerShell (Командная консоль Exchange)](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) .</span><span class="sxs-lookup"><span data-stu-id="c82fb-126">Note that you can also use [Outlook](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx) or the [Exchange Server PowerShell (Exchange Management Shell)](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) to set up delegate access.</span></span> 
  
## <a name="how-does-delegate-access-work"></a><span data-ttu-id="c82fb-127">Как работает делегированный доступ?</span><span class="sxs-lookup"><span data-stu-id="c82fb-127">How does delegate access work?</span></span>

<span data-ttu-id="c82fb-128">Делегированный доступ позволяет пользователям получать доступ к некоторым или всем папкам владельца почтового ящика и выполнять действия от имени владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-128">Delegate access enables users to access some or all of the mailbox owner's folders and act on behalf of the mailbox owner.</span></span> <span data-ttu-id="c82fb-129">Владельцем почтового ящика может быть пользователь или ресурс, например Конференц-зал.</span><span class="sxs-lookup"><span data-stu-id="c82fb-129">The mailbox owner can be a user, or a resource, like a conference room.</span></span> <span data-ttu-id="c82fb-130">Например, пользователю секретарю могут быть предоставлены права представителя для папки календаря конференц-зала, чтобы обрабатывать запросы на бронирование.</span><span class="sxs-lookup"><span data-stu-id="c82fb-130">For example, a receptionist can be granted delegate permissions to a conference room's calendar folder, to handle booking requests.</span></span> <span data-ttu-id="c82fb-131">Вы можете использовать управляемый API EWS или EWS, чтобы разрешить владельцу почтового ящика или администратору добавить делегата, указать, к каким папкам может получить доступ представитель, а затем задать разрешения для этой папки.</span><span class="sxs-lookup"><span data-stu-id="c82fb-131">You can use the EWS Managed API or EWS to enable the mailbox owner or an administrator to add a delegate, specify what folders the delegate can access, and then specify permissions for that folder.</span></span> <span data-ttu-id="c82fb-132">Делегатам можно предоставлять доступ к следующим папкам:</span><span class="sxs-lookup"><span data-stu-id="c82fb-132">Delegates can be granted access to the following folders:</span></span> 
  
- <span data-ttu-id="c82fb-133">Календарь</span><span class="sxs-lookup"><span data-stu-id="c82fb-133">Calendar</span></span>
    
- <span data-ttu-id="c82fb-134">Задачи</span><span class="sxs-lookup"><span data-stu-id="c82fb-134">Tasks</span></span>
    
- <span data-ttu-id="c82fb-135">Inbox;</span><span class="sxs-lookup"><span data-stu-id="c82fb-135">Inbox</span></span>
    
- <span data-ttu-id="c82fb-136">Контакты</span><span class="sxs-lookup"><span data-stu-id="c82fb-136">Contacts</span></span>
    
- <span data-ttu-id="c82fb-137">Примечания</span><span class="sxs-lookup"><span data-stu-id="c82fb-137">Notes</span></span>
    
- <span data-ttu-id="c82fb-138">Журнал</span><span class="sxs-lookup"><span data-stu-id="c82fb-138">Journal</span></span>
    
<span data-ttu-id="c82fb-139">Когда пользователь получает доступ к одной или нескольким этим папкам, они могут создавать, получать, обновлять, удалять, копировать и искать элементы в этой папке и всех дочерних папках в зависимости от [разрешений](#bk_delegateperms) , заданных для папки.</span><span class="sxs-lookup"><span data-stu-id="c82fb-139">When a user has delegate access to one or more of these folders, they can create, get, update, delete, copy, and search for items in that folder and any child folders, depending on the [permissions](#bk_delegateperms) set on the folder.</span></span> <span data-ttu-id="c82fb-140">Способ выполнения приложением этих действий зависит от того, требуется ли [явный](#bk_explicit) или [неявный](#bk_implicit) доступ.</span><span class="sxs-lookup"><span data-stu-id="c82fb-140">The way in which the application performs these actions depends on whether [explicit](#bk_explicit) or [implicit](#bk_implicit) access is required.</span></span> 
  
## <a name="delegate-permissions"></a><span data-ttu-id="c82fb-141">Делегирование разрешений</span><span class="sxs-lookup"><span data-stu-id="c82fb-141">Delegate permissions</span></span>
<span data-ttu-id="c82fb-142"><a name="bk_delegateperms"> </a></span><span class="sxs-lookup"><span data-stu-id="c82fb-142"><a name="bk_delegateperms"> </a></span></span>

<span data-ttu-id="c82fb-143">Когда администратор или владелец почтового ящика добавляет делегата к почтовому ящику, он также может задать уровень разрешений для одной или нескольких папок.</span><span class="sxs-lookup"><span data-stu-id="c82fb-143">When an administrator or mailbox owner adds a delegate to a mailbox, they can also set the permission level for one or more folders.</span></span> <span data-ttu-id="c82fb-144">Если уровень разрешений не задан для папки, то по умолчанию в качестве значения разрешения задано значение None.</span><span class="sxs-lookup"><span data-stu-id="c82fb-144">If a permission level is not set for a folder, the permission value defaults to None.</span></span> <span data-ttu-id="c82fb-145">Несколько пользователей могут иметь один и тот же уровень разрешений для папки, и пользователи могут иметь разные уровни разрешений для разных папок.</span><span class="sxs-lookup"><span data-stu-id="c82fb-145">Multiple users can have the same permission level on a folder, and users can have different permission levels for different folders.</span></span> <span data-ttu-id="c82fb-146">Если вы используете управляемый API EWS, вы используете свойство [делегатеусер. Permissions](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx) , которое содержит одно из значений перечисления [делегатефолдерпермиссионлевел](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) для каждой папки, чтобы задать разрешения представителя для папок.</span><span class="sxs-lookup"><span data-stu-id="c82fb-146">If you're using the EWS Managed API, you use the [DelegateUser.Permissions](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx) property, which contains one of the [DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) enumeration values for each folder, to set delegate permissions on folders.</span></span> <span data-ttu-id="c82fb-147">Если вы используете EWS, используйте элемент [делегатепермиссионс](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx) для установки разрешений делегата, а элемент [пермиссионлевел](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) — для определения уровня разрешений.</span><span class="sxs-lookup"><span data-stu-id="c82fb-147">If you're using EWS, you use the [DelegatePermissions](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx) element to set delegate permissions, and the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) element to define the permission level.</span></span> 
  
<span data-ttu-id="c82fb-148">**Таблица 2. Уровни разрешений для представителей**</span><span class="sxs-lookup"><span data-stu-id="c82fb-148">**Table 2. Delegate permission levels**</span></span>

|<span data-ttu-id="c82fb-149">**Уровень разрешений**</span><span class="sxs-lookup"><span data-stu-id="c82fb-149">**Permission level**</span></span>|<span data-ttu-id="c82fb-150">**Описание**</span><span class="sxs-lookup"><span data-stu-id="c82fb-150">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="c82fb-151">Нет</span><span class="sxs-lookup"><span data-stu-id="c82fb-151">None</span></span>  <br/> |<span data-ttu-id="c82fb-152">Это значение используется по умолчанию для всех папок.</span><span class="sxs-lookup"><span data-stu-id="c82fb-152">This is the default value for all folders.</span></span>  <br/> |
|<span data-ttu-id="c82fb-153">Автор</span><span class="sxs-lookup"><span data-stu-id="c82fb-153">Author</span></span>  <br/> |<span data-ttu-id="c82fb-154">Представитель может читать и создавать элементы, а также изменять и удалять созданные ими элементы.</span><span class="sxs-lookup"><span data-stu-id="c82fb-154">A delegate can read and create items, and modify and delete items they create.</span></span> <span data-ttu-id="c82fb-155">Например, представитель может создавать запросы задач и приглашения на собрания непосредственно в папке "Календарь" владельца почтового ящика или в папке "Календарь", а затем отправлять один из элементов от имени владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-155">For example, a delegate can create task requests and meeting requests directly in the mailbox owner's Task or Calendar folder, and then send either item on the mailbox owner's behalf.</span></span>  <br/> |
|<span data-ttu-id="c82fb-156">Редактор</span><span class="sxs-lookup"><span data-stu-id="c82fb-156">Editor</span></span>  <br/> |<span data-ttu-id="c82fb-157">Представитель может делать все, что может делать автор, а также изменять и удалять элементы, созданные владельцем почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-157">A delegate can do everything an Author can do, and also modify and delete the items the mailbox owner created.</span></span>  <br/> |
|<span data-ttu-id="c82fb-158">Reviewer</span><span class="sxs-lookup"><span data-stu-id="c82fb-158">Reviewer</span></span>  <br/> |<span data-ttu-id="c82fb-159">Представитель может читать элементы; Например, представитель с разрешением на просмотр может читать сообщения в папке "Входящие" другого пользователя.</span><span class="sxs-lookup"><span data-stu-id="c82fb-159">A delegate can read items; for example a delegate with Reviewer permission can read messages in another person's Inbox.</span></span>  <br/> |
|<span data-ttu-id="c82fb-160">Пользовательские</span><span class="sxs-lookup"><span data-stu-id="c82fb-160">Custom</span></span>  <br/> |<span data-ttu-id="c82fb-161">Владелец почтового ящика предоставил настраиваемый набор разрешений для делегата.</span><span class="sxs-lookup"><span data-stu-id="c82fb-161">The mailbox owner has granted a custom set of permissions to the delegate.</span></span>  <br/> |
   
<span data-ttu-id="c82fb-162">Свойство управляемого API [делгатеусер. виевприватеитемс](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx) EWS и элемент [виевприватеитемс](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx) EWS — это глобальный параметр, который влияет на все папки владельца почтового ящика, в том числе всю почту, контакты, календарь, задачи, заметки и папки дневника.</span><span class="sxs-lookup"><span data-stu-id="c82fb-162">The [DelgateUser.ViewPrivateItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx) EWS Managed API property and the [ViewPrivateItems](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx) EWS element is a global setting that affects all the mailbox owner's folders, including all Mail, Contacts, Calendar, Tasks, Notes, and Journal folders.</span></span> <span data-ttu-id="c82fb-163">Вы не можете разрешить доступ к частным элементам только в одной папке.</span><span class="sxs-lookup"><span data-stu-id="c82fb-163">You cannot allow access to private items in only one folder.</span></span> 
  
## <a name="explicit-access"></a><span data-ttu-id="c82fb-164">Явный доступ</span><span class="sxs-lookup"><span data-stu-id="c82fb-164">Explicit access</span></span>
<span data-ttu-id="c82fb-165"><a name="bk_explicit"> </a></span><span class="sxs-lookup"><span data-stu-id="c82fb-165"><a name="bk_explicit"> </a></span></span>

<span data-ttu-id="c82fb-166">Проще говоря, явный доступ является вводным способом для делегатов для выполнения действий в папках и элементах владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-166">Simply put, explicit access is the entry way for delegates to perform actions on a mailbox owner's folders or items.</span></span> <span data-ttu-id="c82fb-167">Явный доступ предоставляется представителю, когда он включает известное имя папки для папки владельца почтового ящика, а также SMTP-адрес владельца почтового ящика в запросе к серверу.</span><span class="sxs-lookup"><span data-stu-id="c82fb-167">Explicit access is granted to a delegate when they include the well-known folder name for a mailbox owner's folder along with the mailbox owner's SMTP address in a request to the server.</span></span> <span data-ttu-id="c82fb-168">Доступ является явным, так как запрос делегата явно указывает, что контекст для метода или операции является почтовым ящиком владельца почтового ящика, а не почтового ящика представителя.</span><span class="sxs-lookup"><span data-stu-id="c82fb-168">The access is explicit because the delegate's request explicitly states that the context for the method or operation is the mailbox owner's mailbox, and not the delegate's mailbox.</span></span>
  
<span data-ttu-id="c82fb-169">Явный доступ определяет контекст для всех методов или операций, выполняемых над папками или элементами, которые перемещаются вперед.</span><span class="sxs-lookup"><span data-stu-id="c82fb-169">Explicit access defines the context for all methods or operations performed on the folders or items moving forward.</span></span> <span data-ttu-id="c82fb-170">Все идентификаторы элементов и папок возвращаются, если явно задан явный доступ, однозначно идентифицирующий себя для владельца почтового ящика (хотя и не для читаемого человека).</span><span class="sxs-lookup"><span data-stu-id="c82fb-170">All item and folder IDs returned when the explicit access is set uniquely identify themselves as belonging to the mailbox owner (although not in any human readable format).</span></span> <span data-ttu-id="c82fb-171">Таким образом, приложению не нужно снова указать SMTP-адрес владельца почтового ящика и еще раз; контекст скрыт в идентификаторах.</span><span class="sxs-lookup"><span data-stu-id="c82fb-171">This way, the application doesn't need to specify the mailbox owner's SMTP address again and again; the context is hidden in the identifiers.</span></span> <span data-ttu-id="c82fb-172">После определения элемента или папки делегат фактически использует [неявный доступ](#bk_implicit) для изменения элемента.</span><span class="sxs-lookup"><span data-stu-id="c82fb-172">After an item or folder is identified, a delegate actually uses [implicit access](#bk_implicit) to modify the item.</span></span> <span data-ttu-id="c82fb-173">На следующем рисунке показан процесс получения явного и неявного доступа.</span><span class="sxs-lookup"><span data-stu-id="c82fb-173">The following figure shows the process of getting explicit and implicit access.</span></span> 
  
<span data-ttu-id="c82fb-174">**Рис. 2. Запрос явного и неявного доступа к элементу или папке**</span><span class="sxs-lookup"><span data-stu-id="c82fb-174">**Figure 2. Requesting explicit and implicit access to an item or folder**</span></span>

![Схема, на которой показано приложение, отправляющее запрос на явный доступ, ответ от сервера, запрос на неявный доступ и ответ от сервера.](media/Ex15_Delegate_ExplictImplicit.png)
  
<span data-ttu-id="c82fb-176">Вы можете задать явный доступ во многих различных сценариях.</span><span class="sxs-lookup"><span data-stu-id="c82fb-176">You can set explicit access in many different scenarios.</span></span> <span data-ttu-id="c82fb-177">По сути, каждый раз, когда вы отправляете идентификатор папки в методе или операции, вы можете задать явный доступ.</span><span class="sxs-lookup"><span data-stu-id="c82fb-177">Essentially, any time you're sending a folder ID in a method or operation, you can set explicit access.</span></span> <span data-ttu-id="c82fb-178">Это может быть поиск папок, Поиск встреч, получение элементов, поиск бесед и т. д.</span><span class="sxs-lookup"><span data-stu-id="c82fb-178">This can include finding folders, finding appointments, getting items, finding conversations, and so on.</span></span>
  
### <a name="explicit-access-and-the-ews-managed-api"></a><span data-ttu-id="c82fb-179">Явный доступ и управляемый API EWS</span><span class="sxs-lookup"><span data-stu-id="c82fb-179">Explicit access and the EWS Managed API</span></span>
<span data-ttu-id="c82fb-180"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="c82fb-180"><a name="bk_explicitewsma"> </a></span></span>

<span data-ttu-id="c82fb-181">Вы можете инициировать явный доступ представителя с помощью любого из указанных ниже перегруженных методов, которые принимают входной параметр [FolderId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx) для определения целевой папки:</span><span class="sxs-lookup"><span data-stu-id="c82fb-181">You can initiate explicit delegate access by using any of the following overloaded methods that take a [FolderId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx) input parameter to identify the target folder:</span></span> 
  
- [<span data-ttu-id="c82fb-182">Folder. Bind</span><span class="sxs-lookup"><span data-stu-id="c82fb-182">Folder.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folder.bind%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="c82fb-183">ExchangeService.FindItems</span><span class="sxs-lookup"><span data-stu-id="c82fb-183">ExchangeService.FindItems</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="c82fb-184">ExchangeService. FindAppointments</span><span class="sxs-lookup"><span data-stu-id="c82fb-184">ExchangeService.FindAppointments</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.findappointments%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="c82fb-185">ExchangeService. Финдфолдерс</span><span class="sxs-lookup"><span data-stu-id="c82fb-185">ExchangeService.FindFolders</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.findfolders%28v=exchg.80%29.aspx)
    
- <span data-ttu-id="c82fb-186">И многое другое!</span><span class="sxs-lookup"><span data-stu-id="c82fb-186">And more!</span></span>
    
<span data-ttu-id="c82fb-187">В каждом из этих методов можно использовать параметр **FolderId** для определения целевой папки владельца почтового ящика, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="c82fb-187">You can use the **FolderId** parameter in each of these methods to identify the mailbox owner's target folder, as follows.</span></span> 
  
```cs
new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com");
```

<span data-ttu-id="c82fb-188">Например, чтобы выполнить присоединение к папке Calendar, **FolderId** в этом методе **BIND** указывает имя ИЗВЕСТНОЙ папки и SMTP-адрес владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-188">For example, to bind to the Calendar folder, the **FolderId** in this **Bind** method specifies the well-known folder name, and the mailbox owner's SMTP address.</span></span> 
  
```cs
CalendarFolder calendar = CalendarFolder.Bind(service, new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), new PropertySet());
```

<span data-ttu-id="c82fb-189">Указав известное имя папки и SMTP-адрес, делегат может привязываться к папке календаря владельца почтового ящика, тем самым получая явный доступ к папке.</span><span class="sxs-lookup"><span data-stu-id="c82fb-189">By specifying the well-known folder name and the SMTP address, the delegate can bind to the mailbox owner's Calendar folder — thereby gaining explicit access to the folder.</span></span> <span data-ttu-id="c82fb-190">Все последующие запросы на [неявный доступ](#bk_implicit) к элементам в папке полагаются на контекст, возвращенный в идентификаторах элементов и идентификаторах папок.</span><span class="sxs-lookup"><span data-stu-id="c82fb-190">All subsequent requests for [implicit access](#bk_implicit) to items in the folder then rely on the context returned in the item IDs and folder IDs.</span></span> <span data-ttu-id="c82fb-191">По сути, идентификаторы содержат контекст для подразумеваемых вызовов доступа делегата.</span><span class="sxs-lookup"><span data-stu-id="c82fb-191">Essentially, the identifiers contain the context for the implied delegate access calls.</span></span> <span data-ttu-id="c82fb-192">Чтобы получить идентификатор элемента, который соответствует определенным условиям, используйте следующую строку.</span><span class="sxs-lookup"><span data-stu-id="c82fb-192">Or, to retrieve the item ID of an item that meets specific criteria, use the following.</span></span> 
  
```cs
FindItemsResults<Item> results = service.FindItems(new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), filter, view);
```

<span data-ttu-id="c82fb-193">В этом случае возвращается идентификатор элемента, а затем делегат может использовать неявный доступ для внесения изменений в элемент с помощью идентификатора элемента.</span><span class="sxs-lookup"><span data-stu-id="c82fb-193">In this case the item ID is returned, and then the delegate can then use implicit access to make changes to the item by using the item ID.</span></span>
  
<span data-ttu-id="c82fb-194">Необязательно инициировать явный доступ до тех пор, пока не запросите идентификатор элемента или идентификатор папки, к которым вы не получили доступ через существующий явный доступ.</span><span class="sxs-lookup"><span data-stu-id="c82fb-194">You don't have to initiate explicit access again until you require an item ID or a folder ID that you didn't access via the existing explicit access.</span></span> 
  
### <a name="explicit-access-and-ews"></a><span data-ttu-id="c82fb-195">Явный доступ и EWS</span><span class="sxs-lookup"><span data-stu-id="c82fb-195">Explicit access and EWS</span></span>
<span data-ttu-id="c82fb-196"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="c82fb-196"><a name="bk_explicitewsma"> </a></span></span>

<span data-ttu-id="c82fb-197">Вы можете инициировать явный доступ с помощью операций "@ [Folder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx)", " [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)" или " [FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) ".</span><span class="sxs-lookup"><span data-stu-id="c82fb-197">You can initiate explicit access by using the [GetFolder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx), [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx), or [FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) operations.</span></span> <span data-ttu-id="c82fb-198">Эти операции предоставляют возможность использовать элемент [дистингуишедфолдерид](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) для определения целевой папки.</span><span class="sxs-lookup"><span data-stu-id="c82fb-198">These operations provide the option to use the [DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) element to identify the target folder.</span></span> <span data-ttu-id="c82fb-199">Элемент **дистингуишедфолдерид** содержит один необязательный дочерний элемент, элемент [Mailbox](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="c82fb-199">The **DistinguishedFolderId** element has a single optional child element, the [Mailbox](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) element.</span></span> <span data-ttu-id="c82fb-200">Элемент **Mailbox** при использовании в качестве дочернего элемента элемента **дистингуишедфолдерид** указывает почтовый ящик для делегата, к которому необходимо получить доступ.</span><span class="sxs-lookup"><span data-stu-id="c82fb-200">The **Mailbox** element, when used as a child of the **DistinguishedFolderId** element, specifies the mailbox for the delegate to access.</span></span> <span data-ttu-id="c82fb-201">Если вызывающий пользователь имеет разрешение на доступ к папке владельца почтового ящика, ответ будет содержать коллекцию идентификаторов для элементов или папок этого почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-201">If the calling user has permission to access the mailbox owner's folder, the response will contain a collection of identifiers to items or folders in that mailbox.</span></span> <span data-ttu-id="c82fb-202">Идентификаторы элементов и папок, возвращаемые в ответе, могут использоваться для неявного доступа делегата.</span><span class="sxs-lookup"><span data-stu-id="c82fb-202">The item and folder identifiers that are returned in the response can be used for implicit delegate access.</span></span> 
  
## <a name="implicit-access"></a><span data-ttu-id="c82fb-203">Неявный доступ</span><span class="sxs-lookup"><span data-stu-id="c82fb-203">Implicit access</span></span>
<span data-ttu-id="c82fb-204"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="c82fb-204"><a name="bk_implicit"> </a></span></span>

<span data-ttu-id="c82fb-205">Неявный доступ используется после получения делегатом идентификатора элемента или папки в почтовом ящике владельца почтового ящика, а делегату требуется обновить, удалить или скопировать элемент.</span><span class="sxs-lookup"><span data-stu-id="c82fb-205">Implicit access is used after a delegate has retrieved the ID for an item or folder in the mailbox owner's mailbox and the delegate wants to update, delete, or copy the item.</span></span> <span data-ttu-id="c82fb-206">Когда делегат использует этот идентификатор элемента или папки в запросе, изменения вносятся в элемент в почтовом ящике владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-206">When the delegate uses that item or folder ID in a request, the changes are made to the item in the mailbox owner's mailbox.</span></span> <span data-ttu-id="c82fb-207">Представителю не нужно включать SMTP-адрес владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-207">The delegate does not have to include the mailbox owner's SMTP address.</span></span> 
  
<span data-ttu-id="c82fb-208">Например, если делегат имеет идентификатор одной из папок владельца почтового ящика, делегат может выполнить операцию **FindItem** с этой папкой, используя идентификатор папки, без явного определения почтового ящика владельца почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="c82fb-208">For example, when a delegate has the ID of one of the mailbox owner's folders, the delegate can perform a **FindItem** operation on that folder by using the folder ID, without explicitly identifying the mailbox owner's mailbox.</span></span> <span data-ttu-id="c82fb-209">На этом шаге делегат может выполнять действия с папкой владельца почтового ящика с помощью идентификаторов, возвращаемых в ответах.</span><span class="sxs-lookup"><span data-stu-id="c82fb-209">At that point, the delegate can perform actions on the mailbox owner's folder by using the IDs that are returned in the responses.</span></span> 
  
### <a name="implicit-access-and-the-ews-managed-api"></a><span data-ttu-id="c82fb-210">Неявный доступ и управляемый API EWS</span><span class="sxs-lookup"><span data-stu-id="c82fb-210">Implicit access and the EWS Managed API</span></span>

<span data-ttu-id="c82fb-211">Если метод [FindItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) получил идентификатор элемента, этот идентификатор элемента можно использовать в последующем вызове метода [Item. Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) для привязывания к элементу.</span><span class="sxs-lookup"><span data-stu-id="c82fb-211">If an item ID was retrieved by the [FindItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) method, that item ID can be used in a subsequent [Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method call to bind to the item.</span></span> <span data-ttu-id="c82fb-212">Затем можно вызвать метод [Item. Update](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx), [Item. Delete](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx)или [Item. Copy](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) — или любой вызов метода, для которого требуется идентификатор элемента, если это необходимо для завершения задачи.</span><span class="sxs-lookup"><span data-stu-id="c82fb-212">You can then call the [Item.Update](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx), [Item.Delete](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx), or [Item.Copy](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) method — or any method call that requires an item ID — as needed to complete your task.</span></span> <span data-ttu-id="c82fb-213">Пока представитель имеет соответствующие разрешения для папки, содержащей элемент (и, если применимо, папка, в которую перемещается элемент), делегат может вносить изменения в соответствии с их уровнями разрешений.</span><span class="sxs-lookup"><span data-stu-id="c82fb-213">As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
### <a name="implicit-access-and-ews"></a><span data-ttu-id="c82fb-214">Неявный доступ и EWS</span><span class="sxs-lookup"><span data-stu-id="c82fb-214">Implicit access and EWS</span></span>

<span data-ttu-id="c82fb-215">Если операция [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) получила идентификатор элемента, этот идентификатор элемента можно использовать в последующих операциях [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) для привязывания к элементу.</span><span class="sxs-lookup"><span data-stu-id="c82fb-215">If an item ID was retrieved by the [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) operation, that item ID can be used in subsequent [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operations to bind to the item.</span></span> <span data-ttu-id="c82fb-216">Затем можно вызвать операцию [UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx), [DeleteItem](../web-service-reference/deleteitem-operation.md)или [CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) (или любую операцию, для которой требуется идентификатор элемента, если это необходимо для завершения задачи).</span><span class="sxs-lookup"><span data-stu-id="c82fb-216">You can then call the [UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx), [DeleteItem](../web-service-reference/deleteitem-operation.md), or [CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) operation — or any operation that requires an item ID — as needed to complete your task.</span></span> <span data-ttu-id="c82fb-217">Пока представитель имеет соответствующие разрешения для папки, содержащей элемент (и, если применимо, папка, в которую перемещается элемент), делегат может вносить изменения в соответствии с их уровнями разрешений.</span><span class="sxs-lookup"><span data-stu-id="c82fb-217">As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="c82fb-218">В этом разделе:</span><span class="sxs-lookup"><span data-stu-id="c82fb-218">In this section</span></span>
<span data-ttu-id="c82fb-219"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="c82fb-219"><a name="bk_implicit"> </a></span></span>

- [<span data-ttu-id="c82fb-220">Добавление и удаление делегатов с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="c82fb-220">Add and remove delegates by using EWS in Exchange</span></span>](how-to-add-and-remove-delegates-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="c82fb-221">Доступ к календарю как представителю с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="c82fb-221">Access a calendar as a delegate by using EWS in Exchange</span></span>](how-to-access-a-calendar-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="c82fb-222">Доступ к контактам как представителю с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="c82fb-222">Access contacts as a delegate by using EWS in Exchange</span></span>](how-to-access-contacts-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="c82fb-223">Доступ к электронной почте как представителю с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="c82fb-223">Access email as a delegate by using EWS in Exchange</span></span>](how-to-access-email-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="c82fb-224">Задание разрешений для папки другого пользователя с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="c82fb-224">Set folder permissions for another user by using EWS in Exchange</span></span>](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="c82fb-225">Обработка ошибок, связанных с делегированием, в EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="c82fb-225">Handling delegation-related errors in EWS in Exchange</span></span>](handling-delegation-related-errors-in-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="c82fb-226">См. также</span><span class="sxs-lookup"><span data-stu-id="c82fb-226">See also</span></span>


- [<span data-ttu-id="c82fb-227">Разработка клиентов веб-служб для Exchange</span><span class="sxs-lookup"><span data-stu-id="c82fb-227">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="c82fb-228">Предоставление другим пользователям возможности управлять почтой и календарем</span><span class="sxs-lookup"><span data-stu-id="c82fb-228">Allow someone else to manage your mail and calendar</span></span>](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx)
    
- [<span data-ttu-id="c82fb-229">Add — MailboxPermission</span><span class="sxs-lookup"><span data-stu-id="c82fb-229">Add- MailboxPermission</span></span>](http://technet.microsoft.com/en-us/library/bb124097%28v=exchg.150%29.aspx)
    

