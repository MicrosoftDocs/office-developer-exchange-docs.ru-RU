---
title: Экспорт и импорт элементов с помощью EWS в Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
ms.assetid: ad5f75f9-47c3-4f51-a535-80cba4243683
description: Сведения об экспорте и импорте встреч, сообщений электронной почты, контактов, задач и других элементов почтовых ящиков с помощью управляемого API EWS или EWS в Exchange.
localization_priority: Priority
ms.openlocfilehash: 1bd36cec5c26f79de96b1506a52d297d2edc051a
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2020
ms.locfileid: "44528421"
---
# <a name="exporting-and-importing-items-by-using-ews-in-exchange"></a><span data-ttu-id="d4f06-103">Экспорт и импорт элементов с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="d4f06-103">Exporting and importing items by using EWS in Exchange</span></span>

<span data-ttu-id="d4f06-104">Сведения об экспорте и импорте встреч, сообщений электронной почты, контактов, задач и других элементов почтовых ящиков с помощью управляемого API EWS или EWS в Exchange.</span><span class="sxs-lookup"><span data-stu-id="d4f06-104">Learn about exporting and importing appointments, emails, contacts, tasks, and other mailbox items by using the EWS Managed API or EWS in Exchange.</span></span> 
  
<span data-ttu-id="d4f06-105">Exchange — это золотой ряд важных сведений: Электронная почта, контакты, задачи и календари являются основными для функций Организации.</span><span class="sxs-lookup"><span data-stu-id="d4f06-105">Exchange is a gold mine of important information: email, contacts, tasks, and calendars are core to an organization's functions.</span></span> <span data-ttu-id="d4f06-106">EWS позволяет экспортировать и импортировать основные типы элементов с помощью трех различных подходов:</span><span class="sxs-lookup"><span data-stu-id="d4f06-106">EWS enables you to export and import core item types via three different approaches:</span></span>
  
- <span data-ttu-id="d4f06-107">Типы элементов Exchange.</span><span class="sxs-lookup"><span data-stu-id="d4f06-107">Exchange item types.</span></span> <span data-ttu-id="d4f06-108">Этот подход рекомендуется для импорта и экспорта элементов в другие системы и файлы и из них.</span><span class="sxs-lookup"><span data-stu-id="d4f06-108">We recommend this approach for importing and exporting items to and from other systems and files.</span></span>
    
- <span data-ttu-id="d4f06-109">Возможность уровня элемента (только для EWS).</span><span class="sxs-lookup"><span data-stu-id="d4f06-109">Item-level capability (EWS only).</span></span> <span data-ttu-id="d4f06-110">Этот параметр рекомендуется использовать для экспорта или копирования с одного сервера Exchange Server или почтового ящика и импорта в другой.</span><span class="sxs-lookup"><span data-stu-id="d4f06-110">We recommend this option for exporting or copying from one Exchange server or mailbox and importing to another.</span></span>
    
- <span data-ttu-id="d4f06-111">Потоки MIME в виде распространенных стандартных форматов файлов, таких как iCalendar и vCard.</span><span class="sxs-lookup"><span data-stu-id="d4f06-111">MIME streams in the form of common standard file formats such as iCalendar and vCard.</span></span> <span data-ttu-id="d4f06-112">Так как набор свойств ограничен, а преобразование MIME является дорогостоящим, рекомендуем подход только для импорта или экспорта небольшого объема данных.</span><span class="sxs-lookup"><span data-stu-id="d4f06-112">Because the property set is limited and MIME conversion is costly, we recommend the approach only for importing or exporting a small amount of data.</span></span>
    
> [!IMPORTANT]
> <span data-ttu-id="d4f06-113">Службы EWS не предназначены для резервного копирования и восстановления почтовых ящиков.</span><span class="sxs-lookup"><span data-stu-id="d4f06-113">EWS is not designed for mailbox backup and restore.</span></span> <span data-ttu-id="d4f06-114">Для резервного копирования и восстановления баз данных используйте [API резервного копирования и восстановления](../backup-restore/backup-and-restore-for-exchange-2013.md).</span><span class="sxs-lookup"><span data-stu-id="d4f06-114">To back up and restore databases, use the [backup and restore API](../backup-restore/backup-and-restore-for-exchange-2013.md).</span></span> <span data-ttu-id="d4f06-115">На сайте TechNet вы также можете ознакомиться с [резервным копированием, восстановлением и аварийным восстановлением](https://technet.microsoft.com/library/dd876874%28v=exchg.150%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="d4f06-115">See also [Backup, restore, and disaster recovery](https://technet.microsoft.com/library/dd876874%28v=exchg.150%29.aspx) on TechNet.</span></span> 
  
<span data-ttu-id="d4f06-116">**Таблица 1. Экспорт и импорт контактов, электронной почты и элементов календаря**</span><span class="sxs-lookup"><span data-stu-id="d4f06-116">**Table 1. Exporting and importing contact, email, and calendar items**</span></span>

|<span data-ttu-id="d4f06-117">Задача</span><span class="sxs-lookup"><span data-stu-id="d4f06-117">Task</span></span>|<span data-ttu-id="d4f06-118">Метод управляемого API EWS</span><span class="sxs-lookup"><span data-stu-id="d4f06-118">EWS Managed API method</span></span>|<span data-ttu-id="d4f06-119">Операция служб EWS</span><span class="sxs-lookup"><span data-stu-id="d4f06-119">EWS operation</span></span>|<span data-ttu-id="d4f06-120">Примечания</span><span class="sxs-lookup"><span data-stu-id="d4f06-120">Notes</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="d4f06-121">Экспорт копии контакта, электронной почты, задачи или элемента календаря с [указанным набором свойств](properties-and-extended-properties-in-ews-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="d4f06-121">Export a copy of a contact, email, task, or calendar item with a [specified property set](properties-and-extended-properties-in-ews-in-exchange.md).</span></span>  <br/> |[<span data-ttu-id="d4f06-122">Contact. Bind</span><span class="sxs-lookup"><span data-stu-id="d4f06-122">Contact.Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="d4f06-123">EmailMessage. Bind</span><span class="sxs-lookup"><span data-stu-id="d4f06-123">EmailMessage.Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="d4f06-124">Встреча. Bind</span><span class="sxs-lookup"><span data-stu-id="d4f06-124">Appointment.Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="d4f06-125">Task. Bind</span><span class="sxs-lookup"><span data-stu-id="d4f06-125">Task.Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.task.bind%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="d4f06-126">GetItem</span><span class="sxs-lookup"><span data-stu-id="d4f06-126">GetItem</span></span>](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |<span data-ttu-id="d4f06-127">Этот вариант рекомендуется при экспорте элементов почтового ящика в другую систему или файл, не относящиеся к Exchange (включая типы файлов vCard и iCal).</span><span class="sxs-lookup"><span data-stu-id="d4f06-127">We recommend this option if you're exporting mailbox items to another non-Exchange system or file (including vCard and iCal file types).</span></span><br/><span data-ttu-id="d4f06-128">Так как у вас есть контроль над набором экспортированных свойств, а производительность сервера Exchange, как правило, является лучшим вариантом.</span><span class="sxs-lookup"><span data-stu-id="d4f06-128">Because you have control over the exported property set, and because performance is better for the Exchange server, this is generally the best option.</span></span><br/><br/><span data-ttu-id="d4f06-129">В зависимости от свойств, заданные для элемента почтового ящика, и от того, знает ли ваше приложение все несхематизированныеные идентификаторы свойств, которые могут быть заданы для элемента, этот параметр может не создавать полную копию.</span><span class="sxs-lookup"><span data-stu-id="d4f06-129">Depending on the properties set on a mailbox item, and whether your application is aware of all of the non-schematized property identifiers (extended properties) that might be set on an item, this option might not produce a full-fidelity copy.</span></span><br/><br/><span data-ttu-id="d4f06-130">Эти методы и операции предоставляют набор свойств схематизированные для элемента, а также все запрошенные расширенные свойства.</span><span class="sxs-lookup"><span data-stu-id="d4f06-130">These methods and operation provide the schematized set of properties for an item plus any requested extended properties.</span></span><br/><span data-ttu-id="d4f06-131">Если вы знаете расширенные свойства, заданные для элемента, метод **BIND** или операция **GetItem** могут предоставлять полный экспорт элементов.</span><span class="sxs-lookup"><span data-stu-id="d4f06-131">The **Bind** method or **GetItem** operation can only provide full-fidelity export of items if you know the extended properties that are set on an item.</span></span><br/><span data-ttu-id="d4f06-132">Вы можете запросить все известные [Расширенные свойства](properties-and-extended-properties-in-ews-in-exchange.md) , чтобы обеспечить полную точность.</span><span class="sxs-lookup"><span data-stu-id="d4f06-132">You can request all the known [extended properties](properties-and-extended-properties-in-ews-in-exchange.md) to enable full fidelity.</span></span><br/><br/><span data-ttu-id="d4f06-133">**Совет**: вы можете использовать функцию трассировки в УПРАВЛЯЕМОМ API EWS для получения XML-представления экспортируемых элементов.</span><span class="sxs-lookup"><span data-stu-id="d4f06-133">**TIP**: You can use the tracing feature in the EWS Managed API to get the XML representation of exported items.</span></span>           <span data-ttu-id="d4f06-134">Дополнительную информацию можно узнать [в статье экспорт элемента в настраиваемый формат](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom).</span><span class="sxs-lookup"><span data-stu-id="d4f06-134">For more information, see [Export an item into a custom format](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom).</span></span>  <br/> |
|<span data-ttu-id="d4f06-135">Импорт копии контакта, электронной почты, задачи или элемента календаря с [указанным набором свойств](properties-and-extended-properties-in-ews-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="d4f06-135">Import a copy of a contact, email, task, or calendar item with a [specified property set](properties-and-extended-properties-in-ews-in-exchange.md).</span></span>  <br/> |[<span data-ttu-id="d4f06-136">Contact. Save</span><span class="sxs-lookup"><span data-stu-id="d4f06-136">Contact.Save</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="d4f06-137">EmailMessage. Save</span><span class="sxs-lookup"><span data-stu-id="d4f06-137">EmailMessage.Save</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="d4f06-138">Встреча. сохранение</span><span class="sxs-lookup"><span data-stu-id="d4f06-138">Appointment.Save</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="d4f06-139">Task. Save</span><span class="sxs-lookup"><span data-stu-id="d4f06-139">Task.Save</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.task.save%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="d4f06-140">CreateItem</span><span class="sxs-lookup"><span data-stu-id="d4f06-140">CreateItem</span></span>](https://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> |<span data-ttu-id="d4f06-141">Этот параметр рекомендуется использовать для импорта элементов почтовых ящиков в Exchange.</span><span class="sxs-lookup"><span data-stu-id="d4f06-141">We recommend this option for importing mailbox items into Exchange.</span></span><br/><span data-ttu-id="d4f06-142">Для сохранения состояния импортированного элемента может потребоваться задать специальные свойства для некоторых типов элементов.</span><span class="sxs-lookup"><span data-stu-id="d4f06-142">You might have to set special properties on some item types in order to maintain the state of the imported item.</span></span><br/><span data-ttu-id="d4f06-143">Так как некоторые свойства задаются только в Exchange, а не в клиентах, не всегда возможно иметь возможность полного импорта.</span><span class="sxs-lookup"><span data-stu-id="d4f06-143">Because some properties are only set by Exchange and not by clients, it's not always possible to have a full-fidelity import.</span></span><br/><br/><span data-ttu-id="d4f06-144">Например, вы не можете импортировать собрание с участниками в почтовый ящик, так как Exchange устанавливает отношения между организатором и участниками.</span><span class="sxs-lookup"><span data-stu-id="d4f06-144">For example, you cannot import a meeting with attendees into a mailbox because Exchange sets the relationships between the organizer and attendees.</span></span> <br/><span data-ttu-id="d4f06-145">Это отношение можно установить только с помощью отправки организаторов и участников, принимающих приглашения на собрание и отвечающих им.</span><span class="sxs-lookup"><span data-stu-id="d4f06-145">This relationship can only be established by organizers sending and attendees receiving and responding to the meeting request.</span></span><br/><br/><span data-ttu-id="d4f06-146">Объекты **встреч** в Exchange могут иметь сложные отношения и параметры.</span><span class="sxs-lookup"><span data-stu-id="d4f06-146">**Appointment** objects in Exchange can have complex relationships and settings.</span></span><br/> <span data-ttu-id="d4f06-147">Встречи, у которых есть участники (собрания), имеют параметры, связывающие организатора собрания и участников собрания.</span><span class="sxs-lookup"><span data-stu-id="d4f06-147">Appointments that have attendees (meetings) have settings that tie together the meeting organizer and meeting attendees.</span></span><br/><span data-ttu-id="d4f06-148">Эти параметры не поддерживаются при экспорте и импорте встреч.</span><span class="sxs-lookup"><span data-stu-id="d4f06-148">These settings are not maintained when you export and import appointments.</span></span><br/><span data-ttu-id="d4f06-149">Программное повторное создание связей организаторов и участников для собраний непосредственно для встреч не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="d4f06-149">Programmatically reestablishing meeting organizer/attendee relationships directly on the appointments is not supported.</span></span><br/><span data-ttu-id="d4f06-150">Вариант, который требуется для восстановления этих связей, состоит в выполнении после импорта после импорта, после чего Организатор повторно отправляет собрания и применяет их участникам.</span><span class="sxs-lookup"><span data-stu-id="d4f06-150">An option you do have for reestablishing those relationships is to perform post-processing after an import, then have an organizer resend the meetings and have the attendees accept the meetings.</span></span><br/><span data-ttu-id="d4f06-151">Вы можете использовать олицетворение Exchange, чтобы совершать звонки как для организатора, так и для участников.</span><span class="sxs-lookup"><span data-stu-id="d4f06-151">You can use Exchange impersonation to make the calls for both the organizer and the attendees.</span></span><br/><span data-ttu-id="d4f06-152">Перед импортом необходимо изменить свойство UID объекта **встреча** , чтобы избежать неправильной связи собраний с другими собраниями в почтовом ящике.</span><span class="sxs-lookup"><span data-stu-id="d4f06-152">You should change the UID property of the **Appointment** object before you import to avoid having meetings be incorrectly related to other meetings in a mailbox.</span></span>  <br/> |
|<span data-ttu-id="d4f06-153">Экспорт копии контакта, электронной почты, задачи или элемента календаря в режиме полного воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="d4f06-153">Export a copy of a contact, email, task, or calendar item in full-fidelity.</span></span>  <br/> |<span data-ttu-id="d4f06-154">Неприменимо</span><span class="sxs-lookup"><span data-stu-id="d4f06-154">Not applicable</span></span>  <br/> |[<span data-ttu-id="d4f06-155">ExportItems</span><span class="sxs-lookup"><span data-stu-id="d4f06-155">ExportItems</span></span>](https://msdn.microsoft.com/library/e2846abb-0b16-4732-bbd8-038a674672f6%28Office.15%29.aspx) <br/> |<span data-ttu-id="d4f06-156">Это лучший вариант экспорта элементов почтовых ящиков, которые нужно импортировать обратно в почтовый ящик Exchange.</span><span class="sxs-lookup"><span data-stu-id="d4f06-156">This is the best option for exporting mailbox items that you want to import back into an Exchange mailbox.</span></span><br/><span data-ttu-id="d4f06-157">Кроме того, этот параметр можно использовать для копирования элементов между почтовыми ящиками.</span><span class="sxs-lookup"><span data-stu-id="d4f06-157">You can also use this option to copy items between mailboxes.</span></span><br/><br/><span data-ttu-id="d4f06-158">Операция **ExportItems** предоставляет непрозрачный поток, представляющий элемент, который можно использовать для перемещения данных между почтовыми ящиками.</span><span class="sxs-lookup"><span data-stu-id="d4f06-158">The **ExportItems** operation provides an opaque stream that represents the item that you can use to move information between mailboxes.</span></span><br/><span data-ttu-id="d4f06-159">Вы можете использовать **ExportItems** с операцией [GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) , чтобы создать индекс для поиска элементов в другой системе.</span><span class="sxs-lookup"><span data-stu-id="d4f06-159">You can use **ExportItems** with the [GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operation to make an index for finding the items in another system.</span></span><br/><span data-ttu-id="d4f06-160">Невозможно изменить поток экспорта.</span><span class="sxs-lookup"><span data-stu-id="d4f06-160">You cannot change the export stream.</span></span>  <br/> <span data-ttu-id="d4f06-161">Дополнительную информацию можно узнать [в статье Экспорт элементов с полным](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity)соответствием.</span><span class="sxs-lookup"><span data-stu-id="d4f06-161">For more information, see [Export items with full fidelity](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity).</span></span>  <br/> |
|<span data-ttu-id="d4f06-162">Импорт копии контакта, электронной почты, задачи или элемента календаря в режиме высокой четкости.</span><span class="sxs-lookup"><span data-stu-id="d4f06-162">Import a copy of a contact, email, task, or calendar item in full-fidelity.</span></span>  <br/> |<span data-ttu-id="d4f06-163">Неприменимо</span><span class="sxs-lookup"><span data-stu-id="d4f06-163">Not applicable</span></span>  <br/> |[<span data-ttu-id="d4f06-164">UploadItems</span><span class="sxs-lookup"><span data-stu-id="d4f06-164">UploadItems</span></span>](https://msdn.microsoft.com/library/a88cbe99-7968-454d-a545-4f92c330909f%28Office.15%29.aspx) <br/> |<span data-ttu-id="d4f06-165">Это единственный вариант импорта элементов, экспортированных с помощью операции **ExportItems** .</span><span class="sxs-lookup"><span data-stu-id="d4f06-165">This is the only option for importing items that were exported by the **ExportItems** operation.</span></span>  <br/> |
|<span data-ttu-id="d4f06-166">Экспорт копии контакта, электронной почты или элемента календаря в виде потока MIME для общего типа файлов.</span><span class="sxs-lookup"><span data-stu-id="d4f06-166">Export a copy of a contact, email, or calendar item as a MIME stream for a common file type.</span></span>  <br/> |[<span data-ttu-id="d4f06-167">Contact. Bind</span><span class="sxs-lookup"><span data-stu-id="d4f06-167">Contact.Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="d4f06-168">EmailMessage. Bind</span><span class="sxs-lookup"><span data-stu-id="d4f06-168">EmailMessage.Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="d4f06-169">Встреча. Bind</span><span class="sxs-lookup"><span data-stu-id="d4f06-169">Appointment.Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="d4f06-170">**GetItem**</span><span class="sxs-lookup"><span data-stu-id="d4f06-170">**GetItem**</span></span> <br/> |<span data-ttu-id="d4f06-171">Свойство [сохранитьmimecontent](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx) можно использовать для получения представления потока MIME для элемента.</span><span class="sxs-lookup"><span data-stu-id="d4f06-171">You can use the [MimeContent](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx) property to get the MIME stream representation of an item.</span></span><br/><br/><span data-ttu-id="d4f06-172">В этом случае будет предоставлено базовое подмножество всех свойств элемента.</span><span class="sxs-lookup"><span data-stu-id="d4f06-172">This will provide a basic subset of all the properties on an item.</span></span><br/><span data-ttu-id="d4f06-173">Рекомендуется использовать только поток MIME для операций с одноразовым выходом.</span><span class="sxs-lookup"><span data-stu-id="d4f06-173">As a best practice, only use the MIME stream for one-off operations.</span></span><br/><span data-ttu-id="d4f06-174">Не полагайтесь на MIME для крупного и частого импорта и экспорта элементов, так как Exchange выполняет преобразование контента для MIME, что может повлиять на производительность.</span><span class="sxs-lookup"><span data-stu-id="d4f06-174">Do not rely on MIME for large and frequent importing/exporting of items, because Exchange performs content conversion for the MIME and this can affect performance.</span></span><br/><br/><span data-ttu-id="d4f06-175">MIME-поток **контакта** — это файл [vCard](http://www.faqs.org/rfcs/rfc2426.html) (VCF).</span><span class="sxs-lookup"><span data-stu-id="d4f06-175">The **Contact** MIME stream is a [vCard](http://www.faqs.org/rfcs/rfc2426.html) (.vcf) file.</span></span><br/><span data-ttu-id="d4f06-176">В зависимости от того, какие свойства настроены для контакта, это может не привести к созданию полной копии.</span><span class="sxs-lookup"><span data-stu-id="d4f06-176">Depending on the properties set on a contact, this might not produce a full-fidelity copy.</span></span><br/><span data-ttu-id="d4f06-177">Обратите внимание, что вы не можете импортировать контакт с помощью потока MIME в vCard.</span><span class="sxs-lookup"><span data-stu-id="d4f06-177">Note that you cannot import a contact by using the vCard MIME stream.</span></span><br/><span data-ttu-id="d4f06-178">Чтобы узнать больше, ознакомьтесь со статьей [Экспорт контакта в файл vCard](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime).</span><span class="sxs-lookup"><span data-stu-id="d4f06-178">To learn more, see [Export a contact into a vCard file](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime).</span></span><br/><br/><span data-ttu-id="d4f06-179">**EmailMessage** MIME — это EML-файл.</span><span class="sxs-lookup"><span data-stu-id="d4f06-179">The **EmailMessage** MIME stream is an .eml file.</span></span><br/><span data-ttu-id="d4f06-180">Формат EML удобен, так как Outlook и другие почтовые клиенты могут определить его.</span><span class="sxs-lookup"><span data-stu-id="d4f06-180">The .eml format is convenient because Outlook and other email clients can identify it.</span></span><br/><span data-ttu-id="d4f06-181">Вы также можете использовать MIME-поток для создания MHT-файла, который удобен, так как многие браузеры могут использовать этот тип файлов.</span><span class="sxs-lookup"><span data-stu-id="d4f06-181">You can also use the MIME stream to create an .mht file, which is convenient because many browsers can use that file type.</span></span><br/><span data-ttu-id="d4f06-182">EWS не предоставляет поток файлов. MSG для экспорта электронной почты в MSG – файл.</span><span class="sxs-lookup"><span data-stu-id="d4f06-182">EWS doesn't provide a .msg file stream for exporting an email to a .msg file.</span></span><br/><span data-ttu-id="d4f06-183">Ваши параметры для экспорта MSG — это [Создание файла. MSG](https://msdn.microsoft.com/library/cc463912%28v=EXCHG.80%29.aspx) из результатов вызова метода **EmailMessage. Bind** или метода **GetItem** или с помощью СТОРОННЕГО API, который вызывает EWS и создает MSG-файл из результатов.</span><span class="sxs-lookup"><span data-stu-id="d4f06-183">Your options for exporting an .msg file are to either [construct an .MSG file](https://msdn.microsoft.com/library/cc463912%28v=EXCHG.80%29.aspx) from the results of an **EmailMessage.Bind** method or **GetItem** operation call, or use a third-party API that calls EWS and constructs the .msg file from the results.</span></span><br/><span data-ttu-id="d4f06-184">Дополнительную информацию можно узнать в статье [Экспорт электронной почты в формате EML](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime).</span><span class="sxs-lookup"><span data-stu-id="d4f06-184">For more information, see [Export an email as an .eml file](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime).</span></span><br/><br/><span data-ttu-id="d4f06-185">Поток MIME для **встречи** — это файл в формате iCal (ICS).</span><span class="sxs-lookup"><span data-stu-id="d4f06-185">The **Appointment** MIME stream is an iCal (.ics) file.</span></span><br/><span data-ttu-id="d4f06-186">Формат. ICS удобен, так как Outlook и другие почтовые клиенты могут определить его.</span><span class="sxs-lookup"><span data-stu-id="d4f06-186">The .ics format is convenient because Outlook and other email clients can identify it.</span></span><br/><span data-ttu-id="d4f06-187">Это не является допустимым вариантом экспорта собраний, так как сведения об участниках не предоставляются в потоке MIME.</span><span class="sxs-lookup"><span data-stu-id="d4f06-187">This is not a viable option for exporting meetings because attendee information is not provided in the MIME stream.</span></span> <br/><span data-ttu-id="d4f06-188">Вложения и другие свойства могут не включаться в поток MIME.</span><span class="sxs-lookup"><span data-stu-id="d4f06-188">Attachments and other properties might not be included in the MIME stream.</span></span><br/><span data-ttu-id="d4f06-189">Рассмотрите создание формата iCal на основе объекта [встречи](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx) или XML-кода, возвращенного операцией **GetItem** .</span><span class="sxs-lookup"><span data-stu-id="d4f06-189">Consider constructing the iCal format from either the [Appointment](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx) object or from the XML returned by the **GetItem** operation.</span></span><br/><span data-ttu-id="d4f06-190">Таким образом, вы можете записать дополнительные свойства Exchange с расширенными свойствами ("X-") в файле iCal.</span><span class="sxs-lookup"><span data-stu-id="d4f06-190">This way, you can capture more of the Exchange properties with extended properties ("X-' properties) in the iCal file.</span></span><br/><span data-ttu-id="d4f06-191">Вы также можете экспортировать встречу в XML-форме.</span><span class="sxs-lookup"><span data-stu-id="d4f06-191">You can also export an appointment in XML form.</span></span><br/><span data-ttu-id="d4f06-192">Вызовите операцию **GetItem** и сохраните XML в вашей системе.</span><span class="sxs-lookup"><span data-stu-id="d4f06-192">Call the **GetItem** operation and save the XML in your system.</span></span><br/><span data-ttu-id="d4f06-193">Вы также можете использовать [функции трассировки](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md) в УПРАВЛЯЕМОМ API EWS, чтобы зафиксировать XML-файл для размещения в базе данных XML.</span><span class="sxs-lookup"><span data-stu-id="d4f06-193">You can also use the [tracing functionality](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md) in the EWS Managed API to capture the XML to put in an XML database.</span></span><br/><span data-ttu-id="d4f06-194">Дополнительные сведения приведены в статье [Экспорт встречи в формате iCal](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime).</span><span class="sxs-lookup"><span data-stu-id="d4f06-194">For more information, see [Exporting an appointment as an iCal file](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime).</span></span>  <br/> |
|<span data-ttu-id="d4f06-195">Импортировать копию электронной почты или элемента календаря в виде потока MIME для общего типа файлов.</span><span class="sxs-lookup"><span data-stu-id="d4f06-195">Import a copy of an email or calendar item as a MIME stream for a common file type.</span></span>  <br/> |[<span data-ttu-id="d4f06-196">EmailMessage. Save</span><span class="sxs-lookup"><span data-stu-id="d4f06-196">EmailMessage.Save</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="d4f06-197">Встреча. сохранение</span><span class="sxs-lookup"><span data-stu-id="d4f06-197">Appointment.Save</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="d4f06-198">**CreateItem**</span><span class="sxs-lookup"><span data-stu-id="d4f06-198">**CreateItem**</span></span> <br/> |<span data-ttu-id="d4f06-199">Файл с расширением EML или ICS можно импортировать с помощью свойства **сохранитьmimecontent** объекта **EmailMessage** или **встречи** .</span><span class="sxs-lookup"><span data-stu-id="d4f06-199">You can import an .eml or .ics file by using the **MimeContent** property on an **EmailMessage** or **Appointment** object.</span></span><br/><span data-ttu-id="d4f06-200">Если адрес электронной почты не является черновиком, необходимо задать расширенное свойство [PidTagMessageFlags (0x0E07)](https://msdn.microsoft.com/library/office/cc839733%28v=office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="d4f06-200">You will need to set the [PidTagMessageFlags (0x0E07)](https://msdn.microsoft.com/library/office/cc839733%28v=office.15%29.aspx) extended property if the email is not a draft.</span></span><br/><br/><span data-ttu-id="d4f06-201">Этот способ нельзя использовать для импорта собраний.</span><span class="sxs-lookup"><span data-stu-id="d4f06-201">You cannot use this approach to import meetings.</span></span>  <br/> |
   
## <a name="alternatives-to-exporting-and-importing-items-by-using-ews"></a><span data-ttu-id="d4f06-202">Альтернативы экспорту и импорту элементов с помощью EWS</span><span class="sxs-lookup"><span data-stu-id="d4f06-202">Alternatives to exporting and importing items by using EWS</span></span>
<span data-ttu-id="d4f06-203"><a name="alternatives"> </a></span><span class="sxs-lookup"><span data-stu-id="d4f06-203"><a name="alternatives"> </a></span></span>

<span data-ttu-id="d4f06-204">Другие параметры доступны для експоринг и импортирования элементов в почтовый ящик Exchange и из него.</span><span class="sxs-lookup"><span data-stu-id="d4f06-204">Other options are available for exporing and importing items to and from an Exchange mailbox.</span></span> <span data-ttu-id="d4f06-205">Ниже приведены некоторые соображения, которые следует учитывать при проектировании стратегии импорта и экспорта:</span><span class="sxs-lookup"><span data-stu-id="d4f06-205">The following are some ideas to consider when you design your import and export strategy:</span></span>
  
- <span data-ttu-id="d4f06-206">Используйте PowerShell, чтобы вызвать EWS и отформатировать выходные данные в CSV-файл.</span><span class="sxs-lookup"><span data-stu-id="d4f06-206">Use PowerShell to call EWS and format the output into a .csv file.</span></span>
    
- <span data-ttu-id="d4f06-207">Используйте сторонние библиотеки, которые реализуют MAPI для экспорта и импорта элементов.</span><span class="sxs-lookup"><span data-stu-id="d4f06-207">Use third-party libraries that implement MAPI to export and import items.</span></span> <span data-ttu-id="d4f06-208">Сторонние библиотеки, которые преобразуют EWS в файлы. MSG, доступны и.</span><span class="sxs-lookup"><span data-stu-id="d4f06-208">Third-party libraries that convert EWS to .msg files are available too.</span></span>
    
- <span data-ttu-id="d4f06-209">Используйте командную консоль Exchange и командлеты [MailboxImportRequest](https://technet.microsoft.com/library/ff607310%28v=exchg.150%29.aspx) и [MailboxExportRequest](https://technet.microsoft.com/library/ff607299%28v=exchg.150%29.aspx) для [выполнения запросов на импорт и экспорт почтовых ящиков](https://technet.microsoft.com/library/ee633455%28v=exchg.150%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="d4f06-209">Use the Exchange Management Shell and the [MailboxImportRequest](https://technet.microsoft.com/library/ff607310%28v=exchg.150%29.aspx) and [MailboxExportRequest](https://technet.microsoft.com/library/ff607299%28v=exchg.150%29.aspx) cmdlets to [fulfill mailbox import and export requests](https://technet.microsoft.com/library/ee633455%28v=exchg.150%29.aspx).</span></span> 
    
- <span data-ttu-id="d4f06-210">Используйте [Параметры импорта Outlook](https://office.microsoft.com/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx) для импорта и экспорта элементов.</span><span class="sxs-lookup"><span data-stu-id="d4f06-210">Use [Outlook's import options](https://office.microsoft.com/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx) to import and export items.</span></span> 

    
## <a name="in-this-section"></a><span data-ttu-id="d4f06-211">В этой статье</span><span class="sxs-lookup"><span data-stu-id="d4f06-211">In this section</span></span>
<span data-ttu-id="d4f06-212"><a name="alternatives"> </a></span><span class="sxs-lookup"><span data-stu-id="d4f06-212"><a name="alternatives"> </a></span></span>

- [<span data-ttu-id="d4f06-213">Экспорт элементов с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="d4f06-213">Export items by using EWS in Exchange</span></span>](how-to-export-items-by-using-ews-in-exchange.md)    
- [<span data-ttu-id="d4f06-214">Импорт элементов с помощью EWS в Exchange</span><span class="sxs-lookup"><span data-stu-id="d4f06-214">Import items by using EWS in Exchange</span></span>](how-to-import-items-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="d4f06-215">См. также</span><span class="sxs-lookup"><span data-stu-id="d4f06-215">See also</span></span>

- [<span data-ttu-id="d4f06-216">Резервное копирование, восстановление и аварийное восстановление</span><span class="sxs-lookup"><span data-stu-id="d4f06-216">Backup, Restore, and Disaster Recovery</span></span>](https://technet.microsoft.com/library/dd876874%28v=exchg.150%29.aspx)  
- [<span data-ttu-id="d4f06-217">Ведение журнала</span><span class="sxs-lookup"><span data-stu-id="d4f06-217">Journaling</span></span>](https://technet.microsoft.com/library/aa998649%28v=exchg.150%29.aspx)    
- [<span data-ttu-id="d4f06-218">Спецификация основного объекта для календарей и планирования в Интернете (RFC 5545)</span><span class="sxs-lookup"><span data-stu-id="d4f06-218">Internet Calendaring and Scheduling Core Object Specification (RFC 5545)</span></span>](http://tools.ietf.org/html/rfc5545)   
- [<span data-ttu-id="d4f06-219">Синхронизация почтового ящика и веб-службах Exchange</span><span class="sxs-lookup"><span data-stu-id="d4f06-219">Mailbox synchronization and EWS in Exchange</span></span>](mailbox-synchronization-and-ews-in-exchange.md)
    