---
title: Создание приложений резервного копирования и восстановления для Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: e5e952a5-add1-417c-a3c2-230f4dc99b00
description: Найдите сведения о компонентах и архитектуре приложений резервного копирования и восстановления для Exchange 2013, а также требования к системе для создания приложения резервного копирования и восстановления.
ms.openlocfilehash: f8a332d0816792f8888c97a8394886b026f5204b
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2020
ms.locfileid: "44455277"
---
# <a name="build-backup-and-restore-applications-for-exchange-2013"></a>Создание приложений резервного копирования и восстановления для Exchange 2013

Найдите сведения о компонентах и архитектуре приложений резервного копирования и восстановления для Exchange 2013, а также требования к системе для создания приложения резервного копирования и восстановления.
  
**Применимо к:** Exchange Server 2013 
  
[Службу теневого копирования томов (VSS)](https://msdn.microsoft.com/library/bb968832%28VS.85%29.aspx) можно использовать в версиях Windows Server, начиная с windows Server 2008, для создания приложений, которые резервным копированием и восстановлением данных Exchange Server 2013. Служба VSS предоставляет инфраструктуру, позволяющую создавать теневые копии и управлять ими в сторонних системах управления хранилищами, бизнес-приложениях и оборудовании. Вы можете создавать решения на основе инфраструктуры VSS, в которой используются теневые копии для резервного копирования и восстановления одной или нескольких баз данных Exchange 2013. 
  
## <a name="backup-and-restore-application-prerequisites"></a>Необходимые условия для резервного копирования и восстановления приложений
<a name="bk_systemrequirements"> </a>

Чтобы пользовательское приложение резервного копирования и восстановления и VSS могли выполнять резервное копирование и восстановление баз данных Exchange 2013, среда должна включать следующие компоненты:
  
- Версия Windows Server, начиная с Windows Server 2008 
    
- Exchange 2013
    
Кроме того, при создании приложения для резервного копирования и восстановления следует учитывать следующие ограничения в среде разработки:
  
- VSS — это неуправляемый API COM, к которому можно получить доступ из управляемого кода .NET Framework с помощью сборки COM-взаимодействия.
    
- Командная консоль Exchange — это управляемое приложение, доступ к которому осуществляется с помощью управляемого кода .NET Framework.
    
- API ЧКСГФИЛЕС, поставляемый с Exchange 2013, является библиотекой DLL машинного кода с кодом 64-bit. Использование библиотеки DLL ЧКСГФИЛЕС для Exchange 2007 32-bit с базами данных Exchange 2013 не поддерживается.
    
## <a name="backup-and-restore-application-overview"></a>Обзор приложения резервного копирования и восстановления
<a name="bk_components"> </a>

VSS координирует обмен данными между следующими компонентами: 
  
- Инициатор запроса VSS, который является приложением резервного копирования
    
- Модуль записи VSS
    
- Поставщик VSS, который представляет собой систему, программное обеспечение или аппаратные компоненты, которые создают теневые копии
    
Чтобы использовать VSS для резервного копирования данных Exchange 2013, ваше приложение резервного копирования должно быть инициатором VSS с поддержкой Exchange 2013. Exchange 2013 включает модуль записи VSS, называемый модулем записи VSS, для программы резервного копирования Windows Server; Тем не менее, модуль записи Exchange выполняет резервное копирование только томов целиком. Он не выполняет резервное копирование отдельных баз данных Exchange 2013. Если вам нужна большая гибкость, вы можете использовать стороннее приложение резервного копирования, в котором есть модуль записи VSS с поддержкой Exchange, который может работать с отдельными базами данных Exchange, или можно создать настраиваемый инициатор запроса VSS.
  
Прежде чем приложение вызывает VSS для инициации резервного копирования, он должен получить сведения о конфигурации хранилища для системы Exchange 2013, для которой выполняется резервное копирование. Эти сведения хранятся в доменных службах Active Directory (AD DS). Приложение резервного копирования может получать данные конфигурации хранилища Exchange с помощью команд командной консоли Exchange. Дополнительные сведения см. в статье [Exchange Server PowerShell (Командная консоль Exchange)](https://docs.microsoft.com/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps). 
  
Резервные приложения Exchange 2013 для создания полных, скопированных, разностных и добавочных резервных копий баз данных Exchange вызывают API COM для VSS. они не взаимодействуют непосредственно с модулем записи VSS. Функция группы обеспечения доступности баз данных в Exchange также позволяет приложению создавать полностью согласованную резервную копию, даже если исходная полная резервная копия и позднее разностное резервное копирование поступают с разных серверов в группе DAG. После того как служба VSS создаст копию данных Exchange, приложение архивации сохранит данные на предполагаемом носителе.
  
Чтобы восстановить базу данных Exchange 2013, приложение восстановления извлекает файлы базы данных и журналов с архивного носителя и сохраняет их в активном хранилище на диске сервера Exchange. Отдельные базы данных не связаны с конкретным сервером Exchange. 
  
Приложения для резервного копирования и восстановления должны указывать ряд параметров Exchange 2013 для правильного управления и управления операциями, выполняемыми службой VSS для баз данных Exchange 2013. Например, так как Exchange 2013 поддерживает до 100 одновременно активных баз данных, приложение резервного копирования должно правильно указать и обработать файл базы данных, файлы журнала транзакций и компоненты базы данных файлов контрольной точки.
  
Для восстановления базы данных, в которой были внесены изменения с момента последнего полного заполнения, приложению восстановления требуются файлы баз данных и журналов из разных резервных копий. Например, может потребоваться еженедельное полное резервное копирование и один или несколько ежедневных добавочных копий. В системах Exchange 2013, использующих DAG, приложение восстановления может перестраивать базу данных с помощью резервных копий из разных копий базы данных на разных серверах в одной группе DAG. Тем не менее, единственный поддерживаемый способ восстановления базы данных DAG из резервной копии — восстановление всех активных и пассивных копий базы данных с использованием одних и тех же данных.
  
После того как все данные на месте, приложение восстановления передает серверу Exchange проверку целостности файлов базы данных и журнала. Если файлы базы данных и журналов были восстановлены правильно, сервер Exchange Server может выполнить повторный просмотр файлов журнала базы данных для обновления базы данных и подключения к ней. Если база данных была восстановлена на сервере, на котором уже установлена активная копия базы данных, эта база данных считается восстановленной. Если база данных была восстановлена на другом сервере, база данных может быть либо независимой, либо репликой можно добавить в группу DAG.
  
## <a name="backup-and-restore-system-architecture"></a>Архитектура системы резервного копирования и восстановления
<a name="bk_ExchangeVSS"> </a>

Служба VSS взаимодействуют с файловой системой Windows Server и драйвером запоминающего устройства с помощью стороннего поставщика (или пользовательского поставщика). Поставщик оборудования определяет, где будет создана теневая копия. VSS абстрагирует аппаратно зависимую теневую копию, чтобы приложение резервного копирования и восстановления могло получить доступ к теневой копии без сведений о реализации аппаратного обеспечения. На следующем рисунке показано, как приложение резервного копирования и восстановления взаимодействует с Exchange 2013 и Windows Server.
  
**Рис. 1. Архитектура системы резервного копирования и восстановления**

![Диаграмма, показывающая взаимодействие приложений для резервного копирования и восстановления. Между Exchange, сервером Windows Server и клиентским приложением устанавливается двусторонняя связь. Сервер Windows также взаимодействует с запоминающим устройством или резервным носителем.](media/VSS_architecture_E2k7.gif)
  
Приложение резервного копирования и восстановления функционирует как инициатор запроса VSS. Инициатор запроса обменивается данными с VSS для получения сведений о Exchange 2013, создания теневых копий и получения доступа к данным для резервного копирования. 
  
Хранилище Exchange является компонентом Exchange 2013 и получает доступ к базам данных Exchange 2013 с помощью файловой системы Windows Server. В файловой системе каждый сервер Exchange Server может одновременно подключать до 100 баз данных с файлами баз данных (EDB), файлами журналов транзакций и файлом контрольной точки.
  
Для поддержки VSS Exchange 2013 включает модуль записи Exchange, встроенный в хранилище Exchange. Средство записи Exchange с хранилищем Exchange (работающее от имени инициатора запроса), чтобы заморозить и отключить базу данных до ее резервного копирования, а затем отменить закрепление и подключение базы данных после завершения резервного копирования. Во время восстановления приложение резервного копирования и восстановления предписывает Exchange Writer согласовать базу данных с хранилищем Exchange, заменяя файлы базы данных, подключаться к базе данных, а затем воспроизводящие журналы транзакций (при необходимости).
  
Во время восстановления запросивший объект также обменивается данными с VSS для подготовки системы к восстановлению, а затем для обратного помещения данных на запоминающее устройство. Приложение резервного копирования и восстановления также отвечает за работу с Windows Server для чтения и записи данных на носитель резервного хранения, будь то Архив ленты, сеть хранения данных или другой носитель резервной копии.
  
Восстановленная база данных может быть смонтирована как обычная, активная база данных или как база данных восстановления Exchange 2013. На каждом сервере Exchange Server можно назначить базу данных для восстановления только одной подключенной базы данных.
  
Сведения, необходимые для успешного выполнения операций резервного копирования и восстановления между Exchange 2013, VSS и приложением резервного копирования и восстановления, передаются в составе метаданных модуля записи Exchange.
  
## <a name="in-this-section"></a>В этой статье
<a name="bk_inthissection"> </a>

- [Типы операций резервного копирования для Exchange 2013](types-of-backup-operations-for-exchange-2013.md)
    
- [Восстановление баз данных Exchange 2013](restoring-exchange-2013-databases.md)
    
- [Проверка целостности резервной копии с помощью API ЧКСГФИЛЕС в Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
    
- [Проверка целостности резервной копии с помощью средства Eseutil в Exchange 2013](how-to-validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013.md)
    
## <a name="see-also"></a>См. также

- [Резервное копирование и восстановление для Exchange](backup-and-restore-for-exchange-2013.md) 
- [Справочник по классу функция cchksgfiles](cchksgfiles-class-reference.md) 
- [Служба теневого копирования томов](https://msdn.microsoft.com/library/bb968832%28VS.85%29.aspx) 
- [Windows PowerShell](https://msdn.microsoft.com/library/dd835506%28v=vs.85%29.aspx)
    

