---
title: Проверка целостности резервной копии с помощью средства Eseutil в Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: b0d325ba-4482-4ca2-9a69-c890f985b206
description: Узнайте, как использовать средство командной строки средства Eseutil для проверки резервной копии в хранилище Exchange.
ms.openlocfilehash: 03c4c23d433418911240bbe7c337308a989f3739
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "19760915"
---
#  <a name="validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013"></a><span data-ttu-id="38c3a-103">Проверка целостности резервной копии с помощью средства Eseutil в Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="38c3a-103">Validate backup integrity by using the Eseutil tool in Exchange 2013</span></span>

<span data-ttu-id="38c3a-104">Узнайте, как использовать средство командной строки средства Eseutil для проверки резервной копии в хранилище Exchange.</span><span class="sxs-lookup"><span data-stu-id="38c3a-104">Find out how to use the Eseutil command-line tool to validate a backup of the Exchange store.</span></span> 
  
<span data-ttu-id="38c3a-105">**Применимо к:** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="38c3a-105">**Applies to:** Exchange Server 2013</span></span> 
  
<span data-ttu-id="38c3a-106">Так как тома теневой копии Service (VSS) можно создавать резервные копии, при записи в базу данных Exchange, сервер не всех страниц и выполнить проверку согласованности необходимости.</span><span class="sxs-lookup"><span data-stu-id="38c3a-106">Because the Volume Shadow Copy Service (VSS) can create backups while Exchange continues to write to the database, the server does not touch all the pages and perform the necessary consistency checks.</span></span> <span data-ttu-id="38c3a-107">По этой причине любые резервное копирование и восстановление приложения, использующего служба теневого копирования ТОМОВ необходимо проверить согласованности моментального снимка.</span><span class="sxs-lookup"><span data-stu-id="38c3a-107">For this reason, any backup and restore application that uses VSS must verify snapshot consistency.</span></span> <span data-ttu-id="38c3a-108">Exchange Server 2013 поддерживает следующие два метода для проверки согласованности моментального снимка.</span><span class="sxs-lookup"><span data-stu-id="38c3a-108">Exchange Server 2013 supports the following two methods for checking snapshot consistency:</span></span> 
  
- <span data-ttu-id="38c3a-109">CHKSGFILES API</span><span class="sxs-lookup"><span data-stu-id="38c3a-109">The CHKSGFILES API</span></span>
    
- <span data-ttu-id="38c3a-110">Средство командной строки средства Eseutil</span><span class="sxs-lookup"><span data-stu-id="38c3a-110">The Eseutil command-line tool</span></span>
    
<span data-ttu-id="38c3a-111">Мы рекомендуем использовать CHKSGFILES API, так как проще приложение резервного копирования определить, вам в диагностике и проверьте ошибки, обнаруженные во время CHKSGFILES согласованности.</span><span class="sxs-lookup"><span data-stu-id="38c3a-111">We recommend that you use the CHKSGFILES API because it is easier for the backup application to detect, diagnose, and report errors that are found during the CHKSGFILES consistency check.</span></span> <span data-ttu-id="38c3a-112">Сведения о том, как использовать CHKSGFILES API можно [проверки целостности резервной копии с помощью CHKSGFILES API в Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="38c3a-112">For information about how to use the CHKSGFILES API, see [Validate backup integrity by using the CHKSGFILES API in Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md).</span></span>
  
## <a name="running-the-eseutil-tool"></a><span data-ttu-id="38c3a-113">Выполнение средства Eseutil</span><span class="sxs-lookup"><span data-stu-id="38c3a-113">Running the Eseutil tool</span></span>

<span data-ttu-id="38c3a-114">Проверка согласованности моментального снимка, выполните команду eseutil с файлами базы данных и журналов, перечисленные в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="38c3a-114">To check the snapshot consistency, run the eseutil command against the database and log files that are identified in the following table.</span></span> 
  
<span data-ttu-id="38c3a-115">**В таблице 1. Команды Eseutil.exe для каждого типа резервного копирования**</span><span class="sxs-lookup"><span data-stu-id="38c3a-115">**Table 1. Eseutil.exe commands for each backup type**</span></span>

|<span data-ttu-id="38c3a-116">**Тип файла тип/резервного копирования**</span><span class="sxs-lookup"><span data-stu-id="38c3a-116">**File type/backup type**</span></span>|<span data-ttu-id="38c3a-117">**Полное резервное копирование**</span><span class="sxs-lookup"><span data-stu-id="38c3a-117">**Full backup**</span></span>|<span data-ttu-id="38c3a-118">**Резервное копирование**</span><span class="sxs-lookup"><span data-stu-id="38c3a-118">**Copy backup**</span></span>|<span data-ttu-id="38c3a-119">**Добавочное резервное копирование**</span><span class="sxs-lookup"><span data-stu-id="38c3a-119">**Incremental backup**</span></span>|<span data-ttu-id="38c3a-120">**Разностного резервного копирования**</span><span class="sxs-lookup"><span data-stu-id="38c3a-120">**Differential backup**</span></span>|
|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="38c3a-121">.edb</span><span class="sxs-lookup"><span data-stu-id="38c3a-121">.edb</span></span>  <br/> |<span data-ttu-id="38c3a-122">«eseutil /k /i»</span><span class="sxs-lookup"><span data-stu-id="38c3a-122">"eseutil /k /i"</span></span>  <br/> |<span data-ttu-id="38c3a-123">«eseutil /k /i»</span><span class="sxs-lookup"><span data-stu-id="38c3a-123">"eseutil /k /i"</span></span>  <br/> |<span data-ttu-id="38c3a-124">Не применимо</span><span class="sxs-lookup"><span data-stu-id="38c3a-124">Not applicable</span></span>  <br/> |<span data-ttu-id="38c3a-125">Не применимо</span><span class="sxs-lookup"><span data-stu-id="38c3a-125">Not applicable</span></span>  <br/> |
|<span data-ttu-id="38c3a-126">.log</span><span class="sxs-lookup"><span data-stu-id="38c3a-126">.log</span></span>  <br/> |<span data-ttu-id="38c3a-127">«eseutil /k» (1)</span><span class="sxs-lookup"><span data-stu-id="38c3a-127">"eseutil /k" (1)</span></span>  <br/> |<span data-ttu-id="38c3a-128">«eseutil /k» (1)</span><span class="sxs-lookup"><span data-stu-id="38c3a-128">"eseutil /k" (1)</span></span>  <br/> |<span data-ttu-id="38c3a-129">«eseutil /k» (2)</span><span class="sxs-lookup"><span data-stu-id="38c3a-129">"eseutil /k" (2)</span></span>  <br/> |<span data-ttu-id="38c3a-130">«eseutil /k» (2)</span><span class="sxs-lookup"><span data-stu-id="38c3a-130">"eseutil /k" (2)</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="38c3a-131">Необходимо выполнить команду eseutil для файлов .stm и .chk.</span><span class="sxs-lookup"><span data-stu-id="38c3a-131">You do not need to run the eseutil command against .stm and .chk files.</span></span> 
  
<span data-ttu-id="38c3a-132">Все файлы журналов, которые имеют версии файла журнала, какой номер, равно или больше, чем поколения, число файлов журнала контрольной точки необходимы для восстановления моментального снимка базы данных.</span><span class="sxs-lookup"><span data-stu-id="38c3a-132">All the log files that have a log file generation number that is equal to or greater than the generation number of the checkpoint log file are required in order to recover a snapshot database.</span></span> <span data-ttu-id="38c3a-133">Если он существует, текущий файл журнала (Enn.log) также является обязательным для восстановления базы данных.</span><span class="sxs-lookup"><span data-stu-id="38c3a-133">If it exists, the current log file (Enn.log) is also required for database recovery.</span></span> <span data-ttu-id="38c3a-134">Если любой из файлов журналов не проверки согласованности, источник запроса необходимо убедиться, что состояние компонента резервного копирования задано значение FALSE, перед вызовом метода [BackupComplete](http://msdn.microsoft.com/ru-ru/library/windows/desktop/aa382651%28v=vs.85%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="38c3a-134">If any of the required log files fail the consistency check, the requester must make sure that the status of the backup component is set to FALSE before it calls the [BackupComplete](http://msdn.microsoft.com/ru-ru/library/windows/desktop/aa382651%28v=vs.85%29.aspx) method.</span></span> <span data-ttu-id="38c3a-135">Для определения файла журнала контрольной точки, выполняться Eseutil.exe для моментального файла контрольной точки и разбора вывода для «контрольная точка:.»</span><span class="sxs-lookup"><span data-stu-id="38c3a-135">To identify the checkpoint log file, run Eseutil.exe against the snapshot checkpoint file and parse the output for "Checkpoint:."</span></span> <span data-ttu-id="38c3a-136">Следующем примере показано, как должно выполняться Eseutil.exe файл контрольной точки.</span><span class="sxs-lookup"><span data-stu-id="38c3a-136">The following example shows how to run Eseutil.exe against a checkpoint file.</span></span> 
  
```cpp
c:\eseutil.exe /mk E01.chk
Checkpoint: (0x20, 9D, 187)
```

<span data-ttu-id="38c3a-137">Во второй строке пример является возвращаемого значения, где 0x20 — это номер версии журнала шестнадцатеричных файла журнала контрольной точки.</span><span class="sxs-lookup"><span data-stu-id="38c3a-137">The second line in the example is the return value, where 0x20 is the hexadecimal log generation number of the checkpoint log file.</span></span> <span data-ttu-id="38c3a-138">В этом примере все файлы журналов, включая E01000020.log и выше, должен быть не поврежден для восстановления моментального снимка базы данных, даже если сама база данных уже прошла проверку физической согласованности.</span><span class="sxs-lookup"><span data-stu-id="38c3a-138">In this example, any log files, including E01000020.log and greater, must not be corrupt in order to recover the snapshot database, even if the database itself has already passed the physical consistency check.</span></span>
  
<span data-ttu-id="38c3a-139">Для восстановления базы данных требуются все файлы журналов в добавочного или разностного резервного набора.</span><span class="sxs-lookup"><span data-stu-id="38c3a-139">All log files in an incremental or differential backup set are required for database recovery.</span></span> <span data-ttu-id="38c3a-140">Вы можете проверить согласованность последовательности журналов, запустите Eseutil.exe префикс файла журнала.</span><span class="sxs-lookup"><span data-stu-id="38c3a-140">You can check the consistency of a log sequence by running Eseutil.exe against the log file prefix.</span></span> <span data-ttu-id="38c3a-141">Следующий пример демонстрирует выполните проверку целостности всех файлов, вид E01xxxxx.log на заданном пути.</span><span class="sxs-lookup"><span data-stu-id="38c3a-141">The following example shows how to run consistency checks against all the files of the form E01xxxxx.log on a given path.</span></span>
  
```cpp
c:\eseutil /k E01
```

## <a name="checking-the-eseutilexe-output"></a><span data-ttu-id="38c3a-142">Проверка Eseutil.exe выходных данных</span><span class="sxs-lookup"><span data-stu-id="38c3a-142">Checking the Eseutil.exe output</span></span>

<span data-ttu-id="38c3a-143">Инициатор запроса должен убедитесь, что выход ERRORLEVEL значения ошибок, возвращаемых неотрицательное.</span><span class="sxs-lookup"><span data-stu-id="38c3a-143">The requester must verify that all the exit ERRORLEVEL error values that are returned are nonnegative.</span></span> <span data-ttu-id="38c3a-144">Сведения о значениях ERRORLEVEL видеть [ссылку возникновения типичных ошибок Eseutil](http://technet.microsoft.com/ru-ru/library/aa996759%28v=exchg.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="38c3a-144">For information about ERRORLEVEL values, see [Reference for Common Eseutil Errors](http://technet.microsoft.com/ru-ru/library/aa996759%28v=exchg.80%29.aspx).</span></span> <span data-ttu-id="38c3a-145">Чтобы просмотреть ERRORLEVEL в командной строке введите «эхо % errorlevel %», после завершения Eseutil.exe.</span><span class="sxs-lookup"><span data-stu-id="38c3a-145">To see the ERRORLEVEL at the command line, type "echo %errorlevel%" after Eseutil.exe finishes running.</span></span> <span data-ttu-id="38c3a-146">Отрицательное значение ERRORLEVEL означает повреждение одного или нескольких файлов.</span><span class="sxs-lookup"><span data-stu-id="38c3a-146">A negative ERRORLEVEL indicates that one or more files is corrupted.</span></span>
  
<span data-ttu-id="38c3a-147">Перед источник запроса вызывается метод **BackupComplete** , его убедитесь, что состояние компонента резервного копирования отражает результат проверки согласованности.</span><span class="sxs-lookup"><span data-stu-id="38c3a-147">Before the requester calls the **BackupComplete** method, it must make sure that the status of the backup component reflects the result of the consistency check.</span></span> <span data-ttu-id="38c3a-148">Если были обнаружены все поврежденные состояние будет FALSE. Если повреждения не обнаружены, состояние будет значение TRUE.</span><span class="sxs-lookup"><span data-stu-id="38c3a-148">If any corruption was found, the status will be FALSE; if no corruption was found, the status will be TRUE.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="38c3a-149">См. также</span><span class="sxs-lookup"><span data-stu-id="38c3a-149">See also</span></span>

- [<span data-ttu-id="38c3a-150">Проверка целостности резервной копии с помощью CHKSGFILES API в Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="38c3a-150">Validate backup integrity by using the CHKSGFILES API in Exchange 2013</span></span>](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
- [<span data-ttu-id="38c3a-151">Построение резервное копирование и восстановление приложений для Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="38c3a-151">Build backup and restore applications for Exchange 2013</span></span>](build-backup-and-restore-applications-for-exchange-2013.md)
- [<span data-ttu-id="38c3a-152">Справочник по CChkSGFiles классов</span><span class="sxs-lookup"><span data-stu-id="38c3a-152">CChkSGFiles class reference</span></span>](cchksgfiles-class-reference.md)
- [<span data-ttu-id="38c3a-153">Основные понятия резервного копирования и восстановления для Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="38c3a-153">Backup and restore concepts for Exchange 2013</span></span>](backup-and-restore-concepts-for-exchange-2013.md)
    

