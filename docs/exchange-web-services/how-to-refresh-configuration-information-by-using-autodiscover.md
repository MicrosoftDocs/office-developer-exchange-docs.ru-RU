---
title: Обновление сведений о конфигурации с помощью службы автообнаружения
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: c2f3c6a5-e8ea-4375-b41a-686a6f238d33
description: Узнайте, как и когда обновлять сведения о конфигурации подключения Exchange с помощью автообнаружения.
ms.openlocfilehash: b9a4264d150d09b0e143e0bf7365af351bb2ef44
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2020
ms.locfileid: "44527756"
---
# <a name="refresh-configuration-information-by-using-autodiscover"></a><span data-ttu-id="7215f-103">Обновление сведений о конфигурации с помощью службы автообнаружения</span><span class="sxs-lookup"><span data-stu-id="7215f-103">Refresh configuration information by using Autodiscover</span></span>

<span data-ttu-id="7215f-104">Узнайте, как и когда обновлять сведения о конфигурации подключения Exchange с помощью автообнаружения.</span><span class="sxs-lookup"><span data-stu-id="7215f-104">Learn how and when to refresh configuration information for your Exchange connection by using Autodiscover.</span></span>
  
<span data-ttu-id="7215f-105">Когда приложение EWS запускается в первый раз, служба автообнаружения предоставляет удобный способ сбора необходимой информации для подключения к почтовому ящику Exchange пользователя.</span><span class="sxs-lookup"><span data-stu-id="7215f-105">When your EWS application runs for the first time, Autodiscover provides a great way for you to collect the information you need in order to connect to your user's Exchange mailbox.</span></span> <span data-ttu-id="7215f-106">Но Автообнаружение не только для первого использования.</span><span class="sxs-lookup"><span data-stu-id="7215f-106">But Autodiscover isn't just for first time use.</span></span> <span data-ttu-id="7215f-107">Регулярное использование автообнаружения позволяет обеспечить подключение приложения, чтобы оно отвечало на изменения в развертывании Exchange.</span><span class="sxs-lookup"><span data-stu-id="7215f-107">Using Autodiscover on a regular basis can help keep your application connected by enabling it to respond to changes in the Exchange deployment.</span></span>
  
## <a name="cache-autodiscover-endpoint-and-ews-settings"></a><span data-ttu-id="7215f-108">Конечная точка автообнаружения кэша и параметры EWS</span><span class="sxs-lookup"><span data-stu-id="7215f-108">Cache Autodiscover endpoint and EWS settings</span></span>
<span data-ttu-id="7215f-109"><a name="bk_CacheSettings"> </a></span><span class="sxs-lookup"><span data-stu-id="7215f-109"><a name="bk_CacheSettings"> </a></span></span>

<span data-ttu-id="7215f-110">Мы рекомендуем регулярно использовать автообнаружение, как регулярно его использовать.</span><span class="sxs-lookup"><span data-stu-id="7215f-110">While we recommend that you use Autodiscover regularly, how regularly you use it requires some consideration.</span></span> <span data-ttu-id="7215f-111">В идеале вы можете быстро выравнивать ответы на изменения в среде, создавая слишком много ненужных сетевых трафиков.</span><span class="sxs-lookup"><span data-stu-id="7215f-111">Ideally you can balance responding quickly to changes in the environment against generating too much unnecessary network traffic.</span></span> <span data-ttu-id="7215f-112">Когда приложение получает успешный ответ автообнаружения в первый раз, необходимо сохранить следующие сведения, чтобы не было необходимости повторять процесс автообнаружения каждый раз, когда отправляется запрос EWS.</span><span class="sxs-lookup"><span data-stu-id="7215f-112">When your application gets a successful Autodiscover response for the first time, you should save the following information so that you do not have to repeat the Autodiscover process every time you send an EWS request.</span></span>
  
<span data-ttu-id="7215f-113">**Таблица 1. Сведения для кэширования запросов автообнаружения**</span><span class="sxs-lookup"><span data-stu-id="7215f-113">**Table 1. Information to cache for Autodiscover requests**</span></span>

|<span data-ttu-id="7215f-114">**Настройка для кэширования**</span><span class="sxs-lookup"><span data-stu-id="7215f-114">**Setting to cache**</span></span>|<span data-ttu-id="7215f-115">**Допустимо для...**</span><span class="sxs-lookup"><span data-stu-id="7215f-115">**Valid for…**</span></span>|<span data-ttu-id="7215f-116">**Сведения**</span><span class="sxs-lookup"><span data-stu-id="7215f-116">**Details**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="7215f-117">Конечная точка автообнаружения</span><span class="sxs-lookup"><span data-stu-id="7215f-117">Autodiscover endpoint</span></span>  <br/> |<span data-ttu-id="7215f-118">Пока она работает</span><span class="sxs-lookup"><span data-stu-id="7215f-118">As long as it works</span></span>  <br/> |<span data-ttu-id="7215f-119">При сохранении конечной точки автообнаружения, возвращающей успешный ответ, нет необходимости повторять процесс [создания списка конечных точек автообнаружения](how-to-generate-a-list-of-autodiscover-endpoints.md) и пытаться выполнить их, пока не будет получен успешный ответ.</span><span class="sxs-lookup"><span data-stu-id="7215f-119">When you save the Autodiscover endpoint that returned a successful response, you do not have to repeat the process of [generating a list of Autodiscover endpoints](how-to-generate-a-list-of-autodiscover-endpoints.md) and trying them until you get a successful response.</span></span><br/><br/> <span data-ttu-id="7215f-120">**Note**: управляемый API EWS не поддерживает кэширование конечной точки автообнаружения.</span><span class="sxs-lookup"><span data-stu-id="7215f-120">**NOTE**: The EWS Managed API does not support caching the Autodiscover endpoint.</span></span>           |
|<span data-ttu-id="7215f-121">URL-адрес EWS и другие параметры, полученные из отклика автообнаружения</span><span class="sxs-lookup"><span data-stu-id="7215f-121">EWS URL and any other settings retrieved from the Autodiscover response</span></span>  <br/> |<span data-ttu-id="7215f-122">Одна неделя</span><span class="sxs-lookup"><span data-stu-id="7215f-122">One week</span></span>  <br/> |<span data-ttu-id="7215f-123">При сохранении URL-адреса EWS и других связанных параметров вам не нужно [отправлять новый запрос автообнаружения](how-to-get-user-settings-from-exchange-by-using-autodiscover.md) для каждого запроса EWS или перезапускать приложение.</span><span class="sxs-lookup"><span data-stu-id="7215f-123">By saving the EWS URL and other related settings, you do not have to [send a new Autodiscover request](how-to-get-user-settings-from-exchange-by-using-autodiscover.md) for each EWS request or if your application restarts.</span></span> <span data-ttu-id="7215f-124">Тем не менее, даже если URL-адрес EWS работает для пользователя, сервер может быть доступен более оптимальный.</span><span class="sxs-lookup"><span data-stu-id="7215f-124">However, even if an EWS URL works for your user, a server might be available that is more optimal.</span></span><br/><br/> <span data-ttu-id="7215f-125">Например, почтовый ящик пользователя мог быть перемещен на новый сервер почтовых ящиков, что привело к новой конечной точке EWS.</span><span class="sxs-lookup"><span data-stu-id="7215f-125">For example, the user's mailbox might have moved to a new mailbox server, resulting in a new preferred EWS endpoint.</span></span> <span data-ttu-id="7215f-126">Мы рекомендуем обновить параметры пользователя, отправив новый запрос автообнаружения через одну неделю с момента последнего запроса автообнаружения.</span><span class="sxs-lookup"><span data-stu-id="7215f-126">We recommend that you refresh your user settings by sending a new Autodiscover request after one week has passed since your last Autodiscover request.</span></span> <span data-ttu-id="7215f-127">Это время можно настроить в соответствии с требованиями приложения.</span><span class="sxs-lookup"><span data-stu-id="7215f-127">This time can be adjusted to meet the requirements of your application.</span></span>  <br/> |
   
## <a name="refresh-cached-configuration-information"></a><span data-ttu-id="7215f-128">Обновление кэшированных данных конфигурации</span><span class="sxs-lookup"><span data-stu-id="7215f-128">Refresh cached configuration information</span></span>
<span data-ttu-id="7215f-129"><a name="bk_RefreshConfig"> </a></span><span class="sxs-lookup"><span data-stu-id="7215f-129"><a name="bk_RefreshConfig"> </a></span></span>

<span data-ttu-id="7215f-130">Теперь, когда у вас есть кэшированные сведения, давайте рассмотрим, как можно сохранить новый кэш.</span><span class="sxs-lookup"><span data-stu-id="7215f-130">Now that you have the information cached, let's examine how you can keep that cache fresh.</span></span> <span data-ttu-id="7215f-131">Мы рекомендуем обновлять кэшированные данные в следующих случаях:</span><span class="sxs-lookup"><span data-stu-id="7215f-131">We recommend that you refresh your cached information when:</span></span>
  
- <span data-ttu-id="7215f-132">Срок действия информации истечет.</span><span class="sxs-lookup"><span data-stu-id="7215f-132">The information's validity period expires.</span></span>
    
- <span data-ttu-id="7215f-133">Возникает [ошибка, связанная с подключением](#bk_ConnectionErrors) , и последняя Дата последнего обновления данных в течение часа назад.</span><span class="sxs-lookup"><span data-stu-id="7215f-133">A [Connection-related error](#bk_ConnectionErrors) occurs AND your cached information was last refreshed over an hour ago.</span></span>
    
<span data-ttu-id="7215f-134">Чтобы обновить кэшированные данные, отправьте запрос автообнаружения в кэшированную конечную точку автообнаружения и выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="7215f-134">To refresh your cached information, send an Autodiscover request to a cached Autodiscover endpoint, and do the following:</span></span>
  
- <span data-ttu-id="7215f-135">Если запрос выполнен успешно, Сравните конечную точку EWS в ответе с кэшированной конечной точкой EWS и выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="7215f-135">If the request succeeds, compare the EWS endpoint in the response with the cached EWS endpoint, and do the following:</span></span>
    
  - <span data-ttu-id="7215f-136">Если они отличаются, используйте новую конечную точку EWS.</span><span class="sxs-lookup"><span data-stu-id="7215f-136">If they are different, use the new EWS endpoint.</span></span> <span data-ttu-id="7215f-137">Если вы обновляете сообщение об ошибке, повторите неудачный запрос с новой конечной точкой.</span><span class="sxs-lookup"><span data-stu-id="7215f-137">If you're refreshing to recover from an error, retry the failed request with the new endpoint.</span></span>
    
  - <span data-ttu-id="7215f-138">Если они одинаковы, продолжайте использовать исходную конечную точку EWS.</span><span class="sxs-lookup"><span data-stu-id="7215f-138">If they are the same, continue to use the original EWS endpoint.</span></span> <span data-ttu-id="7215f-139">При обновлении после ошибки обрабатывайте ошибку соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="7215f-139">If you're refreshing to recover from an error, handle the error as appropriate.</span></span>
    
- <span data-ttu-id="7215f-140">Если запрос не удается выполнить, запустите [процесс автообнаружения](autodiscover-for-exchange.md) с самого начала.</span><span class="sxs-lookup"><span data-stu-id="7215f-140">If the request fails, start the [Autodiscover process](autodiscover-for-exchange.md) from the beginning.</span></span> <span data-ttu-id="7215f-141">После получения успешного ответа замените кэшированную конечную точку автообнаружения на конечную точку автообнаружения, которая была успешно выполнена, и продолжайте использовать новую конечную точку EWS.</span><span class="sxs-lookup"><span data-stu-id="7215f-141">After you get a successful response, replace the cached Autodiscover endpoint with the Autodiscover endpoint that succeeded and continue to use the new EWS endpoint.</span></span> <span data-ttu-id="7215f-142">Если вы не получаете успешный ответ, продолжайте использовать исходную конечную точку автообнаружения и конечную точку EWS.</span><span class="sxs-lookup"><span data-stu-id="7215f-142">If you do not get a successful response, continue to use the original Autodiscover endpoint and EWS endpoint.</span></span> <span data-ttu-id="7215f-143">При обновлении после ошибки обрабатывайте ошибку соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="7215f-143">If you're refreshing to recover from an error, handle the error as appropriate.</span></span> 
    
<span data-ttu-id="7215f-144">На следующем рисунке представлено визуальное представление этого процесса.</span><span class="sxs-lookup"><span data-stu-id="7215f-144">The following figure provides a visual representation of this process.</span></span>
  
<span data-ttu-id="7215f-145">**Рис. 1. Процесс обновления сведений о конфигурации с помощью службы автообнаружения**</span><span class="sxs-lookup"><span data-stu-id="7215f-145">**Figure 1. Process for refreshing configuration information by using Autodiscover**</span></span>

![Схема обновления данных конфигурации при автообнаружении.](media/Ex15_Autodiscover_Refresh_Flowchart.png)
  
### <a name="connection-related-errors"></a><span data-ttu-id="7215f-147">Ошибки, связанные с подключением</span><span class="sxs-lookup"><span data-stu-id="7215f-147">Connection-related errors</span></span>
<span data-ttu-id="7215f-148"><a name="bk_ConnectionErrors"> </a></span><span class="sxs-lookup"><span data-stu-id="7215f-148"><a name="bk_ConnectionErrors"> </a></span></span>

<span data-ttu-id="7215f-149">Обновление кэшированных сведений о конфигурации может помочь с некоторыми ошибками, но не всеми.</span><span class="sxs-lookup"><span data-stu-id="7215f-149">Refreshing your cached configuration information can help with some errors, but not all.</span></span> 
  
<span data-ttu-id="7215f-150">**Таблица 2. Ошибки, устраняемые при обновлении кэша**</span><span class="sxs-lookup"><span data-stu-id="7215f-150">**Table 2. Errors addressed by refreshing your cache**</span></span>

|<span data-ttu-id="7215f-151">**Error**</span><span class="sxs-lookup"><span data-stu-id="7215f-151">**Error**</span></span>|<span data-ttu-id="7215f-152">**Реализация управляемого API EWS**</span><span class="sxs-lookup"><span data-stu-id="7215f-152">**EWS Managed API implementation**</span></span>|<span data-ttu-id="7215f-153">**Примечания**</span><span class="sxs-lookup"><span data-stu-id="7215f-153">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="7215f-154">Ошибки DNS или ошибки сети</span><span class="sxs-lookup"><span data-stu-id="7215f-154">DNS or network failure errors</span></span><br/><br/> <span data-ttu-id="7215f-155">Пример: не удалось найти имя узла.</span><span class="sxs-lookup"><span data-stu-id="7215f-155">Example: Host name could not be found.</span></span>  <br/> |[<span data-ttu-id="7215f-156">сервицеремотиксцептион</span><span class="sxs-lookup"><span data-stu-id="7215f-156">ServiceRemoteException</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.exchange.webservices.data.serviceremoteexception?view=exchange-ews-api) <br/> |<span data-ttu-id="7215f-157">Любая ошибка, указывающая на то, что сервер не удалось найти или к которому можно получить доступ, можно устранить, выполнив функцию автообнаружения.</span><span class="sxs-lookup"><span data-stu-id="7215f-157">Any error that indicates that the server could not be found or could not be reached might be resolved by trying Autodiscover.</span></span> <br/><br/> <span data-ttu-id="7215f-158">Ваша кэшированная конечная точка EWS может стать недействительной, а служба автообнаружения может указывать на новый сервер.</span><span class="sxs-lookup"><span data-stu-id="7215f-158">Your cached EWS endpoint might no longer be valid, and Autodiscover might be able to point you to the new server.</span></span>  <br/> |
|<span data-ttu-id="7215f-159">Ошибки состояния HTTP</span><span class="sxs-lookup"><span data-stu-id="7215f-159">HTTP status errors</span></span><br/><br/> <span data-ttu-id="7215f-160">Пример: служба 503 недоступна</span><span class="sxs-lookup"><span data-stu-id="7215f-160">Example: 503 Service Unavailable</span></span>  <br/> |[<span data-ttu-id="7215f-161">сервицеремотиксцептион</span><span class="sxs-lookup"><span data-stu-id="7215f-161">ServiceRemoteException</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.exchange.webservices.data.serviceremoteexception?view=exchange-ews-api) <br/> |<span data-ttu-id="7215f-162">Ошибки состояния HTTP могут происходить по разным причинам.</span><span class="sxs-lookup"><span data-stu-id="7215f-162">HTTP status errors can happen for many different reasons.</span></span><br/><br/> <span data-ttu-id="7215f-163">Тем не менее, рекомендуется попробовать службу автообнаружения, чтобы узнать, доступна ли для пользователя новая конечная точка EWS.</span><span class="sxs-lookup"><span data-stu-id="7215f-163">However, it's a good idea to try Autodiscover to see if a new EWS endpoint is available for the user.</span></span>  <br/> |
|<span data-ttu-id="7215f-164">Коды ошибок EWS</span><span class="sxs-lookup"><span data-stu-id="7215f-164">EWS error codes</span></span> <br/><br/> <span data-ttu-id="7215f-165">Пример: Еррорконнектионфаилед</span><span class="sxs-lookup"><span data-stu-id="7215f-165">Example: ErrorConnectionFailed</span></span> <br/> |[<span data-ttu-id="7215f-166">респонсекодетипе</span><span class="sxs-lookup"><span data-stu-id="7215f-166">ResponseCodeType</span></span>](../web-service-reference/responsecode.md) <br/> | <span data-ttu-id="7215f-167">Большинство кодов ошибок EWS не гарантируют обновление сведений о конфигурации.</span><span class="sxs-lookup"><span data-stu-id="7215f-167">Most EWS error codes don't warrant refreshing your configuration information.</span></span><br/><br/> <span data-ttu-id="7215f-168">Однако ниже указано, что необходимо обновить сведения о конфигурации.</span><span class="sxs-lookup"><span data-stu-id="7215f-168">However, the following specifically indicate that the configuration information needs to be updated:</span></span><br/><span data-ttu-id="7215f-169">- **еррорконнектионфаилед**</span><span class="sxs-lookup"><span data-stu-id="7215f-169">- **ErrorConnectionFailed**</span></span> <br/><span data-ttu-id="7215f-170">- **еррормаилбоксмовеинпрогресс**</span><span class="sxs-lookup"><span data-stu-id="7215f-170">- **ErrorMailboxMoveInProgress**</span></span> <br/> |
   
## <a name="see-also"></a><span data-ttu-id="7215f-171">См. также</span><span class="sxs-lookup"><span data-stu-id="7215f-171">See also</span></span>

- [<span data-ttu-id="7215f-172">Автообнаружение в Exchange</span><span class="sxs-lookup"><span data-stu-id="7215f-172">Autodiscover for Exchange</span></span>](autodiscover-for-exchange.md)  
- [<span data-ttu-id="7215f-173">Создание списка конечных точек автообнаружения</span><span class="sxs-lookup"><span data-stu-id="7215f-173">Generate a list of Autodiscover endpoints</span></span>](how-to-generate-a-list-of-autodiscover-endpoints.md)   
- [<span data-ttu-id="7215f-174">Получение параметров пользователя из Exchange с помощью службы автообнаружения</span><span class="sxs-lookup"><span data-stu-id="7215f-174">Get user settings from Exchange by using Autodiscover</span></span>](how-to-get-user-settings-from-exchange-by-using-autodiscover.md)
    

